[{"id":"9615284c.b28278","type":"tab","label":"WEB","disabled":false,"info":""},{"id":"372e1e33.0db3b2","type":"tab","label":"Main","disabled":false,"info":""},{"id":"6546e589.95bfdc","type":"tab","label":"Distillation","disabled":false,"info":""},{"id":"7459d84c.edbbd8","type":"tab","label":"Rectification","disabled":false,"info":""},{"id":"eadc688c.f6a628","type":"tab","label":"Telegram","disabled":false,"info":""},{"id":"22df5268.5def0e","type":"tab","label":"Debug","disabled":false,"info":""},{"id":"3573bec8.b4cb82","type":"ui_tab","z":"","name":"Настройки","icon":"dashboard","order":3,"disabled":false,"hidden":false},{"id":"65f9b6e5.44a978","type":"ui_group","z":"","name":"Управление","tab":"f88e4750.104008","order":4,"disp":false,"width":"7","collapse":false},{"id":"f88e4750.104008","type":"ui_tab","z":"","name":"Дистилляция","icon":"filter_1","order":1,"disabled":false,"hidden":false},{"id":"3700d3d.0bf402c","type":"ui_group","z":"","name":"Дистилляция","tab":"3573bec8.b4cb82","order":2,"disp":true,"width":"7","collapse":false},{"id":"8e947e7.25f798","type":"ui_group","z":"","name":"Ректификация","tab":"3573bec8.b4cb82","order":3,"disp":true,"width":"7","collapse":false},{"id":"5471a0c0.7d6db","type":"ui_group","z":"","name":"Общие параметры","tab":"3573bec8.b4cb82","order":1,"disp":true,"width":"7","collapse":false},{"id":"66b740b0.b8906","type":"ui_group","z":"","name":"Отображение","tab":"f88e4750.104008","order":1,"disp":false,"width":7,"collapse":false},{"id":"5e64025e.8f64cc","type":"ui_base","theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#5ac8ce","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#097479","value":"#5ac8ce","edited":true},"page-titlebar-backgroundColor":{"value":"#5ac8ce","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#95dce0","edited":false},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#5ac8ce","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"PiMoonShine","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":40,"sy":40,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"6cfb75c2.e1263c","type":"ui_group","z":"","name":"Текущее состояние","tab":"f88e4750.104008","order":3,"disp":false,"width":"7","collapse":false},{"id":"2f65c114.e4d77e","type":"mqtt-broker","z":"","name":"Localhost","broker":"localhost","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"e9d37ea0.2505","type":"ui_spacer","name":"spacer","group":"65f9b6e5.44a978","order":16,"width":7,"height":1},{"id":"2666ee5a.f826b2","type":"ui_tab","z":"","name":"Ректификация","icon":"filter_2","order":2,"disabled":false,"hidden":false},{"id":"ec2a024e.dafca","type":"ui_group","z":"","name":"Отображение","tab":"2666ee5a.f826b2","order":1,"disp":false,"width":7,"collapse":false},{"id":"dc8ecbb3.7cff88","type":"ui_group","z":"","name":"Текущее состояние","tab":"2666ee5a.f826b2","order":2,"disp":false,"width":"7","collapse":false},{"id":"7966a548.0d38ac","type":"ui_group","z":"","name":"Управление","tab":"2666ee5a.f826b2","order":3,"disp":false,"width":"7","collapse":false},{"id":"67d23292.dd341c","type":"ui_group","z":"","name":"Настройка клапанов","tab":"2666ee5a.f826b2","order":4,"disp":true,"width":"7","collapse":true},{"id":"b5dc49c3.0ed5c8","type":"serial-port","z":"","serialport":"/dev/ttyS1","serialbaud":"9600","databits":"8","parity":"none","stopbits":"1","waitfor":"","dtr":"none","rts":"none","cts":"none","dsr":"none","newline":"\\n","bin":"bin","out":"char","addchar":"","responsetimeout":"10000"},{"id":"5cad2aab.fb7294","type":"ui_spacer","name":"spacer","group":"5471a0c0.7d6db","order":2,"width":7,"height":1},{"id":"4f628745.61fa58","type":"ui_spacer","name":"spacer","group":"5471a0c0.7d6db","order":6,"width":7,"height":1},{"id":"9e822c7d.3f41b","type":"ui_spacer","name":"spacer","group":"67d23292.dd341c","order":7,"width":7,"height":1},{"id":"139fdc9f.019a43","type":"ui_spacer","name":"spacer","group":"67d23292.dd341c","order":14,"width":7,"height":1},{"id":"77a77c46.508344","type":"ui_spacer","name":"spacer","group":"7966a548.0d38ac","order":23,"width":"7","height":"2"},{"id":"d5fc9315.a359f","type":"ui_spacer","name":"spacer","group":"ec2a024e.dafca","order":5,"width":"7","height":1},{"id":"2dca5b5d.33cc94","type":"ui_spacer","name":"spacer","group":"ec2a024e.dafca","order":3,"width":"7","height":1},{"id":"b1390e8a.80d44","type":"ui_spacer","name":"spacer","group":"ec2a024e.dafca","order":1,"width":"7","height":1},{"id":"7cee0033.32bed","type":"telegram bot","z":"","botname":"pimoonshine_bot","usernames":"","chatids":"","baseapiurl":"","updatemode":"polling","pollinterval":"600","usesocks":false,"sockshost":"","socksport":"6667","socksusername":"anonymous","sockspassword":"","bothost":"","localbotport":"8443","publicbotport":"8443","privatekey":"","certificate":"","useselfsignedcertificate":false,"sslterminated":false,"verboselogging":false},{"id":"8a7e324c.8fb8d","type":"ui_text","z":"9615284c.b28278","group":"3700d3d.0bf402c","order":1,"width":0,"height":0,"name":"Мощность Разогрева","label":"Мощность Разогрева (%):","format":"","layout":"row-left","x":500,"y":1420,"wires":[]},{"id":"e60beed.053981","type":"ui_slider","z":"9615284c.b28278","name":"Default_Dist_pheat_slider","label":"","tooltip":"","group":"3700d3d.0bf402c","order":2,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_Dist","min":0,"max":"100","step":1,"x":850,"y":1420,"wires":[["f31aa4ee.15b9d8"]]},{"id":"f31aa4ee.15b9d8","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.dist.power.heat","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":1460,"wires":[["e60beed.053981","3f353785.5f70c8"]]},{"id":"3f353785.5f70c8","type":"ui_numeric","z":"9615284c.b28278","name":"Default_Dist_pheat_numeric","label":"","tooltip":"","group":"3700d3d.0bf402c","order":3,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_Dist","format":"{{value}}","min":0,"max":"100","step":1,"x":860,"y":1500,"wires":[["f31aa4ee.15b9d8"]]},{"id":"db0c87a0.6d21c8","type":"ui_slider","z":"9615284c.b28278","name":"Default_Dist_pwork_slider","label":"","tooltip":"","group":"3700d3d.0bf402c","order":5,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_Dist","min":0,"max":"100","step":1,"x":850,"y":1580,"wires":[["2b2378ae.d46158"]]},{"id":"2b2378ae.d46158","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.dist.power.work","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":1620,"wires":[["db0c87a0.6d21c8","4601b96d.167b38"]]},{"id":"4601b96d.167b38","type":"ui_numeric","z":"9615284c.b28278","name":"Default_Dist_pwork_numeric","label":"","tooltip":"","group":"3700d3d.0bf402c","order":6,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_Dist","format":"{{value}}","min":0,"max":"100","step":1,"x":860,"y":1660,"wires":[["2b2378ae.d46158"]]},{"id":"7bdc2c2e.81daa4","type":"ui_text","z":"9615284c.b28278","group":"3700d3d.0bf402c","order":4,"width":0,"height":0,"name":"Рабочая Мощность","label":"Рабочая Мощность (%):","format":"","layout":"row-left","x":500,"y":1580,"wires":[]},{"id":"9d8a4741.120f98","type":"ui_text","z":"9615284c.b28278","group":"3700d3d.0bf402c","order":7,"width":0,"height":0,"name":"Рабочая температура","label":"Рабочая температура (с&deg; в кубе):","format":"","layout":"row-left","x":500,"y":1740,"wires":[]},{"id":"4b9fdf5c.47ee9","type":"ui_slider","z":"9615284c.b28278","name":"Default_Dist_temp_work_slider","label":"","tooltip":"","group":"3700d3d.0bf402c","order":8,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_Dist","min":"55","max":"80","step":"0.1","x":870,"y":1740,"wires":[["23b803ec.3829cc"]]},{"id":"23b803ec.3829cc","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.dist.temp.work","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1310,"y":1780,"wires":[["4b9fdf5c.47ee9","905775f1.50e338"]]},{"id":"905775f1.50e338","type":"ui_numeric","z":"9615284c.b28278","name":"Default_Dist_temp_work_numeric","label":"","tooltip":"","group":"3700d3d.0bf402c","order":9,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_Dist","format":"{{value}}","min":"55","max":"80","step":"0.1","x":880,"y":1820,"wires":[["23b803ec.3829cc"]]},{"id":"d6445ecb.809da","type":"comment","z":"9615284c.b28278","name":"Настройки дистиляция","info":"","x":200,"y":1360,"wires":[]},{"id":"71002e6e.b54ca","type":"comment","z":"9615284c.b28278","name":"Общие параметры","info":"123","x":130,"y":40,"wires":[]},{"id":"1d66b775.27c219","type":"ui_switch","z":"9615284c.b28278","name":"","label":"Звук","tooltip":"","group":"5471a0c0.7d6db","order":1,"width":7,"height":1,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":710,"y":160,"wires":[["42cfc05e.100f2"]]},{"id":"42cfc05e.100f2","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::buzzer_on","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1080,"y":160,"wires":[["1d66b775.27c219"]]},{"id":"6870b3cb.dbabbc","type":"change","z":"9615284c.b28278","name":"buzzer_on","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::buzzer_on","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":160,"wires":[["1d66b775.27c219"]]},{"id":"ce8e8db.2e5b37","type":"change","z":"9615284c.b28278","name":"default.dist.power.heat","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.dist.power.heat","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":502,"y":1460,"wires":[["e60beed.053981","3f353785.5f70c8"]]},{"id":"420c5e8f.80edd","type":"change","z":"9615284c.b28278","name":"default.dist.power.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.dist.power.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":502,"y":1620,"wires":[["db0c87a0.6d21c8","4601b96d.167b38"]]},{"id":"7f234864.108f58","type":"change","z":"9615284c.b28278","name":"default.dist.temp.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.dist.temp.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":502,"y":1780,"wires":[["4b9fdf5c.47ee9","905775f1.50e338"]]},{"id":"e651c67.85c2e38","type":"comment","z":"9615284c.b28278","name":"Настройки ректификация","info":"","x":190,"y":2060,"wires":[]},{"id":"f870ab12.751eb8","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":1,"width":0,"height":0,"name":"Мощность Разогрева","label":"Мощность Разогрева   (%):","format":"","layout":"row-left","x":460,"y":2120,"wires":[]},{"id":"bd611a97.2c4c88","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":4,"width":0,"height":0,"name":"Рабочая Мощность","label":"Рабочая Мощность (%):","format":"","layout":"row-left","x":460,"y":2440,"wires":[]},{"id":"afd2e9d5.d722f8","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":7,"width":0,"height":0,"name":"Рабочая температура","label":"Рабочая температура (с&deg; в царге):","format":"","layout":"row-left","x":460,"y":2280,"wires":[]},{"id":"abbb0772.663f78","type":"ui_dropdown","z":"9615284c.b28278","name":"","label":"Датчик в кубе:   ","tooltip":"","place":"Выбери датчик","group":"5471a0c0.7d6db","order":3,"width":0,"height":0,"passthru":false,"multiple":false,"options":[],"payload":"","topic":"","x":840,"y":860,"wires":[["55b1f85b.55c248"]]},{"id":"c48f6582.088308","type":"ui_dropdown","z":"9615284c.b28278","name":"","label":"Датчик в царге:","tooltip":"","place":"Выбери датчик","group":"5471a0c0.7d6db","order":4,"width":0,"height":0,"passthru":false,"multiple":false,"options":[],"payload":"","topic":"","x":840,"y":920,"wires":[["76f9dde.62a6124"]]},{"id":"bc6b1ba7.0232d8","type":"ui_dropdown","z":"9615284c.b28278","name":"","label":"Датчик на воду:","tooltip":"","place":"Выбери датчик","group":"5471a0c0.7d6db","order":5,"width":0,"height":0,"passthru":false,"multiple":false,"options":[],"payload":"","topic":"","x":840,"y":980,"wires":[["a0d575e4.759c98"]]},{"id":"55b1f85b.55c248","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::sensor.still","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":860,"wires":[["52279817.d0d5e8","8f626373.8f0c7"]]},{"id":"76f9dde.62a6124","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::sensor.tube","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":920,"wires":[["52279817.d0d5e8","2ac569b3.14dcb6"]]},{"id":"a0d575e4.759c98","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::sensor.chiller","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1190,"y":980,"wires":[["52279817.d0d5e8","8944c512.f5fb68"]]},{"id":"1dbbfb82.dc65c4","type":"ui_dropdown","z":"9615284c.b28278","name":"","label":"Датчик жидкости:","tooltip":"","place":"Выбери датчик","group":"5471a0c0.7d6db","order":7,"width":0,"height":0,"passthru":false,"multiple":false,"options":[{"label":"1","value":1,"type":"num"},{"label":"2","value":2,"type":"num"},{"label":"3","value":3,"type":"num"},{"label":"4","value":4,"type":"num"},{"label":"нет","value":5,"type":"num"}],"payload":"","topic":"","x":850,"y":1060,"wires":[["a568fde7.44077"]]},{"id":"a568fde7.44077","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::sensor.liquid","pt":"global","to":"$number(payload)\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1060,"wires":[["e072d8b.166ab28"]]},{"id":"51e78827.17f8c8","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_pheat_slider","label":"","tooltip":"","group":"8e947e7.25f798","order":2,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":0,"max":"100","step":1,"x":840,"y":2120,"wires":[["e19920af.a914f"]]},{"id":"e19920af.a914f","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.power.heat","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":2160,"wires":[["51e78827.17f8c8","b3e95007.7b57c"]]},{"id":"b3e95007.7b57c","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_pheat_numeric","label":"","tooltip":"","group":"8e947e7.25f798","order":3,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":0,"max":"100","step":1,"x":850,"y":2200,"wires":[["e19920af.a914f"]]},{"id":"c006eb25.2d5e48","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_pbody_slider","label":"","tooltip":"","group":"8e947e7.25f798","order":5,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":0,"max":"100","step":1,"x":840,"y":2280,"wires":[["3b5bb492.2d112c"]]},{"id":"3b5bb492.2d112c","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.power.body","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":2320,"wires":[["c006eb25.2d5e48","760d551b.2ae0bc"]]},{"id":"760d551b.2ae0bc","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_pbody_numeric","label":"","tooltip":"","group":"8e947e7.25f798","order":6,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":0,"max":"100","step":1,"x":850,"y":2360,"wires":[["3b5bb492.2d112c"]]},{"id":"9a65a3ae.cc638","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_temp_work_slider","label":"","tooltip":"","group":"8e947e7.25f798","order":8,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"45","max":"80","step":1,"x":860,"y":2440,"wires":[["88748ec8.afa84"]]},{"id":"88748ec8.afa84","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.temp.work","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":2480,"wires":[["9a65a3ae.cc638","3c748c5d.8edb94"]]},{"id":"3c748c5d.8edb94","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_temp_work_numeric","label":"","tooltip":"","group":"8e947e7.25f798","order":9,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"45","max":"80","step":1,"x":860,"y":2520,"wires":[["88748ec8.afa84"]]},{"id":"7b77499f.72aab8","type":"change","z":"9615284c.b28278","name":"default.reflux.power.heat","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.power.heat","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":2160,"wires":[["51e78827.17f8c8","b3e95007.7b57c"]]},{"id":"db826139.278c6","type":"change","z":"9615284c.b28278","name":"default.reflux.power.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.power.body","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":2320,"wires":[["c006eb25.2d5e48","760d551b.2ae0bc"]]},{"id":"8017d842.452978","type":"change","z":"9615284c.b28278","name":"default.reflux.temp.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.temp.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":2480,"wires":[["9a65a3ae.cc638","3c748c5d.8edb94"]]},{"id":"b1bd2402.9d5478","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":16,"width":0,"height":0,"name":"Частота открытия клапана отбор голов","label":"Частота открытия клапана отбор голов (сек):","format":"","layout":"row-left","x":500,"y":2740,"wires":[]},{"id":"bfd6447e.0c41e8","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":19,"width":0,"height":0,"name":"Длительность открытия клапана отбор голов","label":"Длительность открытия клапана отбор голов (%):","format":"","layout":"row-left","x":500,"y":2600,"wires":[]},{"id":"d37ccc73.6ff34","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":22,"width":0,"height":0,"name":"Частота открытия клапана отбор тела","label":"Частота открытия клапана отбор тела (сек):","format":"","layout":"row-left","x":500,"y":3020,"wires":[]},{"id":"7a131c25.673404","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":25,"width":0,"height":0,"name":"Длительность открытия клапана отбор тела","label":"Длительность открытия клапана отбор тела (%):","format":"","layout":"row-left","x":520,"y":2880,"wires":[]},{"id":"70dc35d.bd817cc","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_valve_head_opentime_slider","label":"","tooltip":"","group":"8e947e7.25f798","order":20,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"1","max":"50","step":1,"x":890,"y":2620,"wires":[["7a65c00f.7bde3"]]},{"id":"7a65c00f.7bde3","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.valve.head.opentime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1330,"y":2660,"wires":[["70dc35d.bd817cc","ba55dd8e.c16b"]]},{"id":"ba55dd8e.c16b","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_valve_head_opentime_numeric","label":"","tooltip":"","group":"8e947e7.25f798","order":21,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"1","max":"50","step":1,"x":900,"y":2700,"wires":[["7a65c00f.7bde3"]]},{"id":"c0566a01.0bd8f8","type":"change","z":"9615284c.b28278","name":"default.reflux.valve.head.opentime","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.valve.head.opentime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":2640,"wires":[["70dc35d.bd817cc","ba55dd8e.c16b"]]},{"id":"894bdfe7.075ed","type":"ui_ui_control","z":"9615284c.b28278","name":"","events":"all","x":100,"y":160,"wires":[["6870b3cb.dbabbc"]]},{"id":"3d43fae9.7f9346","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_valve_head_frequency_slider","label":"","tooltip":"","group":"8e947e7.25f798","order":17,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"6","max":"30","step":1,"x":890,"y":2760,"wires":[["de00a54d.39c248"]]},{"id":"de00a54d.39c248","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.valve.head.frequency","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1330,"y":2800,"wires":[["3d43fae9.7f9346","c245a8b1.a40498"]]},{"id":"c245a8b1.a40498","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_valve_head_frequency_numeric","label":"","tooltip":"","group":"8e947e7.25f798","order":18,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"6","max":"30","step":1,"x":900,"y":2840,"wires":[["de00a54d.39c248"]]},{"id":"82f5493d.dda058","type":"change","z":"9615284c.b28278","name":"default.reflux.valve.head.frequency","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.valve.head.frequency","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":2780,"wires":[["3d43fae9.7f9346","c245a8b1.a40498"]]},{"id":"4837ba11.c6c004","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_valve_body_opentime_slider","label":"","tooltip":"","group":"8e947e7.25f798","order":26,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"1","max":"50","step":1,"x":890,"y":2900,"wires":[["3a3847e2.bb6b28"]]},{"id":"3a3847e2.bb6b28","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.valve.body.opentime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1330,"y":2940,"wires":[["4837ba11.c6c004","6fb8583b.ff8128"]]},{"id":"6fb8583b.ff8128","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_valve_body_opentime_numeric","label":"","tooltip":"","group":"8e947e7.25f798","order":27,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"1","max":"50","step":1,"x":900,"y":2980,"wires":[["3a3847e2.bb6b28"]]},{"id":"c552f321.e0395","type":"change","z":"9615284c.b28278","name":"default.reflux.valve.body.opentime","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.valve.body.opentime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":2920,"wires":[["4837ba11.c6c004","6fb8583b.ff8128"]]},{"id":"1abd2d61.94e943","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_valve_body_frequency_slider","label":"","tooltip":"","group":"8e947e7.25f798","order":23,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"6","max":"30","step":1,"x":890,"y":3040,"wires":[["512e2d1e.320b24"]]},{"id":"512e2d1e.320b24","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.valve.body.frequency","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1330,"y":3080,"wires":[["1abd2d61.94e943","9d5147ad.e772c8"]]},{"id":"9d5147ad.e772c8","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_valve_body_frequency_numeric","label":"","tooltip":"","group":"8e947e7.25f798","order":24,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"6","max":"30","step":1,"x":900,"y":3120,"wires":[["512e2d1e.320b24"]]},{"id":"a83570c8.ecc35","type":"change","z":"9615284c.b28278","name":"default.reflux.valve.body.frequency","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.valve.body.frequency","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":3060,"wires":[["1abd2d61.94e943","9d5147ad.e772c8"]]},{"id":"508362cc.7e1afc","type":"Bme280","z":"372e1e33.0db3b2","name":"","bus":"0","address":"0x76","topic":"bme280","extra":false,"x":480,"y":520,"wires":[["37b98a0e.77ad96","3b7d894d.6a44d6","f73178df.e5c3e8"]]},{"id":"d0dd6251.053ad","type":"inject","z":"372e1e33.0db3b2","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"5","crontab":"","once":true,"onceDelay":"0.5","topic":"","payload":"","payloadType":"date","x":190,"y":520,"wires":[["508362cc.7e1afc"]]},{"id":"e0f318fb.afc628","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":31,"width":0,"height":0,"name":"Время до уставки (мин)","label":"Время до уставки (мин):","format":"","layout":"row-spread","x":470,"y":3380,"wires":[]},{"id":"8897bd95.18f34","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":28,"width":0,"height":0,"name":"Время стабилизации (мин)","label":"Время стабилизации (мин):","format":"","layout":"row-spread","x":480,"y":3240,"wires":[]},{"id":"7790a040.70d1e","type":"change","z":"9615284c.b28278","name":"default.reflux.stabtime","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.stabtime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":3280,"wires":[["c8eeb737.d1f388","182b59a6.e224e6"]]},{"id":"24b34fb8.43a7b","type":"change","z":"9615284c.b28278","name":"default.reflux.deltatemptime","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.deltatemptime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":3420,"wires":[["51ec0498.adfbbc","4e419b50.113024"]]},{"id":"c8eeb737.d1f388","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_stabtime","label":"","tooltip":"","group":"8e947e7.25f798","order":29,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"0","max":"30","step":1,"x":830,"y":3240,"wires":[["238a3dd.c821dc2"]]},{"id":"238a3dd.c821dc2","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.stabtime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1290,"y":3280,"wires":[["c8eeb737.d1f388","182b59a6.e224e6"]]},{"id":"182b59a6.e224e6","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_stabtime","label":"","tooltip":"","group":"8e947e7.25f798","order":30,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"0","max":"30","step":1,"x":830,"y":3320,"wires":[["238a3dd.c821dc2"]]},{"id":"51ec0498.adfbbc","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_deltatemptime","label":"","tooltip":"","group":"8e947e7.25f798","order":32,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"0","max":"30","step":1,"x":840,"y":3380,"wires":[["b80253e3.d251f"]]},{"id":"b80253e3.d251f","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.deltatemptime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1310,"y":3420,"wires":[["51ec0498.adfbbc","4e419b50.113024"]]},{"id":"4e419b50.113024","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_deltatemptime","label":"","tooltip":"","group":"8e947e7.25f798","order":33,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"0","max":"30","step":1,"x":840,"y":3460,"wires":[["b80253e3.d251f"]]},{"id":"21b190a8.1edd6","type":"change","z":"6546e589.95bfdc","name":"Enable process","rules":[{"t":"set","p":"process.type","pt":"global","to":"dist","tot":"str"},{"t":"set","p":"process.on","pt":"global","to":"payload","tot":"msg"},{"t":"set","p":"process.dist.stage","pt":"global","to":"heat","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"red\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":720,"wires":[["4a1972d2.33c3bc","21f085a4.5525da","bf5a63b7.8f061","1aa6ee79.708842","7024c9f7.21c808"]]},{"id":"3504aa52.957e86","type":"switch","z":"6546e589.95bfdc","name":"","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1110,"y":860,"wires":[["21b190a8.1edd6","f3bfed01.5e4f1"],["bb970b5e.88e0e8","f3bfed01.5e4f1"]]},{"id":"bb970b5e.88e0e8","type":"change","z":"6546e589.95bfdc","name":"Disable process","rules":[{"t":"set","p":"process.type","pt":"global","to":"none","tot":"str"},{"t":"set","p":"process.on","pt":"global","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"white\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":1000,"wires":[["5d00e54f.09672c","7287de07.41a92","a22bbdf2.e6137"]]},{"id":"fc9998dd.b680a8","type":"ui_text","z":"9615284c.b28278","group":"3700d3d.0bf402c","order":10,"width":0,"height":0,"name":"Температура окончания погона","label":"Окончание погона (с&deg; в кубе):","format":"","layout":"row-left","x":518,"y":1860,"wires":[]},{"id":"7412fcfe.4b7614","type":"ui_slider","z":"9615284c.b28278","name":"Default_Dist_temp_end_work_slider","label":"","tooltip":"","group":"3700d3d.0bf402c","order":11,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_Dist","min":"80","max":"100","step":"0.1","x":890,"y":1900,"wires":[["bfeee86f.0ba138"]]},{"id":"bfeee86f.0ba138","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.dist.temp.end","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1310,"y":1940,"wires":[["7412fcfe.4b7614","f656b07b.5f2bc"]]},{"id":"f656b07b.5f2bc","type":"ui_numeric","z":"9615284c.b28278","name":"Default_Dist_temp_end_work_numeric","label":"","tooltip":"","group":"3700d3d.0bf402c","order":12,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_Dist","format":"{{value}}","min":"80","max":"100","step":"0.1","x":890,"y":1980,"wires":[["bfeee86f.0ba138"]]},{"id":"2577deda.79cc72","type":"change","z":"9615284c.b28278","name":"default.dist.temp.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.dist.temp.end.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":1900,"wires":[["7412fcfe.4b7614","f656b07b.5f2bc"]]},{"id":"e90b259b.2b5a98","type":"switch","z":"372e1e33.0db3b2","name":"Check process status","property":"process.on","propertyType":"global","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":1380,"y":1380,"wires":[["f782232e.2ef56"],["afa0e996.9c6168"]]},{"id":"5fdbd1be.8eb5c","type":"comment","z":"372e1e33.0db3b2","name":"Управление питанием","info":"","x":180,"y":1140,"wires":[]},{"id":"f782232e.2ef56","type":"function","z":"372e1e33.0db3b2","name":"Set Heat for ssr","func":"var timeloop = flow.get(\"heat_interval\", \"memoryOnly\");\nvar process;\n\nswitch(global.get(\"process.type\", \"memoryOnly\")){\n    case \"dist\":\n        process = global.get(\"process.dist\", \"memoryOnly\");\n        break;\n    case \"reflux\":\n        process = global.get(\"process.reflux\", \"memoryOnly\");\n        break;\n    default:\n        process = null;\n        break;\n}\n\nvar out1 = null\nvar out2 = { delay: 0 };\nvar out3 = { payload: 0 };\nvar percent_heat = 0;\n\nswitch(process.stage){\n    case \"heat\":\n        percent_heat = process.power.heat;\n         break;\n    case \"work\":\n        percent_heat = process.power.work;\n        break;\n    case \"head\":\n        percent_heat = process.power.body;\n        break;\n    case \"stabilize\":\n        percent_heat = process.power.body;\n        break;\n    case \"setpoint\":\n        percent_heat = process.power.body;\n        break;\n    case \"body\":\n        percent_heat = process.power.body;\n        break;\n    default:\n        percent_heat = 0\n        break;\n}\n\nswitch(percent_heat){\n    case 0:\n        out1 = null;\n        out2 = { \n            delay: 0,\n            flush: true\n        };\n        break;\n    case 100:\n        out1 = { payload: true };\n        out2 = { \n            delay: timeloop/100*percent_heat*1000,\n            reset: true\n        };\n        break;\n    default:\n        out1 = { payload: true };\n        out2 = { delay: timeloop/100*percent_heat*1000};\n        break;\n}\n\nout3 = { payload: percent_heat };\n\nreturn [out1, out2, out3];","outputs":3,"noerr":0,"initialize":"","finalize":"","x":1820,"y":1360,"wires":[["d4be9a7e.41a828"],["6c879f34.fb33"],["331c412b.d30e4e","1376c34d.cb9d2d","6364c5fa.e1a87c"]]},{"id":"77f1f173.aad71","type":"delay","z":"372e1e33.0db3b2","name":"Задержка до отключения питания","pauseType":"delayv","timeout":"0","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2260,"y":1340,"wires":[["b2af3837.0bf038"]]},{"id":"4a1972d2.33c3bc","type":"link out","z":"6546e589.95bfdc","name":"Dist Start/Stop Process","links":["2e9fa827.bfcb18"],"x":1915,"y":840,"wires":[]},{"id":"2e9fa827.bfcb18","type":"link in","z":"372e1e33.0db3b2","name":"Power ON/OFF","links":["4a1972d2.33c3bc","fd030360.74ea5"],"x":215,"y":1320,"wires":[["442934b0.13507c"]]},{"id":"afa0e996.9c6168","type":"change","z":"372e1e33.0db3b2","name":"Stop Heating","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1590,"y":1520,"wires":[["331c412b.d30e4e","6364c5fa.e1a87c","1376c34d.cb9d2d","b2af3837.0bf038"]]},{"id":"26de6950.9bf226","type":"change","z":"372e1e33.0db3b2","name":"Set interval","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"set","p":"payload","pt":"msg","to":"interval","tot":"str"},{"t":"set","p":"interval_value","pt":"msg","to":"heat_interval","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":890,"y":1380,"wires":[["c323f9ae.6e71c8"]]},{"id":"8cee4ec6.58b6","type":"inject","z":"22df5268.5def0e","name":"Reset to defaults","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"1","payloadType":"num","x":160,"y":100,"wires":[["572c1fc.4b069e"]]},{"id":"572c1fc.4b069e","type":"change","z":"22df5268.5def0e","name":"Set variables to defaults","rules":[{"t":"set","p":"temperature.chiller","pt":"global","to":"0","tot":"num"},{"t":"set","p":"temperature.tube","pt":"global","to":"0","tot":"num"},{"t":"set","p":"temperature.still","pt":"global","to":"0","tot":"num"},{"t":"set","p":"payload","pt":"msg","to":"Reset Done","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":390,"y":100,"wires":[["db31af9f.0d193"]]},{"id":"11374132.45de3f","type":"comment","z":"22df5268.5def0e","name":"Выставляем все значения в defaults","info":"","x":220,"y":40,"wires":[]},{"id":"db31af9f.0d193","type":"debug","z":"22df5268.5def0e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":610,"y":100,"wires":[]},{"id":"61727757.888718","type":"inject","z":"22df5268.5def0e","name":"+5","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"sum","payload":"5","payloadType":"num","x":170,"y":380,"wires":[["db446ec2.3491f"]]},{"id":"db446ec2.3491f","type":"function","z":"22df5268.5def0e","name":"Tube Temperature Testing","func":"var current_temperature = global.get(\"debug.temperature.tube\")\nif (isNaN(current_temperature)) {current_temperature = 0}\nif (msg.topic == 'sum') {\n    current_temperature = current_temperature + msg.payload;\n} else {\n    current_temperature = current_temperature - msg.payload;\n}\n\nglobal.set(\"debug.temperature.tube\", current_temperature);\nmsg.payload = current_temperature;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":440,"wires":[["d796b0db.6a521"]]},{"id":"d796b0db.6a521","type":"debug","z":"22df5268.5def0e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":670,"y":440,"wires":[]},{"id":"3391407f.539f3","type":"inject","z":"22df5268.5def0e","name":"-5","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"5","payloadType":"num","x":170,"y":500,"wires":[["db446ec2.3491f"]]},{"id":"c66fac45.09ee2","type":"inject","z":"22df5268.5def0e","name":"+5","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"sum","payload":"5","payloadType":"num","x":170,"y":580,"wires":[["b1b66888.e04688"]]},{"id":"b1b66888.e04688","type":"function","z":"22df5268.5def0e","name":"Chiller Temperature Testing","func":"var current_temperature = global.get(\"debug.temperature.chiller\")\nif (isNaN(current_temperature)) {current_temperature = 0}\nif (msg.topic == 'sum') {\n    current_temperature = current_temperature + msg.payload;\n} else {\n    current_temperature = current_temperature - msg.payload;\n}\n\nglobal.set(\"debug.temperature.chiller\", current_temperature);\nmsg.payload = current_temperature;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":440,"y":640,"wires":[["aa5c61bb.60e1"]]},{"id":"aa5c61bb.60e1","type":"debug","z":"22df5268.5def0e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":670,"y":640,"wires":[]},{"id":"924fd313.b9602","type":"inject","z":"22df5268.5def0e","name":"-5","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"5","payloadType":"num","x":170,"y":700,"wires":[["b1b66888.e04688"]]},{"id":"4f6ffcef.a934d4","type":"inject","z":"22df5268.5def0e","name":"+5","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"sum","payload":"5","payloadType":"num","x":170,"y":180,"wires":[["afbee4e5.8d8c48"]]},{"id":"afbee4e5.8d8c48","type":"function","z":"22df5268.5def0e","name":"Still Temperature Testing","func":"var current_temperature = global.get(\"debug.temperature.still\")\nif (isNaN(current_temperature)) {current_temperature = 0}\nif (msg.topic == 'sum') {\n    current_temperature = current_temperature + msg.payload;\n} else {\n    current_temperature = current_temperature - msg.payload;\n}\n\nglobal.set(\"debug.temperature.still\", current_temperature);\nmsg.payload = current_temperature;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":240,"wires":[["61471103.cbab8"]]},{"id":"61471103.cbab8","type":"debug","z":"22df5268.5def0e","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":670,"y":240,"wires":[]},{"id":"a6cb8cd0.bd711","type":"inject","z":"22df5268.5def0e","name":"-5","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"5","payloadType":"num","x":170,"y":300,"wires":[["afbee4e5.8d8c48"]]},{"id":"f73178df.e5c3e8","type":"change","z":"372e1e33.0db3b2","name":"Set global variables","rules":[{"t":"set","p":"temperature.system","pt":"global","to":"$globalContext('temperature.system')*0.3+payload.temperature_C*(1-0.3)","tot":"jsonata"},{"t":"set","p":"pressure.current","pt":"global","to":"$globalContext('pressure.current')*0.3+payload.pressure_hPa*(1-0.3)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":480,"wires":[["3a6e7ceb.a46a64","d19fb80b.fd4198"]],"icon":"font-awesome/fa-database"},{"id":"57fafacb.366bd4","type":"ui_chart","z":"372e1e33.0db3b2","name":"Температура Dist","group":"6cfb75c2.e1263c","order":5,"width":7,"height":5,"label":"Температура","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"monotone","nodata":"Данных нет","dot":false,"ymin":"","ymax":"","removeOlder":"10","removeOlderPoints":"3000","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#949994","#eb7e11","#35e43e","#358de4","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":2450,"y":680,"wires":[[]]},{"id":"3a6e7ceb.a46a64","type":"change","z":"372e1e33.0db3b2","name":"Системная температура","rules":[{"t":"set","p":"topic","pt":"msg","to":"t° системы","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"$round(payload.temperature_C, 1)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1250,"y":680,"wires":[["b13305cf.dfe068","4d55c633.d7a308"]]},{"id":"d19fb80b.fd4198","type":"change","z":"372e1e33.0db3b2","name":"Давление","rules":[{"t":"set","p":"topic","pt":"msg","to":"мм.рт.ст.","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"$round(payload.pressure_hPa/1.334, 1)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1210,"y":600,"wires":[["566c14b2.ca6a7c","2a7ff664.1434ca","1ef16c15.68cd44"]]},{"id":"9e62b61d.9d5838","type":"ui_chart","z":"372e1e33.0db3b2","name":"Давление Dist","group":"6cfb75c2.e1263c","order":6,"width":0,"height":0,"label":"Давление","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"monotone","nodata":"Данных нет","dot":false,"ymin":"","ymax":"","removeOlder":"10","removeOlderPoints":"3000","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":2440,"y":560,"wires":[[]]},{"id":"7c9d6b80.bd02f4","type":"inject","z":"372e1e33.0db3b2","name":"Очистить чарты","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"[]","payloadType":"json","x":1880,"y":640,"wires":[["24f84d04.4b4e62","57fafacb.366bd4","e3a91af6.be25b8","9e62b61d.9d5838"]]},{"id":"dfe719ae.fa1908","type":"comment","z":"372e1e33.0db3b2","name":"Получение давления тепературы","info":"","x":220,"y":420,"wires":[]},{"id":"c323f9ae.6e71c8","type":"configurable interval","z":"372e1e33.0db3b2","name":"configurable interval","interval":"1","onstart":true,"do_enable":true,"msg":"ping","showstatus":true,"unit":"seconds","statusformat":"HH:mm:ss","x":1120,"y":1380,"wires":[["e90b259b.2b5a98"]]},{"id":"2a41e13a.300eae","type":"inject","z":"372e1e33.0db3b2","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"0.5","topic":"","payload":"","payloadType":"date","x":170,"y":1440,"wires":[["442934b0.13507c"]]},{"id":"52279817.d0d5e8","type":"function","z":"9615284c.b28278","name":"Выбор датчиков","func":"var still = {};\nstill.options = [];\nvar tube = {};\ntube.options = [];\nvar chiller = {};\nchiller.options = [];\nvar sens_ids = global.get(\"sensors\").split(';')\nvar sens_still = global.get(\"sensor.still\",'file');\nvar sens_tube = global.get(\"sensor.tube\",'file');\nvar sens_chiller = global.get(\"sensor.chiller\",'file');\n\nfor (i = 0; i < sens_ids.length; i++) {\n    if (sens_ids[i] != sens_chiller && sens_ids[i] != sens_tube){\n        still.options.push(sens_ids[i])\n    }\n    if (sens_ids[i] != sens_still && sens_ids[i] != sens_tube){\n        chiller.options.push(sens_ids[i])\n    }\n    if (sens_ids[i] != sens_still && sens_ids[i] != sens_chiller){\n        tube.options.push(sens_ids[i])\n    }\n}\n//for (const [key, value] of Object.entries(sens_ids)) {\n\n//}\n\nstill.options.push('none')\nstill.payload = sens_still;\n\ntube.options.push('none')\ntube.payload = sens_tube;\n\nchiller.options.push('none')\nchiller.payload = sens_chiller;\n\nreturn [still, tube, chiller];","outputs":3,"noerr":0,"initialize":"","finalize":"","x":550,"y":920,"wires":[["abbb0772.663f78"],["c48f6582.088308"],["bc6b1ba7.0232d8"]]},{"id":"5e18f79b.6529d8","type":"inject","z":"9615284c.b28278","name":"Init startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":148,"y":1680,"wires":[["ce8e8db.2e5b37","420c5e8f.80edd","7f234864.108f58","2577deda.79cc72"]]},{"id":"9e4505f0.fae2a8","type":"inject","z":"9615284c.b28278","name":"Init startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":2440,"wires":[["db826139.278c6","7b77499f.72aab8","8017d842.452978","c0566a01.0bd8f8","82f5493d.dda058","c552f321.e0395","a83570c8.ecc35","7790a040.70d1e","24b34fb8.43a7b","564ae5b.4d5e11c","460bdde9.a2bcf4"]]},{"id":"2f27dfbe.07c22","type":"function","z":"372e1e33.0db3b2","name":"Обработка температуры","func":"var ratio = 0.3\nvar saved_sensors = global.get('sensor','file');\nvar fixed_topic = msg.topic.replace('pimoon/temperature/','');\nvar current_temp_topic = \"sensor.\"+fixed_topic;\nvar prev_temp = global.get(current_temp_topic);\n\nif (isNaN(prev_temp)){\n    prev_temp=msg.payload;\n}\nvar rounded_temperature = prev_temp*ratio+msg.payload*(1-ratio);\nglobal.set(current_temp_topic,rounded_temperature);\nswitch (fixed_topic){\n   case saved_sensors.still:\n       if (!isNaN(global.get('debug.temperature.still'))) {\n        rounded_temperature=rounded_temperature+global.get('debug.temperature.still')\n       }\n       global.set('temperature.still',rounded_temperature);\n       msg.topic='Куб';\n       msg.payload=rounded_temperature;\n       return msg;\n   case saved_sensors.tube:\n       if (!isNaN(global.get('debug.temperature.tube'))) {\n        rounded_temperature=rounded_temperature+global.get('debug.temperature.tube')\n       }       \n       global.set('temperature.tube',rounded_temperature);\n       msg.topic='Царга';\n       msg.payload=rounded_temperature;\n       return msg;\n   case saved_sensors.chiller:\n       if (!isNaN(global.get('debug.temperature.chiller'))) {\n        rounded_temperature=rounded_temperature+global.get('debug.temperature.chiller')\n       }        \n       global.set('temperature.chiller',rounded_temperature);\n       msg.topic='Вода';\n       msg.payload=rounded_temperature;\n       return msg;\n}\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":830,"y":860,"wires":[["a6fb53b9.ec19a"]]},{"id":"37b98a0e.77ad96","type":"switch","z":"372e1e33.0db3b2","name":"check pressure","property":"pressure.current","propertyType":"global","rules":[{"t":"null"}],"checkall":"true","repair":false,"outputs":1,"x":780,"y":600,"wires":[["d78363e2.be075"]]},{"id":"d78363e2.be075","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"set","p":"pressure.current","pt":"global","to":"payload.pressure_hPa","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload.pressure_hPa","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":980,"y":600,"wires":[["d19fb80b.fd4198"]]},{"id":"3b7d894d.6a44d6","type":"switch","z":"372e1e33.0db3b2","name":"check temperature","property":"temperature.system","propertyType":"global","rules":[{"t":"null"}],"checkall":"true","repair":false,"outputs":1,"x":790,"y":680,"wires":[["3df4e99a.c73106"]]},{"id":"3df4e99a.c73106","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"set","p":"temperature.system","pt":"global","to":"payload.temperature_C","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload.temperature_C","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":980,"y":680,"wires":[["3a6e7ceb.a46a64"]]},{"id":"42ac3280.93abbc","type":"switch","z":"372e1e33.0db3b2","name":"","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"Куб","vt":"str"},{"t":"eq","v":"Царга","vt":"str"},{"t":"eq","v":"Вода","vt":"str"}],"checkall":"false","repair":false,"outputs":3,"x":1260,"y":920,"wires":[["480748d3.39b328"],["a150aa8e.e17108"],["81e561a0.d4b47"]]},{"id":"bfb5341b.492e88","type":"link out","z":"372e1e33.0db3b2","name":"To_SVG","links":["87c1479a.8f1b38","790dceac.59d43","96dd8eef.b242c","ee64a708.a83ba8"],"x":2315,"y":920,"wires":[]},{"id":"5cd7dbf8.b861d4","type":"template","z":"372e1e33.0db3b2","name":"Set still svg","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n        \"command\": \"update_text\",\n        \"selector\": \"#cube_txt\",\n        \"textContent\": \"{{payload}}&deg;\"\n}","output":"json","x":1970,"y":820,"wires":[["bfb5341b.492e88"]]},{"id":"480748d3.39b328","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"delete","p":"topic","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":820,"wires":[["5cd7dbf8.b861d4","cf0034a4.c9ab78"]]},{"id":"a150aa8e.e17108","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"delete","p":"topic","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":900,"wires":[["6a8e42.be3f91c","723c371b.6c33f8"]]},{"id":"81e561a0.d4b47","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"delete","p":"topic","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":1000,"wires":[["477d3201.74229c"]]},{"id":"6a8e42.be3f91c","type":"template","z":"372e1e33.0db3b2","name":"Set tube svg","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n\n        \"command\": \"update_text\",\n        \"selector\": \"#tube_txt\",\n        \"textContent\": \"{{payload}}&deg;\"\n}","output":"json","x":1970,"y":900,"wires":[["bfb5341b.492e88"]]},{"id":"477d3201.74229c","type":"template","z":"372e1e33.0db3b2","name":"Set water svg","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n\n        \"command\": \"update_text\",\n        \"selector\": \"#water_txt\",\n        \"textContent\": \"{{payload}}&deg;\"\n}","output":"json","x":1980,"y":1000,"wires":[["bfb5341b.492e88"]]},{"id":"8f626373.8f0c7","type":"switch","z":"9615284c.b28278","name":"check still none","property":"#:(file)::sensor.still","propertyType":"global","rules":[{"t":"eq","v":"none","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1460,"y":860,"wires":[["c88745a2.5de538"]]},{"id":"c88745a2.5de538","type":"template","z":"9615284c.b28278","name":"Set still svg","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n        \"command\": \"update_text\",\n        \"selector\": \"#cube_txt\",\n        \"textContent\": \"N/A\"\n}","output":"json","x":1690,"y":860,"wires":[["4cb59820.f9f1c8"]]},{"id":"2ac569b3.14dcb6","type":"switch","z":"9615284c.b28278","name":"check tube none","property":"#:(file)::sensor.tube","propertyType":"global","rules":[{"t":"eq","v":"none","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1460,"y":920,"wires":[["59193491.7af79c"]]},{"id":"8944c512.f5fb68","type":"switch","z":"9615284c.b28278","name":"check water none","property":"#:(file)::sensor.water","propertyType":"global","rules":[{"t":"eq","v":"none","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1470,"y":980,"wires":[["34993679.7299ca"]]},{"id":"59193491.7af79c","type":"template","z":"9615284c.b28278","name":"Set tube svg","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n        \"command\": \"update_text\",\n        \"selector\": \"#tube_txt\",\n        \"textContent\": \"N/A\"\n}","output":"json","x":1690,"y":920,"wires":[["4cb59820.f9f1c8"]]},{"id":"34993679.7299ca","type":"template","z":"9615284c.b28278","name":"Set water svg","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n        \"command\": \"update_text\",\n        \"selector\": \"#water_txt\",\n        \"textContent\": \"N/A\"\n}","output":"json","x":1700,"y":980,"wires":[["4cb59820.f9f1c8"]]},{"id":"4cb59820.f9f1c8","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"delete","p":"socketid","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":920,"wires":[["14b43b72.5fb525"]]},{"id":"14b43b72.5fb525","type":"link out","z":"9615284c.b28278","name":"To_SVG","links":["87c1479a.8f1b38","790dceac.59d43","96dd8eef.b242c","ee64a708.a83ba8"],"x":2175,"y":820,"wires":[]},{"id":"21f085a4.5525da","type":"change","z":"6546e589.95bfdc","name":"Очистить чарты","rules":[{"t":"set","p":"payload","pt":"msg","to":"[]","tot":"json"},{"t":"set","p":"topic","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1530,"y":660,"wires":[["63166713.fa8b18"]]},{"id":"63166713.fa8b18","type":"link out","z":"6546e589.95bfdc","name":"Очистить чарты Dist","links":["9cb77e59.575a7"],"x":1675,"y":660,"wires":[]},{"id":"9cb77e59.575a7","type":"link in","z":"372e1e33.0db3b2","name":"Очистить чарты","links":["63166713.fa8b18","c3708213.669ce"],"x":2235,"y":640,"wires":[["57fafacb.366bd4","24f84d04.4b4e62","9e62b61d.9d5838","e3a91af6.be25b8"]]},{"id":"331c412b.d30e4e","type":"template","z":"372e1e33.0db3b2","name":"Set power svg text","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n        \"command\": \"update_text\",\n        \"selector\": \"#power_txt\",\n        \"textContent\": \"{{payload}}%\"\n}","output":"json","x":2310,"y":1520,"wires":[["36fa8fcf.643b9"]]},{"id":"36fa8fcf.643b9","type":"link out","z":"372e1e33.0db3b2","name":"To_SVG","links":["87c1479a.8f1b38","790dceac.59d43","96dd8eef.b242c","ee64a708.a83ba8"],"x":2475,"y":1520,"wires":[]},{"id":"2f69fc59.a37854","type":"comment","z":"372e1e33.0db3b2","name":"Управление клапанами","info":"","x":230,"y":1600,"wires":[]},{"id":"5d15c14b.80783","type":"comment","z":"6546e589.95bfdc","name":"Описание процесса дистилляции","info":"","x":200,"y":60,"wires":[]},{"id":"b13305cf.dfe068","type":"mqtt out","z":"372e1e33.0db3b2","name":"","topic":"pimoon/temperature/system","qos":"","retain":"true","broker":"2f65c114.e4d77e","x":1640,"y":760,"wires":[]},{"id":"566c14b2.ca6a7c","type":"mqtt out","z":"372e1e33.0db3b2","name":"","topic":"pimoon/pressure","qos":"","retain":"true","broker":"2f65c114.e4d77e","x":1610,"y":500,"wires":[]},{"id":"5db51fd2.e1ad4","type":"mqtt in","z":"9615284c.b28278","name":"","topic":"pimoon/sensors/","qos":"0","datatype":"auto","broker":"2f65c114.e4d77e","x":100,"y":920,"wires":[["5e42feee.2e22a"]]},{"id":"5e42feee.2e22a","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"sensors","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":310,"y":920,"wires":[["52279817.d0d5e8"]]},{"id":"c2436708.4faf68","type":"ui_ui_control","z":"9615284c.b28278","name":"","events":"all","x":100,"y":1040,"wires":[["52279817.d0d5e8","e072d8b.166ab28","36ef6f4e.83738"]]},{"id":"e675032c.c3355","type":"mqtt in","z":"372e1e33.0db3b2","name":"","topic":"pimoon/temperature/+","qos":"0","datatype":"auto","broker":"2f65c114.e4d77e","x":200,"y":860,"wires":[["f10eafdf.6caa3"]]},{"id":"f10eafdf.6caa3","type":"switch","z":"372e1e33.0db3b2","name":"Только 18b20","property":"topic","propertyType":"msg","rules":[{"t":"neq","v":"pimoon/temperature/system","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":580,"y":860,"wires":[["2f27dfbe.07c22"]]},{"id":"54d7e037.b76ab","type":"template","z":"372e1e33.0db3b2","name":"Set power svg color","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"command\": \"set_attribute\",\n    \"selector\": \"#power\",\n    \"attributeName\": \"fill-opacity\",\n    \"attributeValue\": \"{{payload}}\"\n}","output":"json","x":2310,"y":1580,"wires":[["36fa8fcf.643b9"]]},{"id":"6364c5fa.e1a87c","type":"change","z":"372e1e33.0db3b2","name":"pyload to percent","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload/100","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":1580,"wires":[["54d7e037.b76ab"]]},{"id":"6b556a7d.28d4d4","type":"switch","z":"6546e589.95bfdc","name":"Достигли рабочей температуры?","property":"temperature.still","propertyType":"global","rules":[{"t":"lt","v":"process.dist.temp.work","vt":"global"},{"t":"null"},{"t":"eq","v":"0","vt":"num"},{"t":"gte","v":"process.dist.temp.work","vt":"global"}],"checkall":"false","repair":false,"outputs":4,"x":600,"y":260,"wires":[["ce884fc9.e7b24"],["4171904b.0cc9f"],["4171904b.0cc9f"],["deb1aa38.ba5e38"]]},{"id":"deb1aa38.ba5e38","type":"change","z":"6546e589.95bfdc","name":"Начинаем отбор","rules":[{"t":"set","p":"payload","pt":"msg","to":"Отбор","tot":"str"},{"t":"set","p":"process.dist.stage","pt":"global","to":"work","tot":"str"},{"t":"set","p":"valve.water.on","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1230,"y":280,"wires":[["5a864dc3.166c24","4e077f32.6a0e9","771616cf.e57f38"]]},{"id":"5a864dc3.166c24","type":"switch","z":"6546e589.95bfdc","name":"Достигли финальной температуры?","property":"temperature.still","propertyType":"global","rules":[{"t":"lt","v":"process.dist.temp.end","vt":"global"},{"t":"null"},{"t":"eq","v":"0","vt":"num"},{"t":"gte","v":"process.dist.temp.end","vt":"global"}],"checkall":"false","repair":false,"outputs":4,"x":1650,"y":280,"wires":[["b114d023.5a0a9"],["d84618c.b3a7ce8"],["d84618c.b3a7ce8"],["4c39e101.5bfa7"]]},{"id":"4c39e101.5bfa7","type":"change","z":"6546e589.95bfdc","name":"Охлаждение колонны","rules":[{"t":"set","p":"process.dist.stage","pt":"global","to":"cooling","tot":"str"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"on","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":300,"wires":[["ef363b93.0b0f88","3b9f65b0.1d6baa","124d7b5a.5e7ae5"]]},{"id":"f316229e.c144d","type":"change","z":"6546e589.95bfdc","name":"Разогрев","rules":[{"t":"set","p":"payload","pt":"msg","to":"Разогрев","tot":"str"},{"t":"set","p":"valve.water.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":260,"wires":[["6b556a7d.28d4d4","3a42c0d7.d8a24","179a60c2.3f757f"]]},{"id":"7dfbcdf3.e02f44","type":"change","z":"6546e589.95bfdc","name":"Final!","rules":[{"t":"set","p":"process.dist.stage","pt":"global","to":"final","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"},{"t":"set","p":"valve.water.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":2970,"y":360,"wires":[["1138feb5.d67181"]]},{"id":"a6fb53b9.ec19a","type":"change","z":"372e1e33.0db3b2","name":"Округляем Т","rules":[{"t":"set","p":"payload","pt":"msg","to":"$round($number(payload), 2)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1070,"y":860,"wires":[["42ac3280.93abbc","b1d12ac5.b71a88"]]},{"id":"fb36a712.8150b8","type":"link out","z":"6546e589.95bfdc","name":"Web Audio OUT1","links":["cff23124.5e79","d6e6a230.d2666"],"x":2895,"y":260,"wires":[]},{"id":"1138feb5.d67181","type":"link out","z":"6546e589.95bfdc","name":"Disable start button","links":["d9576b15.cf5d68"],"x":3095,"y":360,"wires":[]},{"id":"d9576b15.cf5d68","type":"link in","z":"6546e589.95bfdc","name":"Start Button In","links":["1138feb5.d67181","db117765.320e18","a8000a69.b31a78","e94029e1.f235e8","fbeee554.b13df8"],"x":1015,"y":800,"wires":[["3504aa52.957e86"]]},{"id":"5d00e54f.09672c","type":"switch","z":"6546e589.95bfdc","name":"!=final or !=error_finish","property":"process.dist.stage","propertyType":"global","rules":[{"t":"eq","v":"final","vt":"str"},{"t":"eq","v":"error_finish","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":1540,"y":880,"wires":[[],[],["4a1972d2.33c3bc","448665f9.36015c","1aa6ee79.708842"]]},{"id":"448665f9.36015c","type":"change","z":"6546e589.95bfdc","name":"Disable process","rules":[{"t":"set","p":"process.dist.stage","pt":"global","to":"hand_finish","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":940,"wires":[["2c2aa0f9.9bb67"]]},{"id":"b51c2d83.805eb","type":"template","z":"372e1e33.0db3b2","name":"Set tube svg color","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"command\": \"set_attribute\",\n    \"selector\": \"#tube\",\n    \"attributeName\": \"fill-opacity\",\n    \"attributeValue\": \"{{payload}}\"\n}","output":"json","x":1990,"y":940,"wires":[["bfb5341b.492e88"]]},{"id":"723c371b.6c33f8","type":"change","z":"372e1e33.0db3b2","name":"pyload to percent","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload/100","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1770,"y":940,"wires":[["b51c2d83.805eb"]]},{"id":"cf0034a4.c9ab78","type":"change","z":"372e1e33.0db3b2","name":"pyload to percent","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload/100","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1770,"y":860,"wires":[["f83b5e97.1d5ef"]]},{"id":"f83b5e97.1d5ef","type":"template","z":"372e1e33.0db3b2","name":"Set still svg color","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"command\": \"set_attribute\",\n    \"selector\": \"#cube\",\n    \"attributeName\": \"fill-opacity\",\n    \"attributeValue\": \"{{payload}}\"\n}","output":"json","x":1990,"y":860,"wires":[["bfb5341b.492e88"]]},{"id":"6dd444d3.08a22c","type":"comment","z":"372e1e33.0db3b2","name":"GPIO ORANGE PI","info":"VLV WATER - 16\nVLV BODY  - 18\nVLV HEADS - 26\n\nDS_SENSE  - 12\n\nPWC       - 37\n\nUART TX   - 38\nUART RX   - 40\n\nADCA1     - 29\nADCA2     - 31\nADCA3     - 33\nADCA4     - 35","x":170,"y":40,"wires":[]},{"id":"4f4432d8.77d4bc","type":"inject","z":"372e1e33.0db3b2","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":true,"onceDelay":"0.5","topic":"","payload":"","payloadType":"date","x":190,"y":1940,"wires":[["ea4f914e.3a9ad","f3f20fda.af55","54361be3.81a354"]]},{"id":"a1bc59fa.b1a2b8","type":"comment","z":"372e1e33.0db3b2","name":"Клапан воды","info":"","x":390,"y":1700,"wires":[]},{"id":"28453bfb.b67144","type":"switch","z":"372e1e33.0db3b2","name":"Open/close water?","property":"valve.water.on","propertyType":"global","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":810,"y":1760,"wires":[["c0c44f4f.cf784"],["48d386b1.75e3b8"]]},{"id":"ea4f914e.3a9ad","type":"switch","z":"372e1e33.0db3b2","name":"Ручное/автоматическое управление","property":"valve.water.hand","propertyType":"global","rules":[{"t":"eq","v":"true","vt":"str"},{"t":"eq","v":"auto","vt":"str"},{"t":"eq","v":"false","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":460,"y":1760,"wires":[["c0c44f4f.cf784"],["28453bfb.b67144"],["48d386b1.75e3b8"]]},{"id":"c4c6a877.e1bfb8","type":"opi_out","z":"372e1e33.0db3b2","name":"Pin 16 - PC4","set":true,"level":"0","select":"PC","pin":"68","x":1330,"y":1700,"wires":[]},{"id":"a3cbbd2a.b64fb","type":"comment","z":"372e1e33.0db3b2","name":"Клапан голов","info":"","x":390,"y":1880,"wires":[]},{"id":"bd681e02.4b086","type":"switch","z":"372e1e33.0db3b2","name":"Open/close heads?","property":"valve.heads.on","propertyType":"global","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":830,"y":1940,"wires":[["5abea26a.cee69c"],["d7a23eaf.ffacb"]]},{"id":"f3f20fda.af55","type":"switch","z":"372e1e33.0db3b2","name":"Ручное/автоматическое управление","property":"valve.heads.hand","propertyType":"global","rules":[{"t":"eq","v":"true","vt":"str"},{"t":"eq","v":"auto","vt":"str"},{"t":"eq","v":"false","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":460,"y":1940,"wires":[["5abea26a.cee69c"],["bd681e02.4b086"],["d7a23eaf.ffacb"]]},{"id":"28a6c6cd.5139fa","type":"opi_out","z":"372e1e33.0db3b2","name":"Pin 26 - PA21","set":true,"level":"0","select":"PC","pin":"21","x":1340,"y":1880,"wires":[]},{"id":"3d1719ad.c96a86","type":"comment","z":"372e1e33.0db3b2","name":"Клапан тела","info":"","x":390,"y":2080,"wires":[]},{"id":"ffc1db52.6a3148","type":"switch","z":"372e1e33.0db3b2","name":"Open/close body?","property":"valve.body.on","propertyType":"global","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":1610,"y":2160,"wires":[["15551031.970d1"],["dddaebcc.74ce48"]]},{"id":"7987cb77.2949e4","type":"switch","z":"372e1e33.0db3b2","name":"Ручное/автоматическое управление","property":"valve.body.hand","propertyType":"global","rules":[{"t":"eq","v":"true","vt":"str"},{"t":"eq","v":"auto","vt":"str"},{"t":"eq","v":"false","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":710,"y":2300,"wires":[["15551031.970d1","fe5cac12.c2a38"],["893ef492.771578"],["f5adb46d.380098"]]},{"id":"296dbd5f.2e6ec2","type":"opi_out","z":"372e1e33.0db3b2","name":"Pin 18 - PC7","set":true,"level":"0","select":"PC","pin":"71","x":3650,"y":2160,"wires":[]},{"id":"7351d480.63a13c","type":"comment","z":"372e1e33.0db3b2","name":"TODO: написать поджим отбора","info":"","x":2670,"y":2220,"wires":[]},{"id":"db20cbcb.b1e398","type":"comment","z":"372e1e33.0db3b2","name":"Проверка датчиков","info":"","x":210,"y":2540,"wires":[]},{"id":"208cd095.b6ad","type":"inject","z":"372e1e33.0db3b2","name":"Set defaults","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":170,"y":120,"wires":[["1f645303.3f26ed"]]},{"id":"723c5037.401e5","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"set","p":"process.type","pt":"global","to":"none","tot":"str"},{"t":"set","p":"process.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.water.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.body.hand","pt":"global","to":"auto","tot":"str"},{"t":"set","p":"valve.heads.hand","pt":"global","to":"auto","tot":"str"},{"t":"set","p":"valve.water.hand","pt":"global","to":"auto","tot":"str"},{"t":"set","p":"process.reflux.startstop","pt":"global","to":"0","tot":"num"},{"t":"delete","p":"process.reflux.tempalert","pt":"global"},{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":120,"wires":[["1006a259.ddd22e","bcf44351.aa671"]]},{"id":"c0c44f4f.cf784","type":"change","z":"372e1e33.0db3b2","name":"On","rules":[{"t":"set","p":"payload","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":1700,"wires":[["c4c6a877.e1bfb8","7667abc6.010b74","9fd6ad99.3854f"]]},{"id":"48d386b1.75e3b8","type":"change","z":"372e1e33.0db3b2","name":"Off","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":1820,"wires":[["c4c6a877.e1bfb8","7667abc6.010b74","9fd6ad99.3854f"]]},{"id":"5abea26a.cee69c","type":"change","z":"372e1e33.0db3b2","name":"On","rules":[{"t":"set","p":"payload","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":1880,"wires":[["28a6c6cd.5139fa","fc0bcc59.0f0c2"]]},{"id":"d7a23eaf.ffacb","type":"change","z":"372e1e33.0db3b2","name":"Off","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":2000,"wires":[["28a6c6cd.5139fa","fc0bcc59.0f0c2"]]},{"id":"15551031.970d1","type":"change","z":"372e1e33.0db3b2","name":"On","rules":[{"t":"set","p":"payload","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2510,"y":1920,"wires":[["296dbd5f.2e6ec2","6032dab3.9a7654","c925c966.1d8018"]]},{"id":"620666a7.f66308","type":"change","z":"372e1e33.0db3b2","name":"Off","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3030,"y":2460,"wires":[["296dbd5f.2e6ec2","6032dab3.9a7654","c925c966.1d8018"]]},{"id":"6032dab3.9a7654","type":"ui_led","z":"372e1e33.0db3b2","group":"6cfb75c2.e1263c","order":3,"width":0,"height":0,"label":"Клапан отбора","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"orange","value":"0","valueType":"num"},{"color":"green","value":"1","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Клапан отбора Dist","x":3200,"y":2240,"wires":[]},{"id":"7667abc6.010b74","type":"ui_led","z":"372e1e33.0db3b2","group":"6cfb75c2.e1263c","order":2,"width":0,"height":0,"label":"Клапан воды","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"orange","value":"0","valueType":"num"},{"color":"green","value":"1","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Клапан воды Dist","x":1350,"y":1820,"wires":[]},{"id":"893ef492.771578","type":"switch","z":"372e1e33.0db3b2","name":"Process Type?","property":"process.type","propertyType":"global","rules":[{"t":"eq","v":"dist","vt":"str"},{"t":"eq","v":"reflux","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":1060,"y":2300,"wires":[["ffc1db52.6a3148"],["fb8f98ba.5e0968"],["342684d5.de28fc"]]},{"id":"fb8f98ba.5e0968","type":"switch","z":"372e1e33.0db3b2","name":"Reflux Stage?","property":"process.reflux.stage","propertyType":"global","rules":[{"t":"eq","v":"head","vt":"str"},{"t":"eq","v":"body","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":1340,"y":2300,"wires":[["7981340.e0911cc"],["4535976f.442418"],["fab985a0.2eaf38"]]},{"id":"9e16dde.7754b2","type":"configurable interval","z":"372e1e33.0db3b2","name":"configurable interval","interval":10,"onstart":false,"do_enable":false,"msg":"true","showstatus":true,"unit":"seconds","statusformat":"YYYY-MM-D HH:mm:ss","x":2340,"y":2280,"wires":[["6be59e14.d7dca","15551031.970d1"]]},{"id":"3d8396b7.2d5f4a","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"delayv","timeout":"0","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2880,"y":2280,"wires":[["620666a7.f66308"]]},{"id":"3684c44d.3bb2dc","type":"change","z":"372e1e33.0db3b2","name":"Disable interval","rules":[{"t":"set","p":"payload","pt":"msg","to":"disabled","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2100,"y":2440,"wires":[["9e16dde.7754b2"]]},{"id":"14cc3202.e6634e","type":"change","z":"372e1e33.0db3b2","name":"Enable interval","rules":[{"t":"set","p":"payload","pt":"msg","to":"enabled","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2100,"y":2180,"wires":[["9e16dde.7754b2"]]},{"id":"7981340.e0911cc","type":"change","z":"372e1e33.0db3b2","name":"head freq","rules":[{"t":"set","p":"payload","pt":"msg","to":"interval","tot":"str"},{"t":"set","p":"interval_value","pt":"msg","to":"process.reflux.valve.head.frequency","tot":"global"},{"t":"set","p":"interval_unit","pt":"msg","to":"seconds","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1600,"y":2240,"wires":[["14cc3202.e6634e","9e16dde.7754b2"]]},{"id":"438054e6.40be1c","type":"change","z":"372e1e33.0db3b2","name":"body freq","rules":[{"t":"set","p":"payload","pt":"msg","to":"interval","tot":"str"},{"t":"set","p":"interval_value","pt":"msg","to":"process.reflux.valve.body.frequency","tot":"global"},{"t":"set","p":"interval_unit","pt":"msg","to":"seconds","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1880,"y":2300,"wires":[["14cc3202.e6634e","9e16dde.7754b2"]]},{"id":"6be59e14.d7dca","type":"function","z":"372e1e33.0db3b2","name":"Set valve close","func":"var timeloop = msg.payload;\nvar valve;\nvar out1 = { delay: 0 };\nvar timeout;\n\nswitch(global.get(\"process.reflux.stage\", \"memoryOnly\")){\n    case \"head\":\n        valve = global.get(\"process.reflux.valve.head\", \"memoryOnly\");\n        timeout = valve.frequency*1000*valve.opentime/100;\n        break;\n    case \"body\":\n        valve = global.get(\"process.reflux.valve.body\", \"memoryOnly\");\n        timeout = valve.frequency*1000*valve.opentime/100;\n        break;\n    default:\n        valve = null;\n        break;\n}\n\nout1 = { delay: timeout };\n\nreturn out1;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2640,"y":2280,"wires":[["3d8396b7.2d5f4a"]]},{"id":"37edbdc6.aabe02","type":"inject","z":"372e1e33.0db3b2","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":170,"y":2620,"wires":[["5a1e54ec.a5f93c","5c176aa8.0cb7d4","92b9f6a9.5a56a8"]]},{"id":"dfb578a4.8076a8","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"set","p":"safe.liquid","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":2620,"wires":[["65459f87.a40ea","8471d76b.1764b8","a9648813.5743b8"]]},{"id":"65459f87.a40ea","type":"ui_led","z":"372e1e33.0db3b2","group":"6cfb75c2.e1263c","order":4,"width":7,"height":1,"label":"Датчик Жидкости","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"red","value":"1","valueType":"num"},{"color":"blue","value":"0","valueType":"num"},{"color":"gray","value":"3","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Датчик Жидкости","x":1590,"y":2620,"wires":[]},{"id":"54361be3.81a354","type":"switch","z":"372e1e33.0db3b2","name":"Get global safe liquid","property":"safe.liquid","propertyType":"global","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":400,"y":2280,"wires":[["dee5200c.fa6c"],["7987cb77.2949e4"]]},{"id":"3597914e.d7543e","type":"switch","z":"7459d84c.edbbd8","name":"","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1110,"y":1560,"wires":[["7185a828.748958","7f323b66.ca6f14"],["acd5fb98.9128e8","7f323b66.ca6f14"]]},{"id":"acd5fb98.9128e8","type":"change","z":"7459d84c.edbbd8","name":"Disable process","rules":[{"t":"set","p":"process.type","pt":"global","to":"none","tot":"str"},{"t":"set","p":"process.on","pt":"global","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"white\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":1740,"wires":[["896721b4.7f35c","d91cba76.c051e8","4b55b6f8.f814c8"]]},{"id":"7185a828.748958","type":"change","z":"7459d84c.edbbd8","name":"Enable process","rules":[{"t":"set","p":"process.type","pt":"global","to":"reflux","tot":"str"},{"t":"set","p":"process.on","pt":"global","to":"payload","tot":"msg"},{"t":"set","p":"process.reflux.stage","pt":"global","to":"heat","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"red\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":1400,"wires":[["fd030360.74ea5","900a8963.2f6598","379a4d18.7ee1e2","c4ac0c03.784c5"]]},{"id":"7c54daa0.eb3b44","type":"change","z":"7459d84c.edbbd8","name":"Disable process","rules":[{"t":"set","p":"process.reflux.stage","pt":"global","to":"hand_finish","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1780,"y":1660,"wires":[["f43ddbec.9e5db8"]]},{"id":"fd030360.74ea5","type":"link out","z":"7459d84c.edbbd8","name":"Reflux Start/Stop Process","links":["2e9fa827.bfcb18","96dd8eef.b242c"],"x":1715,"y":1540,"wires":[]},{"id":"900a8963.2f6598","type":"change","z":"7459d84c.edbbd8","name":"Очистить чарты","rules":[{"t":"set","p":"payload","pt":"msg","to":"[]","tot":"json"},{"t":"set","p":"topic","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1550,"y":1340,"wires":[["c3708213.669ce"]]},{"id":"c3708213.669ce","type":"link out","z":"7459d84c.edbbd8","name":"Очистить чарты Reflux","links":["9cb77e59.575a7"],"x":1695,"y":1340,"wires":[]},{"id":"c8812022.a5a02","type":"switch","z":"372e1e33.0db3b2","name":"dist/reflux","property":"process.type","propertyType":"global","rules":[{"t":"eq","v":"dist","vt":"str"},{"t":"eq","v":"reflux","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1860,"y":560,"wires":[["9e62b61d.9d5838"],["e3a91af6.be25b8"]]},{"id":"3a727a32.1091c6","type":"switch","z":"372e1e33.0db3b2","name":"dist/reflux","property":"process.type","propertyType":"global","rules":[{"t":"eq","v":"dist","vt":"str"},{"t":"eq","v":"reflux","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1860,"y":700,"wires":[["57fafacb.366bd4"],["24f84d04.4b4e62"]]},{"id":"e3a91af6.be25b8","type":"ui_chart","z":"372e1e33.0db3b2","name":"Давление Reflux","group":"dc8ecbb3.7cff88","order":8,"width":0,"height":0,"label":"Давление","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"monotone","nodata":"Данных нет","dot":false,"ymin":"","ymax":"","removeOlder":"10","removeOlderPoints":"3000","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":2450,"y":600,"wires":[[]]},{"id":"24f84d04.4b4e62","type":"ui_chart","z":"372e1e33.0db3b2","name":"Температура Reflux","group":"dc8ecbb3.7cff88","order":7,"width":7,"height":5,"label":"Температура","chartType":"line","legend":"true","xformat":"HH:mm:ss","interpolate":"monotone","nodata":"Данных нет","dot":false,"ymin":"","ymax":"","removeOlder":"10","removeOlderPoints":"3000","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#949994","#eb7e11","#35e43e","#348de4","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":2460,"y":720,"wires":[[]]},{"id":"ad7acba8.9703f8","type":"template","z":"372e1e33.0db3b2","name":"Set press svg","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n        \"command\": \"update_text\",\n        \"selector\": \"#press_txt\",\n        \"textContent\": \"{{payload}} мм.рт.ст.\"\n}","output":"json","x":1980,"y":780,"wires":[["bfb5341b.492e88"]]},{"id":"340232ca.023ece","type":"ui_ui_control","z":"6546e589.95bfdc","name":"","events":"connect","x":2420,"y":840,"wires":[[]]},{"id":"2a7ff664.1434ca","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"delete","p":"topic","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1400,"y":620,"wires":[["ad7acba8.9703f8"]]},{"id":"bf5a63b7.8f061","type":"change","z":"6546e589.95bfdc","name":"Disable reflux tab","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tabs\":{\"disable\":\"Ректификация\"}}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1970,"y":720,"wires":[["cdc6397a.3caaa8","455fc137.45739","9187323c.88a3f"]]},{"id":"7287de07.41a92","type":"change","z":"6546e589.95bfdc","name":"Enable reflux tab","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tabs\":{\"show\":\"Ректификация\",\"enable\":\"Ректификация\"}}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1970,"y":1000,"wires":[["37cf056f.442c1a","9187323c.88a3f"]]},{"id":"379a4d18.7ee1e2","type":"change","z":"7459d84c.edbbd8","name":"Disable Dist tab","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tabs\":{\"disable\":\"Дистилляция\"}}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":1400,"wires":[["a731a466.f59338","b7beebe6.133a68","6ee057fe.6d0f98"]]},{"id":"896721b4.7f35c","type":"change","z":"7459d84c.edbbd8","name":"Enable Dist tab","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tabs\":{\"show\":\"Дистилляция\",\"enable\":\"Дистилляция\"}}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":1740,"wires":[["30930a4e.5c1816","6ee057fe.6d0f98"]]},{"id":"82865879.7450a8","type":"ui_ui_control","z":"7459d84c.edbbd8","name":"","events":"connect","x":2440,"y":1540,"wires":[[]]},{"id":"ec22a2b8.b1bc3","type":"ui_audio","z":"372e1e33.0db3b2","name":"","group":"6cfb75c2.e1263c","voice":"ru-RU","always":true,"x":600,"y":3140,"wires":[]},{"id":"d6e6a230.d2666","type":"link in","z":"372e1e33.0db3b2","name":"Web Audio IN","links":["1d8a1925.ed5507","fb36a712.8150b8","bd927dae.1924","5f6fb82e.fcfae8","29284235.af34be","a008d6fc.17c658","d1a22870.bc4e58","3b43e42d.1b039c","988a6b63.4ca438","db49d0a1.8e74a","a35ea375.91a7e","df84d271.abf1b","4e077f32.6a0e9","bd707b3c.6a0088","da97c4bb.fe3418","1b90cb2d.ccdf45"],"x":255,"y":3200,"wires":[["f32d3793.df2758"]]},{"id":"f32d3793.df2758","type":"switch","z":"372e1e33.0db3b2","name":"Buzzer on?","property":"#:(file)::buzzer_on","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":370,"y":3200,"wires":[["ec22a2b8.b1bc3","53431744.1ec108"]]},{"id":"6c90a239.ee82fc","type":"comment","z":"372e1e33.0db3b2","name":"Управление звуком","info":"","x":240,"y":3140,"wires":[]},{"id":"1cc506ac.109339","type":"opi_in","z":"372e1e33.0db3b2","name":"Pin 29 - PA7","opi":true,"enableInterrupt":false,"edge":"both","debounce":"1000","select":"PC","pin":"7","x":650,"y":2620,"wires":[["52818ebe.07698"]]},{"id":"52818ebe.07698","type":"change","z":"372e1e33.0db3b2","name":"Set topic 1","rules":[{"t":"set","p":"topic","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":2620,"wires":[["b73755f8.23f558"]]},{"id":"b2ea9f38.c0401","type":"change","z":"372e1e33.0db3b2","name":"Set topic 2","rules":[{"t":"set","p":"topic","pt":"msg","to":"2","tot":"num"},{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":2680,"wires":[["b73755f8.23f558"]]},{"id":"3011ea3c.933856","type":"change","z":"372e1e33.0db3b2","name":"Set topic 3","rules":[{"t":"set","p":"topic","pt":"msg","to":"3","tot":"num"},{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":2740,"wires":[["b73755f8.23f558"]]},{"id":"fad65cf9.2a151","type":"change","z":"372e1e33.0db3b2","name":"Set topic 4","rules":[{"t":"set","p":"topic","pt":"msg","to":"4","tot":"num"},{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":2800,"wires":[["b73755f8.23f558"]]},{"id":"1cf644b9.92df3b","type":"opi_in","z":"372e1e33.0db3b2","name":"Pin 31 - PA8","opi":true,"enableInterrupt":false,"edge":"both","debounce":"1000","select":"PC","pin":"8","x":650,"y":2680,"wires":[["b2ea9f38.c0401"]]},{"id":"fcd61808.855f18","type":"opi_in","z":"372e1e33.0db3b2","name":"Pin 33 - PA9","opi":true,"enableInterrupt":false,"edge":"both","debounce":"1000","select":"PC","pin":"9","x":650,"y":2740,"wires":[["3011ea3c.933856"]]},{"id":"8d7ab1bd.9adad","type":"opi_in","z":"372e1e33.0db3b2","name":"Pin 35 - PA10","opi":true,"enableInterrupt":false,"edge":"both","debounce":"1000","select":"PC","pin":"10","x":660,"y":2800,"wires":[["fad65cf9.2a151"]]},{"id":"b73755f8.23f558","type":"switch","z":"372e1e33.0db3b2","name":"what sensor?","property":"topic","propertyType":"msg","rules":[{"t":"eq","v":"#:(file)::sensor.liquid","vt":"global"},{"t":"eq","v":"#:(file)::sensor.water","vt":"global"},{"t":"eq","v":"#:(file)::sensor.alch","vt":"global"}],"checkall":"true","repair":false,"outputs":3,"x":1090,"y":2720,"wires":[["dfb578a4.8076a8"],["7bdb3870.ff3088"],["63e5670e.c91e08"]]},{"id":"9a996361.1c45c","type":"change","z":"372e1e33.0db3b2","name":"Gray Out disabled","rules":[{"t":"set","p":"topic","pt":"msg","to":"5","tot":"num"},{"t":"set","p":"payload","pt":"msg","to":"3","tot":"num"},{"t":"set","p":"enabled","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":870,"y":2860,"wires":[["b73755f8.23f558"]]},{"id":"7bdb3870.ff3088","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"set","p":"safe.water","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":2720,"wires":[["7c70a111.7e522"]]},{"id":"7c70a111.7e522","type":"ui_led","z":"372e1e33.0db3b2","d":true,"group":"6cfb75c2.e1263c","order":4,"width":7,"height":1,"label":"Датчик Протечки","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"red","value":"1","valueType":"num"},{"color":"blue","value":"0","valueType":"num"},{"color":"gray","value":"3","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Датчик Протечки","x":1590,"y":2720,"wires":[]},{"id":"3b716e66.beda52","type":"ui_dropdown","z":"9615284c.b28278","name":"","label":"Датчик паров:","tooltip":"","place":"Выбери датчик","group":"5471a0c0.7d6db","order":8,"width":0,"height":0,"passthru":false,"multiple":false,"options":[{"label":"1","value":1,"type":"num"},{"label":"2","value":2,"type":"num"},{"label":"3","value":3,"type":"num"},{"label":"4","value":4,"type":"num"},{"label":"нет","value":5,"type":"num"}],"payload":"","topic":"","x":840,"y":1120,"wires":[["91d9f54c.625a48"]]},{"id":"fe88433a.1c6e3","type":"ui_dropdown","z":"9615284c.b28278","name":"","label":"Датчик протечки:","tooltip":"","place":"Выбери датчик","group":"5471a0c0.7d6db","order":9,"width":0,"height":0,"passthru":false,"multiple":false,"options":[{"label":"1","value":1,"type":"num"},{"label":"2","value":2,"type":"num"},{"label":"3","value":3,"type":"num"},{"label":"4","value":4,"type":"num"},{"label":"нет","value":5,"type":"num"}],"payload":"","topic":"","x":850,"y":1180,"wires":[["9a871bcc.97e0d8"]]},{"id":"91d9f54c.625a48","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::sensor.alch","pt":"global","to":"$number(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1120,"wires":[["e072d8b.166ab28"]]},{"id":"9a871bcc.97e0d8","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::sensor.water","pt":"global","to":"$number(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":1180,"wires":[["e072d8b.166ab28"]]},{"id":"e072d8b.166ab28","type":"function","z":"9615284c.b28278","name":"Выбор датчиков защиты","func":"var liquid = {};\nliquid.options = [];\nvar alch = {};\nalch.options = [];\nvar water = {};\nwater.options = [];\n\nvar sens_liquid = global.get(\"sensor.liquid\",'file');\nif (isNaN(sens_liquid)) sens_liquid = 5;\nvar sens_alch = global.get(\"sensor.alch\",'file');\nif (isNaN(sens_alch)) sens_alch = 5;\nvar sens_water = global.get(\"sensor.water\",'file');\nif (isNaN(sens_water)) sens_water = 5;\n\nfor (i = 1; i < 5; i++) {\n    if (i != sens_alch && i != sens_water){\n        liquid.options.push(i)\n    }\n    if (i != sens_liquid && i != sens_water){\n        alch.options.push(i)\n    }\n    if (i != sens_alch && i != sens_liquid){\n        water.options.push(i)\n    }\n}\n\nliquid.payload = sens_liquid;\nliquid.options.push({\"Нет\":5})\nalch.payload = sens_alch;\nalch.options.push({\"Нет\":5})\nwater.payload = sens_water;\nwater.options.push({\"Нет\":5})\nreturn [liquid, alch, water];","outputs":3,"noerr":0,"initialize":"","finalize":"","x":570,"y":1120,"wires":[["1dbbfb82.dc65c4"],["3b716e66.beda52"],["fe88433a.1c6e3"]]},{"id":"b26823b0.20ee3","type":"ui_led","z":"372e1e33.0db3b2","d":true,"group":"6cfb75c2.e1263c","order":4,"width":7,"height":1,"label":"Датчик Паров","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"red","value":"1","valueType":"num"},{"color":"blue","value":"0","valueType":"num"},{"color":"gray","value":"3","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Датчик Паров","x":1580,"y":2800,"wires":[]},{"id":"63e5670e.c91e08","type":"change","z":"372e1e33.0db3b2","name":"","rules":[{"t":"set","p":"safe.alch","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1310,"y":2800,"wires":[["b26823b0.20ee3"]]},{"id":"5a1e54ec.a5f93c","type":"switch","z":"372e1e33.0db3b2","name":"sensor.liquid","property":"#:(file)::sensor.liquid","propertyType":"global","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"3","vt":"num"},{"t":"eq","v":"4","vt":"num"},{"t":"eq","v":"5","vt":"num"}],"checkall":"true","repair":false,"outputs":5,"x":370,"y":2620,"wires":[["1cc506ac.109339"],["1cf644b9.92df3b"],["fcd61808.855f18"],["8d7ab1bd.9adad"],["9a996361.1c45c"]]},{"id":"5c176aa8.0cb7d4","type":"switch","z":"372e1e33.0db3b2","name":"sensor.water","property":"#:(file)::sensor.water","propertyType":"global","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"3","vt":"num"},{"t":"eq","v":"4","vt":"num"},{"t":"eq","v":"5","vt":"num"}],"checkall":"true","repair":false,"outputs":5,"x":370,"y":2720,"wires":[["1cc506ac.109339"],["1cf644b9.92df3b"],["fcd61808.855f18"],["8d7ab1bd.9adad"],["9a996361.1c45c"]]},{"id":"92b9f6a9.5a56a8","type":"switch","z":"372e1e33.0db3b2","name":"sensor.alch","property":"#:(file)::sensor.alch","propertyType":"global","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"3","vt":"num"},{"t":"eq","v":"4","vt":"num"},{"t":"eq","v":"5","vt":"num"}],"checkall":"true","repair":false,"outputs":5,"x":370,"y":2820,"wires":[["1cc506ac.109339"],["1cf644b9.92df3b"],["fcd61808.855f18"],["8d7ab1bd.9adad"],["9a996361.1c45c"]]},{"id":"8471d76b.1764b8","type":"ui_led","z":"372e1e33.0db3b2","group":"dc8ecbb3.7cff88","order":5,"width":7,"height":1,"label":"Датчик Жидкости","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"red","value":"1","valueType":"num"},{"color":"blue","value":"0","valueType":"num"},{"color":"gray","value":"3","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Датчик Жидкости","x":1590,"y":2660,"wires":[]},{"id":"c925c966.1d8018","type":"ui_led","z":"372e1e33.0db3b2","group":"dc8ecbb3.7cff88","order":3,"width":0,"height":0,"label":"Клапан отбора","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"orange","value":"0","valueType":"num"},{"color":"green","value":"1","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Клапан отбора Rect","x":3200,"y":2160,"wires":[]},{"id":"9fd6ad99.3854f","type":"ui_led","z":"372e1e33.0db3b2","group":"dc8ecbb3.7cff88","order":2,"width":0,"height":0,"label":"Клапан воды","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"orange","value":"0","valueType":"num"},{"color":"green","value":"1","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Клапан воды Rect","x":1350,"y":1780,"wires":[]},{"id":"fc0bcc59.0f0c2","type":"ui_led","z":"372e1e33.0db3b2","group":"dc8ecbb3.7cff88","order":4,"width":0,"height":0,"label":"Клапан голов","labelPlacement":"left","labelAlignment":"left","colorForValue":[{"color":"orange","value":"0","valueType":"num"},{"color":"green","value":"1","valueType":"num"}],"allowColorForValueInMessage":false,"name":"Клапан голов Rect","x":1350,"y":2000,"wires":[]},{"id":"7d4c45df.e911cc","type":"comment","z":"7459d84c.edbbd8","name":"Описание процесса ректификации","info":"","x":200,"y":60,"wires":[]},{"id":"26c5227c.da5cfe","type":"switch","z":"7459d84c.edbbd8","name":"Достигли рабочей температуры?","property":"temperature.tube","propertyType":"global","rules":[{"t":"lt","v":"process.reflux.temp.work","vt":"global"},{"t":"null"},{"t":"eq","v":"0","vt":"num"},{"t":"gte","v":"process.reflux.temp.work","vt":"global"}],"checkall":"false","repair":false,"outputs":4,"x":720,"y":180,"wires":[["22dbc644.e7696a"],["cf49dcb7.6837"],["cf49dcb7.6837"],["4691be29.e5c4"]]},{"id":"4691be29.e5c4","type":"change","z":"7459d84c.edbbd8","name":"Начинаем стабилизацию","rules":[{"t":"set","p":"payload","pt":"msg","to":"Стабилизация","tot":"str"},{"t":"set","p":"process.reflux.stage","pt":"global","to":"stabilize","tot":"str"},{"t":"set","p":"process.reflux.startstab","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"valve.water.on","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"timeout","pt":"msg","to":"$globalContext('process.reflux.stabtime')*60","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1230,"y":200,"wires":[["5f6fb82e.fcfae8","af007b4f.1cb418","77000e6.1bdc0f"]]},{"id":"94b23bea.387cc8","type":"switch","z":"7459d84c.edbbd8","name":"Достигли финальной температуры?","property":"temperature.still","propertyType":"global","rules":[{"t":"lt","v":"process.reflux.temp.end","vt":"global"},{"t":"null"},{"t":"eq","v":"0","vt":"num"},{"t":"gte","v":"process.reflux.temp.end","vt":"global"}],"checkall":"false","repair":false,"outputs":4,"x":350,"y":740,"wires":[["3ce0d771.40bc78"],["27b90e41.60aff2"],["27b90e41.60aff2"],["9bf47a6b.75a3f8"]]},{"id":"4491bfe7.ef57","type":"change","z":"7459d84c.edbbd8","name":"Разогрев","rules":[{"t":"set","p":"valve.water.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"Разогрев","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":180,"wires":[["23f3c2db.8d154e","26c5227c.da5cfe","f441e5.c21fae18"]]},{"id":"5f6fb82e.fcfae8","type":"link out","z":"7459d84c.edbbd8","name":"TTX from stabilization","links":["d6e6a230.d2666"],"x":1375,"y":280,"wires":[]},{"id":"7d9fc9d5.f9d3a8","type":"change","z":"7459d84c.edbbd8","name":"Ручное отключение","rules":[{"t":"set","p":"valve.water.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"Ручное отключение","tot":"str"},{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":1480,"wires":[["dca4129e.c9dbf"]]},{"id":"27106624.65070a","type":"change","z":"6546e589.95bfdc","name":"Стоп системы","rules":[{"t":"set","p":"payload","pt":"msg","to":"cancel","tot":"str"},{"t":"set","p":"valve.water.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":820,"wires":[["95a3b002.7f979","461a7a2d.90d1c4"]]},{"id":"e5c70c53.c1fc3","type":"change","z":"7459d84c.edbbd8","name":"Отбор голов","rules":[{"t":"set","p":"valve.water.on","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"Отбор голов","tot":"str"},{"t":"set","p":"process.reflux.stage","pt":"global","to":"head","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1810,"y":140,"wires":[["da97c4bb.fe3418","ca79898a.d28908","84de8106.f8f91"]]},{"id":"91050f7f.a3d8f","type":"change","z":"7459d84c.edbbd8","name":"Уставка","rules":[{"t":"set","p":"valve.water.on","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"Уставка","tot":"str"},{"t":"set","p":"process.reflux.stage","pt":"global","to":"setpoint","tot":"str"},{"t":"set","p":"timeout","pt":"msg","to":"$globalContext('process.reflux.deltatemptime')*60","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2740,"y":160,"wires":[["bd707b3c.6a0088","54c92a61.1508f4","847b4087.75d9f"]]},{"id":"9db3d7d3.be0bb8","type":"serial out","z":"372e1e33.0db3b2","name":"To LPower","serial":"b5dc49c3.0ed5c8","x":2290,"y":1660,"wires":[]},{"id":"1376c34d.cb9d2d","type":"function","z":"372e1e33.0db3b2","name":"Set tty buffer","func":"var percentPower = msg.payload;\nmsg.payload =Buffer.from([0x41, 0x54, 0x2B, 0x70, 0x3D, percentPower, 0x6D+percentPower, 0x03]);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2030,"y":1660,"wires":[["9db3d7d3.be0bb8"]]},{"id":"3c92b12.b7fd04e","type":"ui_dropdown","z":"9615284c.b28278","name":"","label":"Управление питанием","tooltip":"","place":"Select option","group":"5471a0c0.7d6db","order":10,"width":0,"height":0,"passthru":true,"multiple":false,"options":[{"label":"LB","value":"LB","type":"str"},{"label":"SSR","value":"SSR","type":"str"}],"payload":"","topic":"","x":870,"y":1280,"wires":[["75c40307.90424c"]]},{"id":"75c40307.90424c","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::power","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1150,"y":1280,"wires":[[]]},{"id":"36ef6f4e.83738","type":"change","z":"9615284c.b28278","name":"buzzer_volume","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::power","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":1280,"wires":[["3c92b12.b7fd04e"]]},{"id":"442934b0.13507c","type":"switch","z":"372e1e33.0db3b2","name":"Какое управление питанием?","property":"#:(file)::power","propertyType":"global","rules":[{"t":"eq","v":"LB","vt":"str"},{"t":"eq","v":"SSR","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":1380,"wires":[["34456eec.891662"],["23879015.927e8"]]},{"id":"34456eec.891662","type":"change","z":"372e1e33.0db3b2","name":"Интервал 1с","rules":[{"t":"set","p":"heat_interval","pt":"flow","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":1340,"wires":[["26de6950.9bf226"]]},{"id":"23879015.927e8","type":"change","z":"372e1e33.0db3b2","name":"Интервал 10с","rules":[{"t":"set","p":"heat_interval","pt":"flow","to":"10","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":1420,"wires":[["26de6950.9bf226"]]},{"id":"d4be9a7e.41a828","type":"switch","z":"372e1e33.0db3b2","name":"SSR?","property":"#:(file)::power","propertyType":"global","rules":[{"t":"eq","v":"SSR","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2010,"y":1260,"wires":[["1c03bf82.78a3d"]]},{"id":"d5d2a2b9.e3c27","type":"change","z":"7459d84c.edbbd8","name":"Стабилизация осталось ...","rules":[{"t":"set","p":"payload","pt":"msg","to":"$join([\"Стабилизация, осталось \", $pad($string($floor(msg.payload/60)), -2, '0'), \":\", $pad($string(msg.payload-$floor(msg.payload/60)*60), -2, '0'), \"мин\"])\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1780,"y":320,"wires":[["3141711f.8c363e"]]},{"id":"af007b4f.1cb418","type":"mytimeout","z":"7459d84c.edbbd8","name":"Таймаут стабилизации","outtopic":"","outsafe":"","outwarning":"","outunsafe":"next","warning":"0","timer":"0","debug":false,"ndebug":false,"ignoreCase":false,"repeat":false,"again":false,"x":1570,"y":200,"wires":[["e5c70c53.c1fc3"],["b001b01a.8b877"]]},{"id":"2abcd0c9.3a88e","type":"change","z":"7459d84c.edbbd8","name":"Стоп системы","rules":[{"t":"set","p":"payload","pt":"msg","to":"cancel","tot":"str"},{"t":"set","p":"valve.water.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":1560,"wires":[["67baedd8.0e0c84","8ef0fed9.a6727"]]},{"id":"b001b01a.8b877","type":"switch","z":"7459d84c.edbbd8","name":">0","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":1570,"y":320,"wires":[["d5d2a2b9.e3c27"]]},{"id":"ef363b93.0b0f88","type":"mytimeout","z":"6546e589.95bfdc","name":"Таймаут охдаждения","outtopic":"","outsafe":"","outwarning":"","outunsafe":"Финал","warning":"0","timer":"300","debug":false,"ndebug":false,"ignoreCase":false,"repeat":false,"again":false,"x":2640,"y":300,"wires":[["fb36a712.8150b8","7dfbcdf3.e02f44","7ae96824.921d28"],["8866f574.788058"]]},{"id":"f3999b5b.c11228","type":"change","z":"6546e589.95bfdc","name":"Охлаждение осталось ...","rules":[{"t":"set","p":"payload","pt":"msg","to":"$join([\"Охлаждение, осталось \", $pad($string($floor(msg.payload/60)), -2, '0'), \":\", $pad($string(msg.payload-$floor(msg.payload/60)*60), -2, '0'), \"мин\"])\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3190,"y":440,"wires":[["7ae96824.921d28"]]},{"id":"8866f574.788058","type":"switch","z":"6546e589.95bfdc","name":">0","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":2970,"y":440,"wires":[["f3999b5b.c11228"]]},{"id":"3b9f65b0.1d6baa","type":"change","z":"6546e589.95bfdc","name":"Голос Охлаждение колонны","rules":[{"t":"set","p":"payload","pt":"msg","to":"Охлаждение колонны","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2660,"y":240,"wires":[["fb36a712.8150b8"]]},{"id":"751e01d6.349b4","type":"change","z":"6546e589.95bfdc","name":"Ручное отключение","rules":[{"t":"set","p":"payload","pt":"msg","to":"Ручное отключение","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":900,"wires":[["6a916350.1c735c"]]},{"id":"23f3c2db.8d154e","type":"link out","z":"7459d84c.edbbd8","name":"From Heat","links":["81f9dfe7.8e127","6c638daa.c37494"],"x":355,"y":120,"wires":[]},{"id":"da97c4bb.fe3418","type":"link out","z":"7459d84c.edbbd8","name":"From Head","links":["6c638daa.c37494","d6e6a230.d2666"],"x":1915,"y":220,"wires":[]},{"id":"bd707b3c.6a0088","type":"link out","z":"7459d84c.edbbd8","name":"From Body","links":["6c638daa.c37494","d6e6a230.d2666"],"x":2835,"y":80,"wires":[]},{"id":"5e62654b.fb452c","type":"link out","z":"7459d84c.edbbd8","name":"From Final","links":["81f9dfe7.8e127","6c638daa.c37494"],"x":3535,"y":980,"wires":[]},{"id":"3141711f.8c363e","type":"link out","z":"7459d84c.edbbd8","name":"From Stabilization","links":["81f9dfe7.8e127","6c638daa.c37494"],"x":1955,"y":320,"wires":[]},{"id":"29284235.af34be","type":"link out","z":"7459d84c.edbbd8","name":"TTX from final","links":["d6e6a230.d2666"],"x":3235,"y":920,"wires":[]},{"id":"ca79898a.d28908","type":"switch","z":"7459d84c.edbbd8","name":"Ждем датчика жидкости","property":"safe.liquid","propertyType":"global","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2130,"y":140,"wires":[["a8e7f068.d91c"],["a75036d2.3dba78"]]},{"id":"9bf47a6b.75a3f8","type":"change","z":"7459d84c.edbbd8","name":"Охлаждение колонны","rules":[{"t":"set","p":"process.reflux.stage","pt":"global","to":"cooling","tot":"str"},{"t":"set","p":"valve.water.on","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"on","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":980,"wires":[["69c638d7.3530e8","9b0be9e7.454c48","ead10.3af862f1","c12bf717.379d48"]]},{"id":"206032a5.37286e","type":"change","z":"7459d84c.edbbd8","name":"Final!","rules":[{"t":"set","p":"process.reflux.stage","pt":"global","to":"final","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"},{"t":"set","p":"valve.water.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.body.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":3290,"y":1020,"wires":[["bc6e633.fa3d4a"]]},{"id":"69c638d7.3530e8","type":"mytimeout","z":"7459d84c.edbbd8","name":"Таймаут охдаждения","outtopic":"","outsafe":"","outwarning":"","outunsafe":"Финал","warning":"0","timer":"300","debug":false,"ndebug":false,"ignoreCase":false,"repeat":false,"again":false,"x":3040,"y":980,"wires":[["206032a5.37286e","29284235.af34be","5e62654b.fb452c"],["f0f19a80.8c1f48"]]},{"id":"d9097277.c939b","type":"change","z":"7459d84c.edbbd8","name":"Охлаждение осталось ...","rules":[{"t":"set","p":"payload","pt":"msg","to":"$join([\"Охлаждение, осталось \", $pad($string($floor(msg.payload/60)), -2, '0'), \":\", $pad($string(msg.payload-$floor(msg.payload/60)*60), -2, '0'), \"мин\"])\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3310,"y":1080,"wires":[["5e62654b.fb452c"]]},{"id":"f0f19a80.8c1f48","type":"switch","z":"7459d84c.edbbd8","name":">0","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":3090,"y":1080,"wires":[["d9097277.c939b"]]},{"id":"9b0be9e7.454c48","type":"change","z":"7459d84c.edbbd8","name":"Голос Охлаждение колонны","rules":[{"t":"set","p":"payload","pt":"msg","to":"Охлаждение колонны","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2900,"y":920,"wires":[["29284235.af34be"]]},{"id":"6c879f34.fb33","type":"switch","z":"372e1e33.0db3b2","name":"SSR?","property":"#:(file)::power","propertyType":"global","rules":[{"t":"eq","v":"SSR","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":2010,"y":1340,"wires":[["77f1f173.aad71"]]},{"id":"2ac53303.9cfb6c","type":"link in","z":"372e1e33.0db3b2","name":"Walve body In","links":["dddaebcc.74ce48","56eec5a8.b7c82c","4bd78759.0ff218","fab985a0.2eaf38","342684d5.de28fc","f5adb46d.380098","dee5200c.fa6c"],"x":2875,"y":2460,"wires":[["620666a7.f66308"]]},{"id":"dddaebcc.74ce48","type":"link out","z":"372e1e33.0db3b2","name":"Valve body out 1","links":["2ac53303.9cfb6c"],"x":1815,"y":2160,"wires":[]},{"id":"fab985a0.2eaf38","type":"link out","z":"372e1e33.0db3b2","name":"Valve body out 4","links":["2ac53303.9cfb6c","5cd3ba7d.619b34"],"x":1795,"y":2360,"wires":[]},{"id":"342684d5.de28fc","type":"link out","z":"372e1e33.0db3b2","name":"Valve body out 5","links":["2ac53303.9cfb6c","5cd3ba7d.619b34"],"x":1195,"y":2340,"wires":[]},{"id":"f5adb46d.380098","type":"link out","z":"372e1e33.0db3b2","name":"Valve body out 6","links":["2ac53303.9cfb6c","5cd3ba7d.619b34"],"x":935,"y":2340,"wires":[]},{"id":"1f645303.3f26ed","type":"function","z":"372e1e33.0db3b2","name":"clone defaults","func":"var obj=RED.util.cloneMessage(global.get(\"default\",'file')) || {'value' : null};\nglobal.set (\"process\", obj);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":380,"y":120,"wires":[["723c5037.401e5"]]},{"id":"9fd8eb9c.89f328","type":"change","z":"7459d84c.edbbd8","name":"Установим параметры после уставки","rules":[{"t":"set","p":"process.reflux.startpress","pt":"global","to":"pressure.current","tot":"global"},{"t":"set","p":"process.reflux.startalcboil","pt":"global","to":"78.14 - (760 - $globalContext('process.reflux.startpress'))*0.037","tot":"jsonata"},{"t":"set","p":"process.reflux.stabtemp","pt":"global","to":"temperature.tube","tot":"global"},{"t":"set","p":"process.reflux.startstop","pt":"global","to":"0","tot":"num"},{"t":"set","p":"payload","pt":"msg","to":"enabled","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3350,"y":140,"wires":[["b717581f.fbc0e8","fcd56357.d4546","950135cb.3ea758"]]},{"id":"f48b0e08.abd98","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":34,"width":0,"height":0,"name":"Температурная дельта","label":"Температурная дельта (с&deg;):","format":"","layout":"row-spread","x":470,"y":3540,"wires":[]},{"id":"564ae5b.4d5e11c","type":"change","z":"9615284c.b28278","name":"default.reflux.deltatemp","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.deltatemp","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":3580,"wires":[["c98ecd2f.02f37","e77f81ed.f1e8a"]]},{"id":"c98ecd2f.02f37","type":"ui_slider","z":"9615284c.b28278","name":"Default_reflux_deltatemp","label":"","tooltip":"","group":"8e947e7.25f798","order":35,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"0","max":"5","step":"0.5","x":830,"y":3540,"wires":[["d81df02a.17cc4"]]},{"id":"d81df02a.17cc4","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.deltatemp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":3580,"wires":[["c98ecd2f.02f37","e77f81ed.f1e8a"]]},{"id":"e77f81ed.f1e8a","type":"ui_numeric","z":"9615284c.b28278","name":"Default_reflux_deltatemp","label":"","tooltip":"","group":"8e947e7.25f798","order":36,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"0","max":"5","step":"0.5","x":830,"y":3620,"wires":[["d81df02a.17cc4"]]},{"id":"311482c3.a04a2e","type":"switch","z":"7459d84c.edbbd8","name":"Температура подросла?","property":"process.reflux.tempalert","propertyType":"global","rules":[{"t":"gt","v":"temperature.tube","vt":"global"},{"t":"lte","v":"temperature.tube","vt":"global"}],"checkall":"false","repair":false,"outputs":2,"x":1310,"y":680,"wires":[["7fba1988.414d78"],["68cb238e.3dfd3c"]]},{"id":"fd1bac33.41a98","type":"change","z":"7459d84c.edbbd8","name":"Температура сработки при текущем давлении","rules":[{"t":"set","p":"process.reflux.tempalert","pt":"global","to":"$round($globalContext('process.reflux.stabtemp')+$globalContext('process.reflux.deltatemp')+$globalContext('process.reflux.startalcboil')-(78.14-(760-$globalContext('pressure.current'))*0.037),2)","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"process.reflux.tempalert","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":960,"y":680,"wires":[["311482c3.a04a2e","cab7ddc2.91d0a"]]},{"id":"b114d023.5a0a9","type":"delay","z":"6546e589.95bfdc","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1680,"y":120,"wires":[["7445f41a.8d7d6c"]]},{"id":"cdc6397a.3caaa8","type":"link out","z":"6546e589.95bfdc","name":"Начинаем дистиляцию","links":["a6bf1861.e34b18"],"x":2115,"y":660,"wires":[]},{"id":"a6bf1861.e34b18","type":"link in","z":"6546e589.95bfdc","name":"Начинаем дистиляцию","links":["cdc6397a.3caaa8"],"x":95,"y":260,"wires":[["f316229e.c144d"]]},{"id":"2c2aa0f9.9bb67","type":"link out","z":"6546e589.95bfdc","name":"Ручное отключение","links":["a428ce0c.34a3c"],"x":1915,"y":940,"wires":[]},{"id":"a428ce0c.34a3c","type":"link in","z":"6546e589.95bfdc","name":"Ручное отключение","links":["2c2aa0f9.9bb67","bcf44351.aa671","3df12f06.6d2a5","c80bc271.243"],"x":115,"y":860,"wires":[["27106624.65070a","751e01d6.349b4"]]},{"id":"ce884fc9.e7b24","type":"delay","z":"6546e589.95bfdc","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":640,"y":100,"wires":[["b99cf690.ebe548"]]},{"id":"3a42c0d7.d8a24","type":"link out","z":"6546e589.95bfdc","name":"from heat","links":["174dbc3e.bc15d4","49c209d9.988ab8"],"x":355,"y":220,"wires":[]},{"id":"4e077f32.6a0e9","type":"link out","z":"6546e589.95bfdc","name":"from work","links":["49c209d9.988ab8","d6e6a230.d2666"],"x":1415,"y":140,"wires":[]},{"id":"6a916350.1c735c","type":"link out","z":"6546e589.95bfdc","name":"from hand stop","links":["174dbc3e.bc15d4","49c209d9.988ab8"],"x":655,"y":900,"wires":[]},{"id":"8e0da552.dc6198","type":"change","z":"6546e589.95bfdc","name":"Ошибка температурного датчика","rules":[{"t":"set","p":"payload","pt":"msg","to":"Ошибка температурного датчика","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":760,"wires":[["ce87f73f.f79658"]]},{"id":"4171904b.0cc9f","type":"link out","z":"6546e589.95bfdc","name":"heat error","links":["4025678d.1e4258"],"x":815,"y":260,"wires":[]},{"id":"4025678d.1e4258","type":"link in","z":"6546e589.95bfdc","name":"Отключение по ошибке","links":["4171904b.0cc9f","d84618c.b3a7ce8"],"x":115,"y":760,"wires":[["2ed4a44f.400e3c"]]},{"id":"ce87f73f.f79658","type":"link out","z":"6546e589.95bfdc","name":"from error stop","links":["174dbc3e.bc15d4","49c209d9.988ab8"],"x":735,"y":760,"wires":[]},{"id":"d84618c.b3a7ce8","type":"link out","z":"6546e589.95bfdc","name":"work error","links":["4025678d.1e4258"],"x":1875,"y":280,"wires":[]},{"id":"434d3490.e3c3ac","type":"comment","z":"6546e589.95bfdc","name":"Запуск/Стоп процесса","info":"","x":160,"y":580,"wires":[]},{"id":"c5ad79a5.ac7858","type":"link out","z":"6546e589.95bfdc","name":"Выставить ВКЛ/ВЫКЛ","links":["ee64a708.a83ba8"],"x":2535,"y":840,"wires":[]},{"id":"455fc137.45739","type":"change","z":"6546e589.95bfdc","name":"Enable next button and mark status on","rules":[{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"red\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2310,"y":720,"wires":[["19e8ced7.d67ec1","c5ad79a5.ac7858"]]},{"id":"37cf056f.442c1a","type":"change","z":"6546e589.95bfdc","name":"Disable next button and mark status off","rules":[{"t":"set","p":"enabled","pt":"msg","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"white\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2310,"y":1000,"wires":[["19e8ced7.d67ec1","c5ad79a5.ac7858"]]},{"id":"19e8ced7.d67ec1","type":"link out","z":"6546e589.95bfdc","name":"Manage Next Button","links":["f14a8630.b95b18","80a3cf43.fd9f"],"x":2735,"y":840,"wires":[]},{"id":"d91cba76.c051e8","type":"switch","z":"7459d84c.edbbd8","name":"!=final or !=error_finish","property":"process.reflux.stage","propertyType":"global","rules":[{"t":"eq","v":"final","vt":"str"},{"t":"eq","v":"error_finish","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":3,"x":1540,"y":1640,"wires":[[],[],["7c54daa0.eb3b44","fd030360.74ea5"]]},{"id":"351230f0.8ea72","type":"link in","z":"7459d84c.edbbd8","name":"Ручное отключение","links":["f43ddbec.9e5db8","bcf44351.aa671","3df12f06.6d2a5","c80bc271.243"],"x":455,"y":1480,"wires":[["2abcd0c9.3a88e","7d9fc9d5.f9d3a8"]]},{"id":"f43ddbec.9e5db8","type":"link out","z":"7459d84c.edbbd8","name":"Ручное отключение","links":["351230f0.8ea72"],"x":1945,"y":1660,"wires":[]},{"id":"b7beebe6.133a68","type":"link out","z":"7459d84c.edbbd8","name":"Начинаем ректификацию","links":["af7f5deb.952f3"],"x":2335,"y":1320,"wires":[]},{"id":"af7f5deb.952f3","type":"link in","z":"7459d84c.edbbd8","name":"Начинаем ректификацию","links":["b7beebe6.133a68"],"x":135,"y":180,"wires":[["4491bfe7.ef57"]]},{"id":"22dbc644.e7696a","type":"delay","z":"7459d84c.edbbd8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":540,"y":80,"wires":[["4e7b0beb.fdd534"]]},{"id":"e225dccf.9ed44","type":"change","z":"7459d84c.edbbd8","name":"Ошибка температурного датчика","rules":[{"t":"set","p":"payload","pt":"msg","to":"Ошибка температурного датчика","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":1420,"wires":[["dca4129e.c9dbf"]]},{"id":"dca4129e.c9dbf","type":"link out","z":"7459d84c.edbbd8","name":"from error stop","links":["81f9dfe7.8e127","6c638daa.c37494"],"x":815,"y":1420,"wires":[]},{"id":"8628ec9d.54a33","type":"link in","z":"7459d84c.edbbd8","name":"Отключение по ошибке","links":["cf49dcb7.6837","27b90e41.60aff2"],"x":155,"y":1500,"wires":[["3c7e70ea.76828"]]},{"id":"cf49dcb7.6837","type":"link out","z":"7459d84c.edbbd8","name":"Отключение по ошибке","links":["8628ec9d.54a33"],"x":975,"y":180,"wires":[]},{"id":"a75036d2.3dba78","type":"delay","z":"7459d84c.edbbd8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":2420,"y":160,"wires":[["14fe6e3c.03e4d2"]]},{"id":"54c92a61.1508f4","type":"mytimeout","z":"7459d84c.edbbd8","name":"Таймаут уставки","outtopic":"","outsafe":"","outwarning":"Warning","outunsafe":"off","warning":"5","timer":"30","debug":false,"ndebug":false,"ignoreCase":false,"repeat":false,"again":false,"x":3050,"y":160,"wires":[["9fd8eb9c.89f328"],["67d33577.ed49fc"]]},{"id":"d0e3de49.e77aa","type":"change","z":"7459d84c.edbbd8","name":"Уставка осталось ...","rules":[{"t":"set","p":"payload","pt":"msg","to":"$join([\"Уставка, осталось \", $pad($string($floor(msg.payload/60)), -2, '0'), \":\", $pad($string(msg.payload-$floor(msg.payload/60)*60), -2, '0'), \"мин\"])\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3300,"y":240,"wires":[["bae4d81b.edec68"]]},{"id":"67d33577.ed49fc","type":"switch","z":"7459d84c.edbbd8","name":">0","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":3130,"y":240,"wires":[["d0e3de49.e77aa"]]},{"id":"bae4d81b.edec68","type":"link out","z":"7459d84c.edbbd8","name":"From delta","links":["81f9dfe7.8e127","6c638daa.c37494"],"x":3455,"y":240,"wires":[]},{"id":"7fba1988.414d78","type":"delay","z":"7459d84c.edbbd8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1540,"y":600,"wires":[["1aaca9df.7c8456"]]},{"id":"68cb238e.3dfd3c","type":"change","z":"7459d84c.edbbd8","name":"Увеличиваем старт/стоп, закрываем отбор","rules":[{"t":"set","p":"process.reflux.startstop","pt":"global","to":" $globalContext('process.reflux.startstop')+1","tot":"jsonata"},{"t":"set","p":"process.reflux.valvebodystop","pt":"global","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":720,"wires":[["af31928b.ae0ab","5415b200.b95c2c","98ecff23.92f32"]]},{"id":"cef9b112.f1f02","type":"change","z":"7459d84c.edbbd8","name":"Открываем отбор","rules":[{"t":"set","p":"process.reflux.valvebodystop","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"Отбор тела","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":660,"wires":[["1aaca9df.7c8456","105eea01.bb95d6"]]},{"id":"bc6e633.fa3d4a","type":"link out","z":"7459d84c.edbbd8","name":"Disable start button from final","links":["570981c1.88241"],"x":3395,"y":1020,"wires":[]},{"id":"95a3b002.7f979","type":"change","z":"6546e589.95bfdc","name":"Payload false","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":860,"wires":[["58c308d4.1da988"]]},{"id":"27b90e41.60aff2","type":"link out","z":"7459d84c.edbbd8","name":"Отключение по ошибке в момент отбора","links":["8628ec9d.54a33"],"x":635,"y":740,"wires":[]},{"id":"4e7b0beb.fdd534","type":"switch","z":"7459d84c.edbbd8","name":"Запущен ли процесс?","property":"process.on","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":780,"y":80,"wires":[["d5ae7e0e.b76dc"]]},{"id":"14fe6e3c.03e4d2","type":"switch","z":"7459d84c.edbbd8","name":"Запущен ли процесс?","property":"process.on","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":2260,"y":260,"wires":[["b572c3dd.4d087"]]},{"id":"1aaca9df.7c8456","type":"switch","z":"7459d84c.edbbd8","name":"Запущен ли процесс?","property":"process.on","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":3020,"y":600,"wires":[["4bef8157.85c87"]]},{"id":"b99cf690.ebe548","type":"switch","z":"6546e589.95bfdc","name":"Запущен ли процесс?","property":"process.on","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":860,"y":100,"wires":[["f01a138b.876d8"]]},{"id":"7445f41a.8d7d6c","type":"switch","z":"6546e589.95bfdc","name":"Запущен ли процесс?","property":"process.on","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":1880,"y":120,"wires":[["8c3a0c12.bd97c"]]},{"id":"60b93d35.297f54","type":"comment","z":"7459d84c.edbbd8","name":"Запуск/Стоп процесса","info":"","x":200,"y":1200,"wires":[]},{"id":"583eb11.9085d5","type":"comment","z":"9615284c.b28278","name":"Веб Дистиляция","info":"","x":180,"y":3820,"wires":[]},{"id":"330d827a.a8cd9e","type":"ui_slider","z":"9615284c.b28278","name":"process_Dist_pheat_slider","label":"","tooltip":"","group":"65f9b6e5.44a978","order":3,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_Dist","min":0,"max":"100","step":1,"x":840,"y":3880,"wires":[["14b80e41.421df2"]]},{"id":"ed33a3b7.8e6f8","type":"ui_numeric","z":"9615284c.b28278","name":"process_Dist_pheat_numeric","label":"","tooltip":"","group":"65f9b6e5.44a978","order":4,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_Dist","format":"{{value}}","min":0,"max":"100","step":1,"x":840,"y":3960,"wires":[["14b80e41.421df2"]]},{"id":"ca87bc29.a95dc","type":"ui_slider","z":"9615284c.b28278","name":"process_Dist_pwork_slider","label":"","tooltip":"","group":"65f9b6e5.44a978","order":6,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_Dist","min":0,"max":"100","step":1,"x":840,"y":4040,"wires":[["a0bc850e.705668"]]},{"id":"a0bc850e.705668","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.dist.power.work","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":4080,"wires":[["ca87bc29.a95dc","b74763bb.4197f"]]},{"id":"b74763bb.4197f","type":"ui_numeric","z":"9615284c.b28278","name":"process_Dist_pwork_numeric","label":"","tooltip":"","group":"65f9b6e5.44a978","order":7,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_Dist","format":"{{value}}","min":0,"max":"100","step":1,"x":850,"y":4120,"wires":[["a0bc850e.705668"]]},{"id":"6fa13ef1.4605e","type":"ui_slider","z":"9615284c.b28278","name":"process_Dist_temp_work_slider","label":"","tooltip":"","group":"65f9b6e5.44a978","order":9,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_Dist","min":"55","max":"80","step":"0.1","x":850,"y":4200,"wires":[["ef23626f.9b833"]]},{"id":"ef23626f.9b833","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.dist.temp.work","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":4240,"wires":[["6fa13ef1.4605e","7150910.2716c7"]]},{"id":"7150910.2716c7","type":"ui_numeric","z":"9615284c.b28278","name":"process_Dist_temp_work_numeric","label":"","tooltip":"","group":"65f9b6e5.44a978","order":10,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_Dist","format":"{{value}}","min":"55","max":"80","step":"0.1","x":860,"y":4280,"wires":[["ef23626f.9b833"]]},{"id":"dbcde668.1c2448","type":"change","z":"9615284c.b28278","name":"process.dist.power.heat","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.dist.power.heat","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":3920,"wires":[["330d827a.a8cd9e","ed33a3b7.8e6f8"]]},{"id":"1572dd94.3f4662","type":"change","z":"9615284c.b28278","name":"process.dist.power.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.dist.power.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":4060,"wires":[["ca87bc29.a95dc","b74763bb.4197f"]]},{"id":"54c40935.a1e728","type":"change","z":"9615284c.b28278","name":"process.dist.temp.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.dist.temp.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":4220,"wires":[["6fa13ef1.4605e","7150910.2716c7"]]},{"id":"46e5660f.603f58","type":"ui_text","z":"9615284c.b28278","group":"65f9b6e5.44a978","order":2,"width":0,"height":0,"name":"Мощность Разогрева","label":"Мощность Разогрева (%):","format":"","layout":"row-left","x":460,"y":3880,"wires":[]},{"id":"faeb03d1.99e0d","type":"ui_text","z":"9615284c.b28278","group":"65f9b6e5.44a978","order":5,"width":0,"height":0,"name":"Рабочая Мощность","label":"Рабочая Мощность (%):","format":"","layout":"row-left","x":460,"y":4020,"wires":[]},{"id":"660615b4.aa568c","type":"ui_text","z":"9615284c.b28278","group":"65f9b6e5.44a978","order":8,"width":0,"height":0,"name":"Рабочая температура","label":"Переход в рабочий режим (c&deg; в кубе):","format":"","layout":"row-left","x":460,"y":4180,"wires":[]},{"id":"4bffd3ae.d9176c","type":"ui_text","z":"9615284c.b28278","group":"65f9b6e5.44a978","order":11,"width":0,"height":0,"name":"Температура окончания погона","label":"Окончание погона (c&deg; в кубе):","format":"","layout":"row-left","x":500,"y":4340,"wires":[]},{"id":"12563280.4d6ede","type":"ui_slider","z":"9615284c.b28278","name":"process_Dist_temp_end_work_slider","label":"","tooltip":"","group":"65f9b6e5.44a978","order":12,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_Dist","min":"80","max":"100","step":"0.1","x":870,"y":4360,"wires":[["481ba224.1cc29c"]]},{"id":"481ba224.1cc29c","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.dist.temp.end","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1290,"y":4400,"wires":[["12563280.4d6ede","4ea9ebe.495d014"]]},{"id":"4ea9ebe.495d014","type":"ui_numeric","z":"9615284c.b28278","name":"process_Dist_temp_end_work_numeric","label":"","tooltip":"","group":"65f9b6e5.44a978","order":13,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_Dist","format":"{{value}}","min":"80","max":"100","step":"0.1","x":880,"y":4440,"wires":[["481ba224.1cc29c"]]},{"id":"5ca2fc21.4b2a84","type":"change","z":"9615284c.b28278","name":"process.dist.temp.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.dist.temp.end.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":4380,"wires":[["12563280.4d6ede","4ea9ebe.495d014"]]},{"id":"98b6bf82.652b9","type":"inject","z":"9615284c.b28278","name":"Init","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":110,"y":4100,"wires":[["dbcde668.1c2448","1572dd94.3f4662","54c40935.a1e728","5ca2fc21.4b2a84"]]},{"id":"a24002cd.06068","type":"ui_dropdown","z":"9615284c.b28278","name":"Клапан воды","label":"Клапан воды","tooltip":"","place":"Автомат","group":"65f9b6e5.44a978","order":14,"width":0,"height":0,"passthru":false,"multiple":false,"options":[{"label":"Автомат","value":"auto","type":"str"},{"label":"Открыт","value":"true","type":"str"},{"label":"Закрыт","value":"false","type":"str"}],"payload":"","topic":"water","x":320,"y":4560,"wires":[["102ad29e.75ea4d"]]},{"id":"fca9f58c.c20128","type":"ui_dropdown","z":"9615284c.b28278","name":"Клапан тела","label":"Клапан тела&nbsp","tooltip":"","place":"Автомат","group":"65f9b6e5.44a978","order":15,"width":0,"height":0,"passthru":false,"multiple":false,"options":[{"label":"Автомат","value":"auto","type":"str"},{"label":"Открыт","value":"true","type":"str"},{"label":"Закрыт","value":"false","type":"str"}],"payload":"","topic":"body","x":310,"y":4620,"wires":[["7e7c8126.81246"]]},{"id":"102ad29e.75ea4d","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"valve.water.hand","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":4560,"wires":[["6b86e7a8.5b4408"]]},{"id":"7e7c8126.81246","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"valve.body.hand","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":4620,"wires":[["5f1598bf.cec3f8"]]},{"id":"d3604d7a.98f39","type":"link in","z":"9615284c.b28278","name":"Dist Water In","links":["3f709662.5d802a","27cba87b.968278"],"x":175,"y":4560,"wires":[["a24002cd.06068"]]},{"id":"6b05938c.c70d3c","type":"link in","z":"9615284c.b28278","name":"Dist Body In","links":["af9f1422.673328","e7ca3d58.dcb06"],"x":175,"y":4620,"wires":[["fca9f58c.c20128"]]},{"id":"6b86e7a8.5b4408","type":"link out","z":"9615284c.b28278","name":"Dist Water Out","links":["803ce57a.e43968","d6e06e2d.ec55f"],"x":755,"y":4560,"wires":[]},{"id":"5f1598bf.cec3f8","type":"link out","z":"9615284c.b28278","name":"Dist Body Out","links":["9702ad07.e1c1","bbe79515.dfd5e8"],"x":755,"y":4620,"wires":[]},{"id":"14b80e41.421df2","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.dist.power.heat","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":3920,"wires":[["330d827a.a8cd9e","ed33a3b7.8e6f8"]]},{"id":"35e44f3a.937e3","type":"comment","z":"9615284c.b28278","name":"Веб ректификация","info":"","x":2770,"y":40,"wires":[]},{"id":"ffb7159e.3c2448","type":"ui_text","z":"9615284c.b28278","group":"7966a548.0d38ac","order":2,"width":0,"height":0,"name":"Мощность Разогрева","label":"Мощность Разогрева   (%):","format":"","layout":"row-left","x":3120,"y":100,"wires":[]},{"id":"281ad92.a2a2926","type":"ui_text","z":"9615284c.b28278","group":"7966a548.0d38ac","order":8,"width":0,"height":0,"name":"Рабочая Мощность","label":"Рабочая Мощность (%):","format":"","layout":"row-left","x":3120,"y":420,"wires":[]},{"id":"2dbde9a1.e8a076","type":"ui_text","z":"9615284c.b28278","group":"7966a548.0d38ac","order":5,"width":0,"height":0,"name":"Рабочая температура","label":"Рабочая температура (c&deg; в царге):","format":"","layout":"row-left","x":3120,"y":260,"wires":[]},{"id":"53dabafa.79f7f4","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_pheat_slider","label":"","tooltip":"","group":"7966a548.0d38ac","order":3,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":0,"max":"100","step":1,"x":3500,"y":100,"wires":[["29ec62af.ec313e"]]},{"id":"29ec62af.ec313e","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.power.heat","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3960,"y":140,"wires":[["53dabafa.79f7f4","cf3a9f6a.49b9b"]]},{"id":"cf3a9f6a.49b9b","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_pheat_numeric","label":"","tooltip":"","group":"7966a548.0d38ac","order":4,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":0,"max":"100","step":1,"x":3510,"y":180,"wires":[["29ec62af.ec313e"]]},{"id":"90f74eec.b2899","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_pbody_slider","label":"","tooltip":"","group":"7966a548.0d38ac","order":9,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":0,"max":"100","step":1,"x":3500,"y":260,"wires":[["2e72bce4.501284"]]},{"id":"2e72bce4.501284","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.power.body","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3970,"y":300,"wires":[["90f74eec.b2899","76792992.829078"]]},{"id":"76792992.829078","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_pbody_numeric","label":"","tooltip":"","group":"7966a548.0d38ac","order":10,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":0,"max":"100","step":1,"x":3510,"y":340,"wires":[["2e72bce4.501284"]]},{"id":"14ec409a.bb079f","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_temp_work_slider","label":"","tooltip":"","group":"7966a548.0d38ac","order":6,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":"45","max":"80","step":1,"x":3520,"y":420,"wires":[["2ea23c99.402774"]]},{"id":"2ea23c99.402774","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.temp.work","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3960,"y":460,"wires":[["14ec409a.bb079f","5412b0dd.65913"]]},{"id":"5412b0dd.65913","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_temp_work_numeric","label":"","tooltip":"","group":"7966a548.0d38ac","order":7,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":"45","max":"80","step":1,"x":3530,"y":500,"wires":[["2ea23c99.402774"]]},{"id":"55f1105f.2d519","type":"change","z":"9615284c.b28278","name":"process.reflux.power.heat","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.power.heat","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":140,"wires":[["53dabafa.79f7f4","cf3a9f6a.49b9b"]]},{"id":"b6d66b6e.b4bfa8","type":"change","z":"9615284c.b28278","name":"process.reflux.power.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.power.body","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":300,"wires":[["90f74eec.b2899","76792992.829078"]]},{"id":"e6560e0a.fbb2f","type":"change","z":"9615284c.b28278","name":"process.reflux.temp.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.temp.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":460,"wires":[["14ec409a.bb079f","5412b0dd.65913"]]},{"id":"668bb9bf.57d2e8","type":"ui_text","z":"9615284c.b28278","group":"67d23292.dd341c","order":1,"width":0,"height":0,"name":"Частота открытия клапана отбор голов","label":"Частота открытия клапана отбор голов (сек):","format":"","layout":"row-left","x":3180,"y":580,"wires":[]},{"id":"a3773f35.5944d","type":"ui_text","z":"9615284c.b28278","group":"67d23292.dd341c","order":4,"width":0,"height":0,"name":"% открытия клапана отбор голов","label":"% открытия клапана отбор голов:","format":"","layout":"row-left","x":3140,"y":720,"wires":[]},{"id":"a936799f.eee4c8","type":"ui_text","z":"9615284c.b28278","group":"67d23292.dd341c","order":8,"width":0,"height":0,"name":"Частота открытия клапана отбор тела","label":"Частота открытия клапана отбор тела (сек):","format":"","layout":"row-left","x":3180,"y":1000,"wires":[]},{"id":"26c2e66.386281a","type":"ui_text","z":"9615284c.b28278","group":"67d23292.dd341c","order":11,"width":0,"height":0,"name":"% открытия клапана отбор тела","label":"% открытия клапана отбор тела:","format":"","layout":"row-left","x":3140,"y":860,"wires":[]},{"id":"feb7b8ab.dcbe38","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_valve_head_opentime_slider","label":"","tooltip":"","group":"67d23292.dd341c","order":5,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":"1","max":"50","step":"0.1","x":3550,"y":600,"wires":[["7fece506.ee2e4c"]]},{"id":"7fece506.ee2e4c","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.valve.head.opentime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4000,"y":640,"wires":[["feb7b8ab.dcbe38","15dc7129.f8fbef"]]},{"id":"15dc7129.f8fbef","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_valve_head_opentime_numeric","label":"","tooltip":"","group":"67d23292.dd341c","order":6,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":"1","max":"50","step":"0.1","x":3560,"y":680,"wires":[["7fece506.ee2e4c"]]},{"id":"7f67022b.2fdf2c","type":"change","z":"9615284c.b28278","name":"process.reflux.valve.head.opentime","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.valve.head.opentime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3160,"y":620,"wires":[["feb7b8ab.dcbe38","15dc7129.f8fbef"]]},{"id":"c480f95c.b2fd38","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_valve_head_frequency_slider","label":"","tooltip":"","group":"67d23292.dd341c","order":2,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":"6","max":"30","step":1,"x":3550,"y":740,"wires":[["f3fcc890.42df78"]]},{"id":"f3fcc890.42df78","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.valve.head.frequency","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4000,"y":780,"wires":[["c480f95c.b2fd38","d084b1d0.20b25"]]},{"id":"d084b1d0.20b25","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_valve_head_frequency_numeric","label":"","tooltip":"","group":"67d23292.dd341c","order":3,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":"6","max":"30","step":1,"x":3560,"y":820,"wires":[["f3fcc890.42df78"]]},{"id":"7c983ec0.44149","type":"change","z":"9615284c.b28278","name":"process.reflux.valve.head.frequency","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.valve.head.frequency","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3170,"y":760,"wires":[["c480f95c.b2fd38","d084b1d0.20b25"]]},{"id":"2c9d8b01.d60734","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_valve_body_opentime_slider","label":"","tooltip":"","group":"67d23292.dd341c","order":12,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":"1","max":"50","step":"0.1","x":3550,"y":880,"wires":[["dac38515.b16db8"]]},{"id":"dac38515.b16db8","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.valve.body.opentime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3990,"y":920,"wires":[["2c9d8b01.d60734","e0758c2c.777cb"]]},{"id":"e0758c2c.777cb","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_valve_body_opentime_numeric","label":"","tooltip":"","group":"67d23292.dd341c","order":13,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":"1","max":"50","step":"0.1","x":3560,"y":960,"wires":[["dac38515.b16db8"]]},{"id":"4d7ed2f0.440e8c","type":"change","z":"9615284c.b28278","name":"process.reflux.valve.body.opentime","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.valve.body.opentime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3160,"y":900,"wires":[["2c9d8b01.d60734","e0758c2c.777cb"]]},{"id":"c0c7f8db.d91918","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_valve_body_frequency_slider","label":"","tooltip":"","group":"67d23292.dd341c","order":9,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":"6","max":"30","step":1,"x":3550,"y":1020,"wires":[["605453dc.7a29ac"]]},{"id":"605453dc.7a29ac","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.valve.body.frequency","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4000,"y":1060,"wires":[["c0c7f8db.d91918","c6776ace.02abc8"]]},{"id":"c6776ace.02abc8","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_valve_body_frequency_numeric","label":"","tooltip":"","group":"67d23292.dd341c","order":10,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":"6","max":"30","step":"1","x":3560,"y":1100,"wires":[["605453dc.7a29ac"]]},{"id":"990a647e.b91228","type":"change","z":"9615284c.b28278","name":"process.reflux.valve.body.frequency","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.valve.body.frequency","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3160,"y":1040,"wires":[["c0c7f8db.d91918","c6776ace.02abc8"]]},{"id":"e1f38a3.b613d78","type":"ui_text","z":"9615284c.b28278","group":"7966a548.0d38ac","order":17,"width":0,"height":0,"name":"Время до уставки (мин)","label":"Время до уставки (мин)","format":"","layout":"row-spread","x":3130,"y":1300,"wires":[]},{"id":"e44f72e6.d07bf","type":"ui_text","z":"9615284c.b28278","group":"7966a548.0d38ac","order":14,"width":0,"height":0,"name":"Время стабилизации (мин)","label":"Время стабилизации (мин)","format":"","layout":"row-spread","x":3140,"y":1160,"wires":[]},{"id":"dc45386c.4dc938","type":"change","z":"9615284c.b28278","name":"process.reflux.stabtime","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.stabtime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1200,"wires":[["c6ceeb53.a86488","f6205003.8c1ff"]]},{"id":"b33c7d16.b91ad","type":"change","z":"9615284c.b28278","name":"process.reflux.deltatemptime","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.deltatemptime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3140,"y":1340,"wires":[["44cdf908.3f8668","ac66e116.f3459"]]},{"id":"c6ceeb53.a86488","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_stabtime","label":"","tooltip":"","group":"7966a548.0d38ac","order":15,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"0","max":"30","step":1,"x":3490,"y":1160,"wires":[["312fe08a.89682"]]},{"id":"312fe08a.89682","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.stabtime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3960,"y":1200,"wires":[["c6ceeb53.a86488","f6205003.8c1ff"]]},{"id":"f6205003.8c1ff","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_stabtime","label":"","tooltip":"","group":"7966a548.0d38ac","order":16,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"0","max":"30","step":1,"x":3490,"y":1240,"wires":[["312fe08a.89682"]]},{"id":"44cdf908.3f8668","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_deltatemptime","label":"","tooltip":"","group":"7966a548.0d38ac","order":18,"width":4,"height":1,"passthru":false,"outs":"all","topic":"Default_reflux","min":"0","max":"30","step":1,"x":3510,"y":1300,"wires":[["63e4dda2.ae76a4"]]},{"id":"63e4dda2.ae76a4","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.deltatemptime","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3970,"y":1340,"wires":[["44cdf908.3f8668","ac66e116.f3459"]]},{"id":"ac66e116.f3459","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_deltatemptime","label":"","tooltip":"","group":"7966a548.0d38ac","order":19,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"Default_reflux","format":"{{value}}","min":"0","max":"30","step":1,"x":3510,"y":1380,"wires":[["63e4dda2.ae76a4"]]},{"id":"59d16b2d.4c8f74","type":"inject","z":"9615284c.b28278","name":"Init startup","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"2","topic":"","payload":"","payloadType":"date","x":2790,"y":420,"wires":[["b6d66b6e.b4bfa8","55f1105f.2d519","e6560e0a.fbb2f","7f67022b.2fdf2c","7c983ec0.44149","4d7ed2f0.440e8c","990a647e.b91228","dc45386c.4dc938","b33c7d16.b91ad","52197d4f.6fa514","98579db1.bf0b1"]]},{"id":"eca08632.424cf8","type":"ui_text","z":"9615284c.b28278","group":"dc8ecbb3.7cff88","order":1,"width":0,"height":0,"name":"","label":"Процесс:","format":"{{msg.payload}}","layout":"row-spread","x":3140,"y":2040,"wires":[]},{"id":"ec40c6b2.76a188","type":"ui_dropdown","z":"9615284c.b28278","name":"Клапан воды","label":"Клапан воды","tooltip":"","place":"Автомат","group":"67d23292.dd341c","order":15,"width":0,"height":0,"passthru":false,"multiple":false,"options":[{"label":"Автомат","value":"auto","type":"str"},{"label":"Открыт","value":"true","type":"str"},{"label":"Закрыт","value":"false","type":"str"}],"payload":"","topic":"water","x":3160,"y":1860,"wires":[["fb70f707.095088"]]},{"id":"94b26d29.0fa95","type":"ui_dropdown","z":"9615284c.b28278","name":"Клапан тела","label":"Клапан тела&nbsp","tooltip":"","place":"Автомат","group":"67d23292.dd341c","order":16,"width":0,"height":0,"passthru":false,"multiple":false,"options":[{"label":"Автомат","value":"auto","type":"str"},{"label":"Открыт","value":"true","type":"str"},{"label":"Закрыт","value":"false","type":"str"}],"payload":"","topic":"body","x":3150,"y":1920,"wires":[["73d28238.ac8d0c"]]},{"id":"fb70f707.095088","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"valve.water.hand","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3400,"y":1860,"wires":[["27cba87b.968278"]]},{"id":"73d28238.ac8d0c","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"valve.body.hand","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3400,"y":1920,"wires":[["e7ca3d58.dcb06"]]},{"id":"cf83328e.7284c","type":"ui_dropdown","z":"9615284c.b28278","name":"Клапан голов","label":"Клапан голов","tooltip":"","place":"Автомат","group":"67d23292.dd341c","order":17,"width":0,"height":0,"passthru":false,"multiple":false,"options":[{"label":"Автомат","value":"auto","type":"str"},{"label":"Открыт","value":"true","type":"str"},{"label":"Закрыт","value":"false","type":"str"}],"payload":"","topic":"body","x":3160,"y":1980,"wires":[["76f70f95.d6cb6"]]},{"id":"76f70f95.d6cb6","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"valve.heads.hand","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3400,"y":1980,"wires":[[]]},{"id":"6c638daa.c37494","type":"link in","z":"9615284c.b28278","name":"Web Show Reflux Process","links":["23f3c2db.8d154e","54486d8.402fb94","da97c4bb.fe3418","bd707b3c.6a0088","740bd724.7f4268","5e62654b.fb452c","3141711f.8c363e","dca4129e.c9dbf","bae4d81b.edec68","1b90cb2d.ccdf45","105eea01.bb95d6"],"x":3035,"y":2040,"wires":[["eca08632.424cf8"]]},{"id":"27cba87b.968278","type":"link out","z":"9615284c.b28278","name":"Reflux Water Out","links":["96612f9e.68f1c","d3604d7a.98f39"],"x":3595,"y":1860,"wires":[]},{"id":"e7ca3d58.dcb06","type":"link out","z":"9615284c.b28278","name":"Reflux Body Out","links":["3a07c7fc.47bf38","6b05938c.c70d3c"],"x":3595,"y":1920,"wires":[]},{"id":"d6e06e2d.ec55f","type":"link in","z":"9615284c.b28278","name":"Reflux Water In","links":["ae1d4078.7c1ab","6b86e7a8.5b4408"],"x":3035,"y":1860,"wires":[["ec40c6b2.76a188"]]},{"id":"bbe79515.dfd5e8","type":"link in","z":"9615284c.b28278","name":"Reflux Body In","links":["3b37049d.41304c","5f1598bf.cec3f8"],"x":3035,"y":1920,"wires":[["94b26d29.0fa95"]]},{"id":"420eccce.7f0094","type":"ui_text","z":"9615284c.b28278","group":"7966a548.0d38ac","order":20,"width":0,"height":0,"name":"Температурная дельта","label":"Температурная дельта (с&deg;):","format":"","layout":"row-spread","x":3130,"y":1440,"wires":[]},{"id":"52197d4f.6fa514","type":"change","z":"9615284c.b28278","name":"process.reflux.deltatemp","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::process.reflux.deltatemp","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1500,"wires":[["fc32a9d8.4dedd8","711be4dc.b34c5c"]]},{"id":"fc32a9d8.4dedd8","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_deltatemp","label":"","tooltip":"","group":"7966a548.0d38ac","order":21,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":"0","max":"5","step":"0.5","x":3490,"y":1460,"wires":[["e33b769a.3eaec8"]]},{"id":"e33b769a.3eaec8","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.deltatemp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3960,"y":1500,"wires":[["fc32a9d8.4dedd8","711be4dc.b34c5c"]]},{"id":"711be4dc.b34c5c","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_deltatemp","label":"","tooltip":"","group":"7966a548.0d38ac","order":22,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":"0","max":"5","step":"0.5","x":3490,"y":1540,"wires":[["e33b769a.3eaec8"]]},{"id":"7fb9ce94.6e368","type":"ui_svg_graphics","z":"9615284c.b28278","group":"ec2a024e.dafca","order":2,"width":7,"height":13,"svgString":"<svg version=\"1.1\" style=\"display: block;\" width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 160 300\" enable-background=\"new 0 0 160 300\" xml:space=\"preserve\">\n//Бак\n<path id=\"cube\" style=\"fill:#EB7E11; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"0\" d=\"M42,173.5v5c0,0-32,7-32,18v93c0,2,2,4,4,4h71\nc2,0,4-2,4-4v-75h4v-4h-4v-14c0-12-32-18-32-18v-5H42z\"></path>\n\n//Царга\n<path id=\"tube\" style=\"fill:#35E43E; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"0\" d=\"M42,70.5v11c-13,0-23,4-23,14v44c2,5,2,16,2,16h2\n\tc0,0,0-11,2-16v-42c0-10,17-8,17-8v81h15v-83h5v-4h-5v-13H42z\"></path>\n\n//Тэн\n<path id=\"power\" style=\"fill:#DF2443; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"0\" d=\"M62,268h20c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H62\n\tc-1.1,0-2-0.9-2-2l0,0C60,268.9,60.9,268,62,268z M62,259h20c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H62c-1.1,0-2-0.9-2-2l0,0\n\tC60,259.9,60.9,259,62,259z M62,277h33c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H62c-1.1,0-2-0.9-2-2l0,0C60,277.9,60.9,277,62,277z\"></path>\n\n//Вода\n<path style=\"fill:#358DE4; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"1\" d=\"M42,39.5V67h15V34.4c-5.3,2.8-10.6,2.8-15,0V39.5z\"></path>\n<path id=\"water\" style=\"fill:#358DE4; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"1\" d=\"M40,42h28c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H40c-1.1,0-2-0.9-2-2l0,0C38,42.9,38.9,42,40,42z\nM40,50h20c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H40c-1.1,0-2-0.9-2-2l0,0C38,50.9,38.9,50,40,50z M40,58h20c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H40c-1.1,0-2-0.9-2-2l0,0C38,58.9,38.9,58,40,58z\"></path>\n\n//Запущен ли процесс\n<path id=\"switcher\" style=\"fill:none; !important;\" stroke=\"white\" stroke-miterlimit=\"10\" d=\"M49.4,17.4v8 M53,19.9c1.8,1.2,2.9,3.2,2.9,5.4c0,3.6-2.9,6.5-6.5,6.5\n\ts-6.5-2.9-6.5-6.5c0-2.2,1.1-4.2,2.9-5.4\"></path>\n\n<g>\n//Мощность тэна\n\t<path style=\"fill:none; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M150.1,289.5h-35.7c0-3.3-2.7-5.9-6-5.9c-1.7,0-3.2,0.7-4.3,1.9\n\t\tl-4.9-4.9 M104,285.4c-1,1.1-1.7,2.5-1.7,4.1c0,3.3,2.7,6,6,6s6-2.7,6-6c0,0,0,0,0-0.1\"></path>\n\n\t<text transform=\"matrix(1 0 0 1 104.5833 293.1173)\" font-size=\"8\">W</text>\n\t<text id=\"power_txt\" color=\"#FFFFFF\" transform=\"matrix(1 0 0 1 117 286.7083)\" font-size=\"12\">0%</text>\n</g>\n\n//Температура в кубе\n<g>\n\t<path style=\"fill:none; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M145.8,224.5H110c0-3.3-2.7-5.9-6-5.9c-1.7,0-3.2,0.7-4.3,1.9\n\t\tl-4.9-4.9 M99.7,220.4c-1,1.1-1.7,2.5-1.7,4.1c0,3.3,2.7,6,6,6s6-2.7,6-6c0,0,0,0,0-0.1\"></path>\n\t<text transform=\"matrix(1 0 0 1 100.25 228.1173)\" font-size=\"10\">К</text>\n\t<text id=\"cube_txt\" color=\"#FFFFFF\" transform=\"matrix(1 0 0 1 115 223.375)\" font-size=\"12\">N/A</text>\n</g>\n\n//Температура в царге\n<g>\n\t<path style=\"fill:none; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M114.8,98H79c0-3.3-2.7-5.9-6-5.9c-1.7,0-3.2,0.7-4.3,1.9l-4.9-4.9\n\t\t M68.7,93.9c-1,1.1-1.7,2.5-1.7,4.1c0,3.3,2.7,6,6,6s6-2.7,6-6c0,0,0,0,0-0.1\"></path>\n\t<text transform=\"matrix(1 0 0 1 68.875 101.5)\" font-size=\"10\">Ц</text>\n\t<text id=\"tube_txt\" color=\"#FFFFFF\" transform=\"matrix(1 0 0 1 82 97)\" font-size=\"12\">N/A</text>\n</g>\n\n//Температура воды\n<g>\n\t<path style=\"fill:none; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M121.8,55.5H86c0-3.3-2.7-5.9-6-5.9c-1.7,0-3.2,0.7-4.3,1.9l-4.9-4.9\n\t\t M75.7,51.4c-1,1.1-1.7,2.5-1.7,4.1c0,3.3,2.7,6,6,6s6-2.7,6-6c0,0,0,0,0-0.1\"></path>\n\t<text transform=\"matrix(1 0 0 1 76.0417 59.125)\" font-size=\"10\">В</text>\n\t<text id=\"water_txt\" color=\"#FFFFFF\" transform=\"matrix(1 0 0 1 90 54.25)\" font-size=\"12\">N/A</text>\n</g>\n\n//Давление\n<text style=\"fill:#2497BF;font-family:Arial;font-size:10px;\" x=\"93\" y=\"17\" id=\"press_txt\" xml:space=\"preserve\">N/A</text>\n</svg>","clickableShapes":[],"smilAnimations":[],"bindings":[],"showCoordinates":false,"autoFormatAfterEdit":false,"showBrowserErrors":true,"outputField":"payload","editorUrl":"//drawsvg.org/drawsvg.html","directory":"","panning":"disabled","zooming":"disabled","panOnlyWhenZoomed":false,"doubleClickZoomEnabled":false,"mouseWheelZoomEnabled":false,"name":"SVG_Reflux_Main","x":3450,"y":2100,"wires":[[]]},{"id":"96dd8eef.b242c","type":"link in","z":"9615284c.b28278","name":"Reflux SVG","links":["14b43b72.5fb525","33da07ad.b98498","36fa8fcf.643b9","bfb5341b.492e88","d1ae660d.d82d18","fd030360.74ea5","573c314d.5d082"],"x":3035,"y":2100,"wires":[["23fe807a.872ba"]]},{"id":"1aa6ee79.708842","type":"link out","z":"6546e589.95bfdc","name":"Dist SVG","links":["87c1479a.8f1b38","ee64a708.a83ba8"],"x":1695,"y":840,"wires":[]},{"id":"513f5541.8e0c2c","type":"ui_svg_graphics","z":"9615284c.b28278","group":"66b740b0.b8906","order":1,"width":7,"height":13,"svgString":"<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" style=\"display: block;\" width=\"100%\" height=\"100%\" x=\"0px\" y=\"0px\" viewBox=\"0 -0.10526315867900848 160 300.2105407714844\" enable-background=\"new 0 0 160 300\" xml:space=\"preserve\"><rect id=\"svgEditorBackground\" x=\"0\" y=\"0\" width=\"160\" height=\"300\" style=\"fill: none; stroke: none;\"/>\n//Бак\n<path id=\"cube\" style=\"fill:#EB7E11; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"0\" d=\"M42,173.5v5c0,0-32,7-32,18v93c0,2,2,4,4,4h71 c2,0,4-2,4-4v-75h4v-4h-4v-14c0-12-32-18-32-18v-5H42z\"/>\n\n//Царга\n<path id=\"tube\" style=\"fill:#35E43E; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"0\" d=\"M42,70.5v11c-13,0-23,4-23,14v44c2,5,2,16,2,16h2  c0,0,0-11,2-16v-42c0-10,17-8,17-8v81h15v-83h5v-4h-5v-13H42z\"/>\n\n//Тэн\n<path id=\"power\" style=\"fill:#DF2443; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"0\" d=\"M62,268h20c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H62  c-1.1,0-2-0.9-2-2l0,0C60,268.9,60.9,268,62,268z M62,259h20c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H62c-1.1,0-2-0.9-2-2l0,0  C60,259.9,60.9,259,62,259z M62,277h33c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H62c-1.1,0-2-0.9-2-2l0,0C60,277.9,60.9,277,62,277z\"/>\n\n//Вода\n<path style=\"fill:#358DE4; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"1\" d=\"M42,39.5V67h15V34.4c-5.3,2.8-10.6,2.8-15,0V39.5z\"/>\n<path id=\"water\" style=\"fill:#358DE4; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" fill-opacity=\"1\" d=\"M40,42h28c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H40c-1.1,0-2-0.9-2-2l0,0C38,42.9,38.9,42,40,42z M40,50h20c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H40c-1.1,0-2-0.9-2-2l0,0C38,50.9,38.9,50,40,50z M40,58h20c1.1,0,2,0.9,2,2l0,0c0,1.1-0.9,2-2,2H40c-1.1,0-2-0.9-2-2l0,0C38,58.9,38.9,58,40,58z\"/>\n\n//Запущен ли процесс\n<path id=\"switcher\" style=\"fill:none; !important;\" stroke=\"white\" stroke-miterlimit=\"10\" d=\"M49.4,17.4v8 M53,19.9c1.8,1.2,2.9,3.2,2.9,5.4c0,3.6-2.9,6.5-6.5,6.5  s-6.5-2.9-6.5-6.5c0-2.2,1.1-4.2,2.9-5.4\"/>\n\n<g>\n//Мощность тэна\n\t<path style=\"fill:none; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M150.1,289.5h-35.7c0-3.3-2.7-5.9-6-5.9c-1.7,0-3.2,0.7-4.3,1.9   l-4.9-4.9 M104,285.4c-1,1.1-1.7,2.5-1.7,4.1c0,3.3,2.7,6,6,6s6-2.7,6-6c0,0,0,0,0-0.1\"/>\n\n\t<text transform=\"matrix(1 0 0 1 104.5833 293.1173)\" font-size=\"8\">W</text>\n\t<text id=\"power_txt\" color=\"#FFFFFF\" transform=\"matrix(1 0 0 1 117 286.7083)\" font-size=\"12\">0%</text>\n</g>\n\n//Температура в кубе\n<g>\n\t<path style=\"fill:none; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M145.8,224.5H110c0-3.3-2.7-5.9-6-5.9c-1.7,0-3.2,0.7-4.3,1.9   l-4.9-4.9 M99.7,220.4c-1,1.1-1.7,2.5-1.7,4.1c0,3.3,2.7,6,6,6s6-2.7,6-6c0,0,0,0,0-0.1\"/>\n\t<text transform=\"matrix(1 0 0 1 100.25 228.1173)\" font-size=\"10\">К</text>\n\t<text id=\"cube_txt\" color=\"#FFFFFF\" transform=\"matrix(1 0 0 1 115 223.375)\" font-size=\"12\">N/A</text>\n</g>\n\n//Температура в царге\n<g>\n\t<path style=\"fill:none; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M114.8,98H79c0-3.3-2.7-5.9-6-5.9c-1.7,0-3.2,0.7-4.3,1.9l-4.9-4.9    M68.7,93.9c-1,1.1-1.7,2.5-1.7,4.1c0,3.3,2.7,6,6,6s6-2.7,6-6c0,0,0,0,0-0.1\"/>\n\t<text transform=\"matrix(1 0 0 1 68.875 101.5)\" font-size=\"10\">Ц</text>\n\t<text id=\"tube_txt\" color=\"#FFFFFF\" transform=\"matrix(1 0 0 1 82 97)\" font-size=\"12\">N/A</text>\n</g>\n\n//Температура воды\n<g>\n\t<path style=\"fill:none; !important;\" stroke=\"#000000\" stroke-miterlimit=\"10\" d=\"M121.8,55.5H86c0-3.3-2.7-5.9-6-5.9c-1.7,0-3.2,0.7-4.3,1.9l-4.9-4.9    M75.7,51.4c-1,1.1-1.7,2.5-1.7,4.1c0,3.3,2.7,6,6,6s6-2.7,6-6c0,0,0,0,0-0.1\"/>\n\t<text transform=\"matrix(1 0 0 1 76.0417 59.125)\" font-size=\"10\">В</text>\n\t<text id=\"water_txt\" color=\"#FFFFFF\" transform=\"matrix(1 0 0 1 90 54.25)\" font-size=\"12\">N/A</text>\n</g>\n\n//Давление\n<text style=\"fill:#2497BF;font-family:Arial;font-size:10px;\" x=\"93\" y=\"17\" id=\"press_txt\" xml:space=\"preserve\">N/A</text>\n</svg>","clickableShapes":[],"smilAnimations":[],"bindings":[],"showCoordinates":false,"autoFormatAfterEdit":false,"showBrowserErrors":true,"outputField":"payload","editorUrl":"//drawsvg.org/drawsvg.html","directory":"","panning":"disabled","zooming":"disabled","panOnlyWhenZoomed":false,"doubleClickZoomEnabled":false,"mouseWheelZoomEnabled":false,"name":"SVG_Dist_Main","x":320,"y":4740,"wires":[[]]},{"id":"ee64a708.a83ba8","type":"link in","z":"9615284c.b28278","name":"Dist SVG","links":["14b43b72.5fb525","36fa8fcf.643b9","bfb5341b.492e88","c5ad79a5.ac7858","1aa6ee79.708842"],"x":175,"y":4740,"wires":[["513f5541.8e0c2c"]]},{"id":"a731a466.f59338","type":"change","z":"7459d84c.edbbd8","name":"Enable next button and mark status on","rules":[{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"red\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2370,"y":1400,"wires":[["573c314d.5d082"]]},{"id":"30930a4e.5c1816","type":"change","z":"7459d84c.edbbd8","name":"Disable next button and mark status off","rules":[{"t":"set","p":"enabled","pt":"msg","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"white\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2370,"y":1740,"wires":[["573c314d.5d082"]]},{"id":"573c314d.5d082","type":"link out","z":"7459d84c.edbbd8","name":"Manage Next Button","links":["4ce34385.e6017c","96dd8eef.b242c"],"x":2655,"y":1560,"wires":[]},{"id":"7ae96824.921d28","type":"link out","z":"6546e589.95bfdc","name":"Web Show Dist Process","links":["174dbc3e.bc15d4","49c209d9.988ab8"],"x":3395,"y":300,"wires":[]},{"id":"f8be644e.aef5e8","type":"ui_text","z":"9615284c.b28278","group":"6cfb75c2.e1263c","order":1,"width":0,"height":0,"name":"","label":"Процесс:","format":"{{msg.payload}}","layout":"row-spread","x":300,"y":4680,"wires":[]},{"id":"49c209d9.988ab8","type":"link in","z":"9615284c.b28278","name":"Web Show Dist Process","links":["3a42c0d7.d8a24","4e077f32.6a0e9","6a916350.1c735c","7ae96824.921d28","ce87f73f.f79658"],"x":175,"y":4680,"wires":[["f8be644e.aef5e8"]]},{"id":"156ae73d.d3f8d9","type":"ui_ui_control","z":"9615284c.b28278","name":"","events":"connect","x":760,"y":700,"wires":[["6ec11787.298af8"]]},{"id":"388cc27d.a0d70e","type":"change","z":"9615284c.b28278","name":"Переносимся на процесс Ректификация","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Ректификация\"}","tot":"json"},{"t":"delete","p":"socketid","pt":"msg"},{"t":"delete","p":"socketip","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":640,"wires":[["156ae73d.d3f8d9","c6b8fdc6.305ca"]]},{"id":"6ec11787.298af8","type":"switch","z":"9615284c.b28278","name":"","property":"process.type","propertyType":"global","rules":[{"t":"eq","v":"reflux","vt":"str"},{"t":"eq","v":"dist","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":910,"y":700,"wires":[["388cc27d.a0d70e"],["e825c15d.778eb"]]},{"id":"e825c15d.778eb","type":"change","z":"9615284c.b28278","name":"Переносимся на процесс Дистилляция","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Дистилляция\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":760,"wires":[["156ae73d.d3f8d9","c6b8fdc6.305ca"]]},{"id":"c6b8fdc6.305ca","type":"delay","z":"9615284c.b28278","name":"","pauseType":"delay","timeout":"200","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1530,"y":700,"wires":[["156ae73d.d3f8d9","1a021eb9.e0d5d1"]]},{"id":"1a021eb9.e0d5d1","type":"change","z":"9615284c.b28278","name":"To SVG","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"command\":\"set_attribute\",\"selector\":\"#switcher\",\"attributeName\":\"stroke\",\"attributeValue\":\"red\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":700,"wires":[["14b43b72.5fb525"]]},{"id":"58a34d49.c173e4","type":"comment","z":"9615284c.b28278","name":"Начальный экран","info":"","x":800,"y":620,"wires":[]},{"id":"c4ac0c03.784c5","type":"change","z":"7459d84c.edbbd8","name":"Переносимся на процесс Ректификация","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Ректификация\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1880,"y":1460,"wires":[["6ee057fe.6d0f98"]]},{"id":"23fe807a.872ba","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"delete","p":"socketid","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3200,"y":2100,"wires":[["7fb9ce94.6e368"]]},{"id":"9187323c.88a3f","type":"change","z":"6546e589.95bfdc","name":"Delete sockets","rules":[{"t":"delete","p":"socketid","pt":"msg"},{"t":"delete","p":"socketip","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2220,"y":840,"wires":[["340232ca.023ece"]]},{"id":"7024c9f7.21c808","type":"change","z":"6546e589.95bfdc","name":"Переносимся на процесс Ректификация","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Дистилляция\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1880,"y":780,"wires":[["9187323c.88a3f"]]},{"id":"6ee057fe.6d0f98","type":"change","z":"7459d84c.edbbd8","name":"Delete sockets","rules":[{"t":"delete","p":"socketid","pt":"msg"},{"t":"delete","p":"socketip","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":1540,"wires":[["82865879.7450a8"]]},{"id":"1b90cb2d.ccdf45","type":"link out","z":"7459d84c.edbbd8","name":"From Body","links":["1fa47b77.e25f75","6c638daa.c37494","d6e6a230.d2666"],"x":3855,"y":140,"wires":[]},{"id":"b717581f.fbc0e8","type":"change","z":"7459d84c.edbbd8","name":"Отбор тела","rules":[{"t":"set","p":"valve.water.on","pt":"global","to":"true","tot":"bool"},{"t":"set","p":"valve.heads.on","pt":"global","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"Отбор тела","tot":"str"},{"t":"set","p":"process.reflux.stage","pt":"global","to":"body","tot":"str"},{"t":"set","p":"process.reflux.valvebodystop","pt":"global","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":3710,"y":140,"wires":[["1b90cb2d.ccdf45","a86b0626.c111b8"]]},{"id":"e6713164.7bef8","type":"ui_text","z":"9615284c.b28278","group":"8e947e7.25f798","order":13,"width":0,"height":0,"name":"Температура окончания погона","label":"Окончание погона (c&deg; в кубе):","format":"","layout":"row-left","x":500,"y":3680,"wires":[]},{"id":"8f7d42b.f3d9bc","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_temp_end_work_slider","label":"","tooltip":"","group":"8e947e7.25f798","order":14,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":"80","max":"100","step":"0.1","x":870,"y":3700,"wires":[["1feb33e3.bb589c"]]},{"id":"1feb33e3.bb589c","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"#:(file)::default.reflux.temp.end","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":3740,"wires":[["8f7d42b.f3d9bc","ad94d375.62e99"]]},{"id":"ad94d375.62e99","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_temp_end_work_numeric","label":"","tooltip":"","group":"8e947e7.25f798","order":15,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":"80","max":"100","step":"0.1","x":880,"y":3780,"wires":[["1feb33e3.bb589c"]]},{"id":"460bdde9.a2bcf4","type":"change","z":"9615284c.b28278","name":"process.dist.temp.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::default.reflux.temp.end.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":3720,"wires":[["8f7d42b.f3d9bc","ad94d375.62e99"]]},{"id":"55830cc8.7c3c64","type":"ui_text","z":"9615284c.b28278","group":"7966a548.0d38ac","order":11,"width":0,"height":0,"name":"Температура окончания погона","label":"Окончание погона (c&deg; в кубе):","format":"","layout":"row-left","x":3160,"y":1600,"wires":[]},{"id":"1104e2f2.e48a9d","type":"ui_slider","z":"9615284c.b28278","name":"process_reflux_end_work_slider","label":"","tooltip":"","group":"7966a548.0d38ac","order":12,"width":4,"height":1,"passthru":false,"outs":"all","topic":"process_reflux","min":"80","max":"100","step":"0.1","x":3510,"y":1620,"wires":[["5cc4d431.296bac"]]},{"id":"5cc4d431.296bac","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.temp.end","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3960,"y":1660,"wires":[["1104e2f2.e48a9d","1c38d8a4.d55847"]]},{"id":"1c38d8a4.d55847","type":"ui_numeric","z":"9615284c.b28278","name":"process_reflux_end_work_numeric","label":"","tooltip":"","group":"7966a548.0d38ac","order":13,"width":3,"height":1,"wrap":false,"passthru":false,"topic":"process_reflux","format":"{{value}}","min":"80","max":"100","step":"0.1","x":3520,"y":1700,"wires":[["5cc4d431.296bac"]]},{"id":"98579db1.bf0b1","type":"change","z":"9615284c.b28278","name":"process.reflux.temp.work","rules":[{"t":"set","p":"payload","pt":"msg","to":"#:(file)::process.reflux.temp.end.work","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3130,"y":1640,"wires":[["1104e2f2.e48a9d","1c38d8a4.d55847"]]},{"id":"b372cac8.5ce1f8","type":"opi_out","z":"372e1e33.0db3b2","name":"Pin 28 - PA18","set":false,"level":0,"select":"PC","pin":"18","x":1380,"y":3780,"wires":[]},{"id":"a9648813.5743b8","type":"switch","z":"372e1e33.0db3b2","name":"Alarm On?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":1570,"y":2760,"wires":[["e8434b9c.035168","e2392593.441de8"]]},{"id":"e8434b9c.035168","type":"switch","z":"372e1e33.0db3b2","name":"Buzzer on?","property":"#:(file)::buzzer_on","propertyType":"global","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":1770,"y":2760,"wires":[["3dac45f.7e81aba"]]},{"id":"3dac45f.7e81aba","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1980,"y":2760,"wires":[["acf33c42.3f953"]]},{"id":"acf33c42.3f953","type":"change","z":"372e1e33.0db3b2","name":"Смени тару!","rules":[{"t":"set","p":"payload","pt":"msg","to":"Смени тару!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":2760,"wires":[["df84d271.abf1b"]]},{"id":"53431744.1ec108","type":"switch","z":"372e1e33.0db3b2","name":"Alarm On?","property":"safe.liquid","propertyType":"global","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":3600,"wires":[["49a0109d.ea925"],["82a7f34e.ca8e6"]]},{"id":"510ceb73.35b634","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":770,"y":3440,"wires":[["ec949f25.fc10e"]]},{"id":"799c0a55.20e3e4","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":770,"y":3560,"wires":[["9364c006.eb949"]]},{"id":"37b61eb6.ab2132","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":770,"y":3680,"wires":[["4c631dae.6b8574"]]},{"id":"df84d271.abf1b","type":"link out","z":"372e1e33.0db3b2","name":"Alarm Audio Out","links":["d6e6a230.d2666"],"x":2315,"y":2760,"wires":[]},{"id":"b1d12ac5.b71a88","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"timed","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1320,"y":740,"wires":[["a6c017d6.296a28"]]},{"id":"1ef16c15.68cd44","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1600,"y":560,"wires":[["c8812022.a5a02"]]},{"id":"4d55c633.d7a308","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1520,"y":680,"wires":[["a6c017d6.296a28"]]},{"id":"10356d35.1e9353","type":"opi_out","z":"372e1e33.0db3b2","name":"Pin 37 - PA20","set":false,"level":0,"select":"PC","pin":"20","x":2820,"y":1300,"wires":[]},{"id":"b2af3837.0bf038","type":"change","z":"372e1e33.0db3b2","name":"Disable Power Pin","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2570,"y":1340,"wires":[["10356d35.1e9353"]]},{"id":"1c03bf82.78a3d","type":"change","z":"372e1e33.0db3b2","name":"Enable Power Pin","rules":[{"t":"set","p":"payload","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2570,"y":1260,"wires":[["10356d35.1e9353"]]},{"id":"5cd3ba7d.619b34","type":"link in","z":"372e1e33.0db3b2","name":"Disable interval","links":["fab985a0.2eaf38","4bd78759.0ff218","56eec5a8.b7c82c","342684d5.de28fc","f5adb46d.380098","dee5200c.fa6c","fe5cac12.c2a38"],"x":1955,"y":2440,"wires":[["3684c44d.3bb2dc"]]},{"id":"dee5200c.fa6c","type":"link out","z":"372e1e33.0db3b2","name":"Valve body out 7","links":["2ac53303.9cfb6c","5cd3ba7d.619b34"],"x":575,"y":2200,"wires":[]},{"id":"fe5cac12.c2a38","type":"link out","z":"372e1e33.0db3b2","name":"Valve body out 8","links":["5cd3ba7d.619b34"],"x":935,"y":2220,"wires":[]},{"id":"4bef8157.85c87","type":"link out","z":"7459d84c.edbbd8","name":"Rect Out 1","links":["1fa47b77.e25f75"],"x":3255,"y":600,"wires":[]},{"id":"1fa47b77.e25f75","type":"link in","z":"7459d84c.edbbd8","name":"Rect In 1","links":["4bef8157.85c87","1b90cb2d.ccdf45"],"x":115,"y":740,"wires":[["94b23bea.387cc8"]]},{"id":"a8e7f068.d91c","type":"delay","z":"7459d84c.edbbd8","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2140,"y":60,"wires":[["6e9c1ec0.a8557"]]},{"id":"6e9c1ec0.a8557","type":"switch","z":"7459d84c.edbbd8","name":"датчик жидкости не ложная сработка?","property":"safe.liquid","propertyType":"global","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2400,"y":60,"wires":[["91050f7f.a3d8f"],["a75036d2.3dba78"]]},{"id":"4336242b.cf43ac","type":"ui_gauge","z":"9615284c.b28278","name":"Старт/Стопов","group":"dc8ecbb3.7cff88","order":6,"width":7,"height":4,"gtype":"gage","title":"Старт/Стопов","label":"","format":"{{value}}","min":0,"max":10,"colors":["#00b500","#e6e600","#ca3838"],"seg1":"5","seg2":"7","x":4280,"y":2200,"wires":[]},{"id":"ff2fc5dd.2b27d8","type":"inject","z":"9615284c.b28278","name":"Set at startup","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":"2","topic":"","payload":"process.reflux.startstop","payloadType":"global","x":4080,"y":2180,"wires":[["4336242b.cf43ac"]]},{"id":"23bee91c.46f5c6","type":"change","z":"9615284c.b28278","name":"set to process.reflux.startstop","rules":[{"t":"set","p":"payload","pt":"msg","to":"process.reflux.startstop","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":4060,"y":2240,"wires":[["4336242b.cf43ac"]]},{"id":"5a17a7b7.3eaba8","type":"link in","z":"9615284c.b28278","name":"Set start/stop gauge","links":["fcd56357.d4546","af31928b.ae0ab"],"x":3895,"y":2240,"wires":[["23bee91c.46f5c6"]]},{"id":"fcd56357.d4546","type":"link out","z":"7459d84c.edbbd8","name":"Temp Alert Out","links":["5a17a7b7.3eaba8"],"x":3595,"y":180,"wires":[]},{"id":"5415b200.b95c2c","type":"change","z":"7459d84c.edbbd8","name":"Установим открытие клапана (старт/стоп)","rules":[{"t":"set","p":"process.reflux.valve.body.opentime","pt":"global","to":"$round(($globalContext('process.reflux.valve.body.opentime')*100/(100-($globalContext('process.reflux.startstop')-1)*10))-(($globalContext('process.reflux.valve.body.opentime')*100/(100-($globalContext('process.reflux.startstop')-1)*10))*$globalContext('process.reflux.startstop')*10/100))","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"process.reflux.valve.body.opentime","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":2030,"y":820,"wires":[["3ea072c6.44be0e"]]},{"id":"370654aa.bc604c","type":"link in","z":"9615284c.b28278","name":"OpenTime In","links":["3ea072c6.44be0e"],"x":2875,"y":900,"wires":[["4d7ed2f0.440e8c"]]},{"id":"3ea072c6.44be0e","type":"link out","z":"7459d84c.edbbd8","name":"OpenTime Out","links":["370654aa.bc604c"],"x":2275,"y":820,"wires":[]},{"id":"e7d9bee1.35fef","type":"ui_button","z":"9615284c.b28278","name":"","group":"ec2a024e.dafca","order":6,"width":0,"height":0,"passthru":false,"label":"Сбросить уставку","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":3370,"y":2300,"wires":[["1c9e70ff.65bf8f"]]},{"id":"1c9e70ff.65bf8f","type":"change","z":"9615284c.b28278","name":"Сбросим уставку","rules":[{"t":"set","p":"process.reflux.startpress","pt":"global","to":"pressure.current","tot":"global"},{"t":"set","p":"process.reflux.startalcboil","pt":"global","to":"78.14 - (760 - $globalContext('process.reflux.startpress'))*0.037","tot":"jsonata"},{"t":"set","p":"process.reflux.stabtemp","pt":"global","to":"temperature.tube","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":3650,"y":2300,"wires":[[]]},{"id":"5eb38637.0fed88","type":"inject","z":"6546e589.95bfdc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"3","topic":"","payload":"","payloadType":"date","x":1770,"y":1080,"wires":[["7287de07.41a92"]]},{"id":"a6f6c86.b055338","type":"inject","z":"9615284c.b28278","name":"","props":[{"p":"enabled","v":"false","vt":"bool"}],"repeat":"","crontab":"","once":true,"onceDelay":"3","topic":"","payloadType":"str","x":3130,"y":2300,"wires":[["e7d9bee1.35fef"]]},{"id":"f6e73f16.892d","type":"link in","z":"9615284c.b28278","name":"Reset Button In","links":["b941b314.17733","21abfc12.1be134"],"x":3075,"y":2360,"wires":[["e7d9bee1.35fef"]]},{"id":"b941b314.17733","type":"link out","z":"7459d84c.edbbd8","name":"Resset Button Out","links":["f6e73f16.892d"],"x":3595,"y":60,"wires":[]},{"id":"950135cb.3ea758","type":"change","z":"7459d84c.edbbd8","name":"Включим кнопку \"сброс уставки\"","rules":[{"t":"set","p":"enabled","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":3400,"y":60,"wires":[["b941b314.17733"]]},{"id":"21abfc12.1be134","type":"link out","z":"7459d84c.edbbd8","name":"Resset Button Out","links":["f6e73f16.892d"],"x":3215,"y":1140,"wires":[]},{"id":"ead10.3af862f1","type":"change","z":"7459d84c.edbbd8","name":"Выключим кнопку \"сброс уставки\"","rules":[{"t":"set","p":"enabled","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":3020,"y":1140,"wires":[["21abfc12.1be134"]]},{"id":"58c308d4.1da988","type":"delay","z":"6546e589.95bfdc","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":930,"y":860,"wires":[["3504aa52.957e86"]]},{"id":"f01a138b.876d8","type":"switch","z":"6546e589.95bfdc","name":"Греем?","property":"process.dist.stage","propertyType":"global","rules":[{"t":"eq","v":"heat","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":1080,"y":100,"wires":[["6b556a7d.28d4d4"],["deb1aa38.ba5e38"]],"outputLabels":["heat",""]},{"id":"8c3a0c12.bd97c","type":"switch","z":"6546e589.95bfdc","name":"Работаем?","property":"process.dist.stage","propertyType":"global","rules":[{"t":"eq","v":"work","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2110,"y":120,"wires":[["5a864dc3.166c24"],["4c39e101.5bfa7"]],"outputLabels":["work",null]},{"id":"c9d76eb7.65491","type":"link in","z":"6546e589.95bfdc","name":"Cooling In","links":["868979e3.281358","5682d015.d1598","461a7a2d.90d1c4"],"x":2435,"y":380,"wires":[["ef363b93.0b0f88"]]},{"id":"ea2ee7da.2de808","type":"ui_button","z":"9615284c.b28278","name":"","group":"65f9b6e5.44a978","order":17,"width":0,"height":0,"passthru":false,"label":"Следующий этап","tooltip":"","color":"","bgcolor":"","icon":"","payload":"Next","payloadType":"str","topic":"","x":310,"y":4900,"wires":[["dcb2df41.9284a"]]},{"id":"80a3cf43.fd9f","type":"link in","z":"9615284c.b28278","name":"Nextbutton Dist","links":["9017a154.576a8","19e8ced7.d67ec1"],"x":175,"y":4900,"wires":[["ea2ee7da.2de808"]]},{"id":"dcb2df41.9284a","type":"switch","z":"9615284c.b28278","name":"Current Process?","property":"process.dist.stage","propertyType":"global","rules":[{"t":"eq","v":"heat","vt":"str"},{"t":"eq","v":"work","vt":"str"},{"t":"eq","v":"cooling","vt":"str"}],"checkall":"false","repair":false,"outputs":3,"x":590,"y":4900,"wires":[["681473c4.e05ebc"],["9ed60540.e29d78"],["44d1cbcd.796ce4"]],"outputLabels":["heat","work",""]},{"id":"5682d015.d1598","type":"link out","z":"9615284c.b28278","name":"Cooling Out","links":["c9d76eb7.65491"],"x":975,"y":4940,"wires":[]},{"id":"681473c4.e05ebc","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.dist.stage","pt":"global","to":"work","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":880,"y":4860,"wires":[[]]},{"id":"9ed60540.e29d78","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.dist.stage","pt":"global","to":"cooling","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":880,"y":4900,"wires":[[]]},{"id":"44d1cbcd.796ce4","type":"change","z":"9615284c.b28278","name":"Timer off","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":4940,"wires":[["5682d015.d1598"]]},{"id":"461a7a2d.90d1c4","type":"link out","z":"6546e589.95bfdc","name":"Cooling Out","links":["c9d76eb7.65491"],"x":655,"y":820,"wires":[]},{"id":"2ed4a44f.400e3c","type":"change","z":"6546e589.95bfdc","name":"Error process","rules":[{"t":"set","p":"process.dist.stage","pt":"global","to":"error_finish","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":760,"wires":[["8e0da552.dc6198","27106624.65070a"]]},{"id":"f3bfed01.5e4f1","type":"link out","z":"6546e589.95bfdc","name":"Start Button Out","links":["d758ba6a.50d1e8","4d92d8a0.7f6bd8"],"x":1255,"y":860,"wires":[]},{"id":"543f46b2.c78b68","type":"ui_switch","z":"9615284c.b28278","name":"Запуск процесса","label":"Старт","tooltip":"Проверь что бак залит!","group":"65f9b6e5.44a978","order":1,"width":0,"height":0,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":310,"y":4820,"wires":[["e94029e1.f235e8"]]},{"id":"4d92d8a0.7f6bd8","type":"link in","z":"9615284c.b28278","name":"Dist Button In","links":["f3bfed01.5e4f1"],"x":175,"y":4820,"wires":[["543f46b2.c78b68"]]},{"id":"e94029e1.f235e8","type":"link out","z":"9615284c.b28278","name":"Dist Button out","links":["d9576b15.cf5d68"],"x":455,"y":4820,"wires":[]},{"id":"570981c1.88241","type":"link in","z":"7459d84c.edbbd8","name":"Start Button In","links":["473d2c94.57be14","36475ff0.c8f9b","bc6e633.fa3d4a","4da2d53b.800fdc"],"x":1015,"y":1520,"wires":[["3597914e.d7543e"]]},{"id":"7f323b66.ca6f14","type":"link out","z":"7459d84c.edbbd8","name":"Start Button Out","links":["210defce.1fe69","5cea57a4.b59838"],"x":1235,"y":1560,"wires":[]},{"id":"9d52c80d.e79438","type":"ui_switch","z":"9615284c.b28278","name":"Запуск процесса","label":"Старт","tooltip":"Проверь что бак залит!","group":"7966a548.0d38ac","order":1,"width":0,"height":0,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":3210,"y":2400,"wires":[["36475ff0.c8f9b","8b188ced.b2e","d6e7780a.fff498"]]},{"id":"5cea57a4.b59838","type":"link in","z":"9615284c.b28278","name":"Rect Button In","links":["7f323b66.ca6f14"],"x":3075,"y":2400,"wires":[["9d52c80d.e79438"]]},{"id":"36475ff0.c8f9b","type":"link out","z":"9615284c.b28278","name":"Rect Button Out","links":["570981c1.88241"],"x":3535,"y":2360,"wires":[]},{"id":"8ef0fed9.a6727","type":"change","z":"7459d84c.edbbd8","name":"payload false","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1560,"wires":[["6f3cd221.5300cc"]]},{"id":"6f3cd221.5300cc","type":"delay","z":"7459d84c.edbbd8","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":950,"y":1560,"wires":[["3597914e.d7543e"]]},{"id":"67baedd8.0e0c84","type":"link out","z":"7459d84c.edbbd8","name":"Stop Out","links":["74a2315e.c2a44","f6a6c804.077ca8","76b533f.f3c98cc","6b0ad7d6.b5f8d8"],"x":715,"y":1660,"wires":[]},{"id":"74a2315e.c2a44","type":"link in","z":"7459d84c.edbbd8","name":"Stop In 1","links":["67baedd8.0e0c84","fa845f6f.5d4d5","97d2ac2b.7b88e"],"x":1435,"y":140,"wires":[["af007b4f.1cb418"]]},{"id":"f6a6c804.077ca8","type":"link in","z":"7459d84c.edbbd8","name":"Stop In 2","links":["67baedd8.0e0c84","87ff20a6.7dcea","d86b54ef.80ba08"],"x":2915,"y":240,"wires":[["54c92a61.1508f4"]]},{"id":"76b533f.f3c98cc","type":"link in","z":"7459d84c.edbbd8","name":"Stop In 4","links":["67baedd8.0e0c84","ff2757cb.617458"],"x":2815,"y":1020,"wires":[["69c638d7.3530e8","ead10.3af862f1"]]},{"id":"3c7e70ea.76828","type":"change","z":"7459d84c.edbbd8","name":"Error process","rules":[{"t":"set","p":"process.reflux.stage","pt":"global","to":"error_finish","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":1500,"wires":[["e225dccf.9ed44","2abcd0c9.3a88e"]]},{"id":"d5ae7e0e.b76dc","type":"switch","z":"7459d84c.edbbd8","name":"Греем?","property":"process.reflux.stage","propertyType":"global","rules":[{"t":"eq","v":"heat","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":1020,"y":80,"wires":[["26c5227c.da5cfe"],["4691be29.e5c4"]],"outputLabels":["heat",""]},{"id":"b572c3dd.4d087","type":"switch","z":"7459d84c.edbbd8","name":"Головы?","property":"process.reflux.stage","propertyType":"global","rules":[{"t":"eq","v":"head","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":2500,"y":260,"wires":[["ca79898a.d28908"],["91050f7f.a3d8f"]]},{"id":"e59104.be47af","type":"ui_button","z":"9615284c.b28278","name":"","group":"7966a548.0d38ac","order":24,"width":7,"height":1,"passthru":false,"label":"Следующий этап","tooltip":"","color":"","bgcolor":"","icon":"","payload":"Next","payloadType":"str","topic":"","x":3090,"y":2660,"wires":[["84299d90.daa86"]]},{"id":"4ce34385.e6017c","type":"link in","z":"9615284c.b28278","name":"Nextbutton Reflux","links":["9017a154.576a8","573c314d.5d082"],"x":2955,"y":2660,"wires":[["e59104.be47af"]]},{"id":"84299d90.daa86","type":"switch","z":"9615284c.b28278","name":"Current Process?","property":"process.reflux.stage","propertyType":"global","rules":[{"t":"eq","v":"heat","vt":"str"},{"t":"eq","v":"stabilize","vt":"str"},{"t":"eq","v":"head","vt":"str"},{"t":"eq","v":"setpoint","vt":"str"},{"t":"eq","v":"body","vt":"str"},{"t":"eq","v":"cooling","vt":"str"}],"checkall":"false","repair":false,"outputs":6,"x":3310,"y":2660,"wires":[["2c37060d.b959aa"],["ae6c46cd.9f8ce8"],["54457bdf.ecd2d4"],["da1b8420.db9888"],["c499d9f2.c10cf8"],["c2fc4381.56284"]]},{"id":"ae6c46cd.9f8ce8","type":"change","z":"9615284c.b28278","name":"Stop Stab timer","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3580,"y":2600,"wires":[["97d2ac2b.7b88e"]]},{"id":"2c37060d.b959aa","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.stage","pt":"global","to":"stabilize","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3630,"y":2560,"wires":[[]]},{"id":"97d2ac2b.7b88e","type":"link out","z":"9615284c.b28278","name":"Reflux Stop Out 1","links":["74a2315e.c2a44"],"x":3735,"y":2600,"wires":[]},{"id":"54457bdf.ecd2d4","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.stage","pt":"global","to":"setpoint","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3630,"y":2640,"wires":[[]]},{"id":"da1b8420.db9888","type":"change","z":"9615284c.b28278","name":"Stop Stab timer","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3580,"y":2680,"wires":[["d86b54ef.80ba08"]]},{"id":"d86b54ef.80ba08","type":"link out","z":"9615284c.b28278","name":"Reflux Stop Out 2","links":["f6a6c804.077ca8"],"x":3735,"y":2680,"wires":[]},{"id":"c2fc4381.56284","type":"change","z":"9615284c.b28278","name":"Stop Stab timer","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3580,"y":2760,"wires":[["ff2757cb.617458"]]},{"id":"ff2757cb.617458","type":"link out","z":"9615284c.b28278","name":"Reflux Stop Out 4","links":["76b533f.f3c98cc"],"x":3715,"y":2760,"wires":[]},{"id":"c499d9f2.c10cf8","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.stage","pt":"global","to":"cooling","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3630,"y":2720,"wires":[["864ad89e.2fe558"]]},{"id":"cab7ddc2.91d0a","type":"link out","z":"7459d84c.edbbd8","name":"Tempalert Out","links":["9e3142ce.60dc6","1a3d4576.7ebf6b"],"x":1215,"y":600,"wires":[]},{"id":"317a95dc.f5f05a","type":"ui_text","z":"9615284c.b28278","group":"ec2a024e.dafca","order":4,"width":0,"height":0,"name":"","label":"Уставка:","format":"{{msg.payload}}","layout":"row-center","x":3720,"y":2480,"wires":[]},{"id":"1a3d4576.7ebf6b","type":"link in","z":"9615284c.b28278","name":"Tempalert In","links":["cab7ddc2.91d0a","bcf44351.aa671"],"x":3595,"y":2480,"wires":[["317a95dc.f5f05a"]]},{"id":"af31928b.ae0ab","type":"link out","z":"7459d84c.edbbd8","name":"StartStop Out","links":["5a17a7b7.3eaba8"],"x":1875,"y":660,"wires":[]},{"id":"1006a259.ddd22e","type":"change","z":"372e1e33.0db3b2","name":"Enable tabs","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tabs\":{\"show\":[\"Дистилляция\",\"Ректификация\",\"Настройки\"],\"enable\":[\"Дистилляция\",\"Ректификация\",\"Настройки\"]}}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":120,"wires":[["ba101be8.5806b8"]]},{"id":"ba101be8.5806b8","type":"change","z":"372e1e33.0db3b2","name":"Delete sockets","rules":[{"t":"delete","p":"socketid","pt":"msg"},{"t":"delete","p":"socketip","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1040,"y":120,"wires":[["7cae6dad.f45404"]]},{"id":"7cae6dad.f45404","type":"ui_ui_control","z":"372e1e33.0db3b2","name":"","events":"connect","x":1260,"y":120,"wires":[[]]},{"id":"3ce0d771.40bc78","type":"switch","z":"7459d84c.edbbd8","name":"Отбираем?","property":"process.reflux.stage","propertyType":"global","rules":[{"t":"eq","v":"body","vt":"str"},{"t":"else"}],"checkall":"false","repair":false,"outputs":2,"x":630,"y":700,"wires":[["fd1bac33.41a98"],["9bf47a6b.75a3f8"]],"outputLabels":["heat",""]},{"id":"bcf44351.aa671","type":"link out","z":"372e1e33.0db3b2","name":"Set Temp Alert","links":["1a3d4576.7ebf6b","351230f0.8ea72","a428ce0c.34a3c"],"x":795,"y":200,"wires":[]},{"id":"9b12329b.9bc06","type":"mytimeout","z":"7459d84c.edbbd8","name":"Таймаут старт/стоп","outtopic":"","outsafe":"","outwarning":"","outunsafe":"next","warning":"0","timer":"60","debug":false,"ndebug":false,"ignoreCase":false,"repeat":false,"again":false,"x":2520,"y":700,"wires":[["cef9b112.f1f02"],["af72e83b.ed0b98"]]},{"id":"af72e83b.ed0b98","type":"switch","z":"7459d84c.edbbd8","name":">0","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":2670,"y":780,"wires":[["bf49f06b.667d3"]]},{"id":"bf49f06b.667d3","type":"change","z":"7459d84c.edbbd8","name":"Охлаждение осталось ...","rules":[{"t":"set","p":"payload","pt":"msg","to":"$join([\"Старт/Стоп, осталось \", $pad($string($floor(msg.payload/60)), -2, '0'), \":\", $pad($string(msg.payload-$floor(msg.payload/60)*60), -2, '0'), \"мин\"])\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2850,"y":780,"wires":[["105eea01.bb95d6"]]},{"id":"105eea01.bb95d6","type":"link out","z":"7459d84c.edbbd8","name":"From Final","links":["81f9dfe7.8e127","6c638daa.c37494"],"x":3035,"y":780,"wires":[]},{"id":"6b0ad7d6.b5f8d8","type":"link in","z":"7459d84c.edbbd8","name":"Stop In 3","links":["67baedd8.0e0c84","55cf13db.91f86c"],"x":2375,"y":760,"wires":[["9b12329b.9bc06"]]},{"id":"864ad89e.2fe558","type":"change","z":"9615284c.b28278","name":"Stop Stab timer","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3880,"y":2720,"wires":[["55cf13db.91f86c"]]},{"id":"55cf13db.91f86c","type":"link out","z":"9615284c.b28278","name":"Reflux Stop Out 3","links":["6b0ad7d6.b5f8d8"],"x":4015,"y":2720,"wires":[]},{"id":"4535976f.442418","type":"switch","z":"372e1e33.0db3b2","name":"process.reflux.valvebodystop","property":"process.reflux.valvebodystop","propertyType":"global","rules":[{"t":"false"},{"t":"true"}],"checkall":"false","repair":false,"outputs":2,"x":1620,"y":2300,"wires":[["438054e6.40be1c"],["fab985a0.2eaf38"]]},{"id":"98ecff23.92f32","type":"switch","z":"7459d84c.edbbd8","name":"Проверяем кол-во старт/стопов","property":"process.reflux.startstop","propertyType":"global","rules":[{"t":"lt","v":"10","vt":"num"},{"t":"gte","v":"10","vt":"num"}],"checkall":"false","repair":false,"outputs":2,"x":2060,"y":720,"wires":[["9b12329b.9bc06"],["9bf47a6b.75a3f8"]]},{"id":"8b188ced.b2e","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3440,"y":2420,"wires":[["317a95dc.f5f05a"]]},{"id":"d6e7780a.fff498","type":"change","z":"9615284c.b28278","name":"","rules":[{"t":"set","p":"process.reflux.startstop","pt":"global","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":3720,"y":2400,"wires":[["23bee91c.46f5c6"]]},{"id":"49a0109d.ea925","type":"trigger","z":"372e1e33.0db3b2","name":"","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"1","extend":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":2,"x":760,"y":3380,"wires":[["b372cac8.5ce1f8"],["b372cac8.5ce1f8","510ceb73.35b634"]]},{"id":"ec949f25.fc10e","type":"trigger","z":"372e1e33.0db3b2","name":"","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"1","extend":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":2,"x":760,"y":3500,"wires":[["b372cac8.5ce1f8"],["b372cac8.5ce1f8","799c0a55.20e3e4"]]},{"id":"9364c006.eb949","type":"trigger","z":"372e1e33.0db3b2","name":"","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"1","extend":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":2,"x":760,"y":3620,"wires":[["b372cac8.5ce1f8"],["b372cac8.5ce1f8","37b61eb6.ab2132"]]},{"id":"4c631dae.6b8574","type":"trigger","z":"372e1e33.0db3b2","name":"","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"1","extend":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":2,"x":760,"y":3740,"wires":[["b372cac8.5ce1f8"],["b372cac8.5ce1f8","1d69d853.e49c38"]]},{"id":"82a7f34e.ca8e6","type":"trigger","z":"372e1e33.0db3b2","name":"","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"2","extend":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":2,"x":760,"y":3960,"wires":[["b372cac8.5ce1f8"],["b372cac8.5ce1f8"]]},{"id":"1d69d853.e49c38","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"delay","timeout":"500","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":770,"y":3800,"wires":[["5342559.216b4ac"]]},{"id":"5342559.216b4ac","type":"trigger","z":"372e1e33.0db3b2","name":"","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"1","extend":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":2,"x":760,"y":3860,"wires":[["b372cac8.5ce1f8"],["b372cac8.5ce1f8"]]},{"id":"edf9ccf6.f80f1","type":"link in","z":"9615284c.b28278","name":"Dist Next","links":["e1f41748.23ba68","86370e4.34b18f"],"x":415,"y":4960,"wires":[["dcb2df41.9284a"]]},{"id":"b315cd17.cd5b9","type":"link in","z":"9615284c.b28278","name":"Rect Next","links":["681dbdd2.f8caf4","ed5c4659.e163f8"],"x":3115,"y":2740,"wires":[["84299d90.daa86"]]},{"id":"e52cd028.a3b2d","type":"telegram sender","z":"eadc688c.f6a628","name":"","bot":"7cee0033.32bed","outputs":1,"x":1990,"y":260,"wires":[[]]},{"id":"19621b42.fda085","type":"comment","z":"eadc688c.f6a628","name":"Telegram","info":"","x":140,"y":60,"wires":[]},{"id":"c9d83641.28df18","type":"switch","z":"eadc688c.f6a628","name":"Тип процесса","property":"process.type","propertyType":"global","rules":[{"t":"eq","v":"dist","vt":"str"},{"t":"eq","v":"reflux","vt":"str"}],"checkall":"false","repair":false,"outputs":2,"x":960,"y":620,"wires":[["86370e4.34b18f"],["ed5c4659.e163f8"]]},{"id":"86370e4.34b18f","type":"link out","z":"eadc688c.f6a628","name":"Teleg Dist","links":["edf9ccf6.f80f1"],"x":1095,"y":580,"wires":[]},{"id":"ed5c4659.e163f8","type":"link out","z":"eadc688c.f6a628","name":"Teleg Rect","links":["b315cd17.cd5b9"],"x":1095,"y":660,"wires":[]},{"id":"c80bc271.243","type":"link out","z":"eadc688c.f6a628","name":"Teleg Stop","links":["351230f0.8ea72","a428ce0c.34a3c"],"x":635,"y":360,"wires":[]},{"id":"dd9b4a5f.391398","type":"change","z":"eadc688c.f6a628","name":"Payload true","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1130,"y":440,"wires":[["fbeee554.b13df8"]]},{"id":"fbeee554.b13df8","type":"link out","z":"eadc688c.f6a628","name":"tgm start dist","links":["d9576b15.cf5d68"],"x":1295,"y":440,"wires":[]},{"id":"eef2b8cb.bab828","type":"change","z":"eadc688c.f6a628","name":"Payload true","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1130,"y":520,"wires":[["4da2d53b.800fdc"]]},{"id":"4da2d53b.800fdc","type":"link out","z":"eadc688c.f6a628","name":"tgm start rect","links":["570981c1.88241"],"x":1295,"y":520,"wires":[]},{"id":"6f83a65c.e46e98","type":"link in","z":"eadc688c.f6a628","name":"Print State","links":["9119a283.b06d6","aceea246.7e4c4","6c8b50a8.a639","c0f1a7cc.f27d28","57062833.7b3368","40b18866.b32af8","8add6a16.81dff8","94dddae2.428c28","8a393b17.7d0278","de48ff55.5e3c","7c1cd5e7.3b77ac","35f79b0b.459d44","faf11258.beb3b","daf87477.0680c8"],"x":395,"y":140,"wires":[["78a935c3.7985ac"]]},{"id":"57c8c4f3.da76fc","type":"ui_button","z":"9615284c.b28278","name":"","group":"5471a0c0.7d6db","order":11,"width":0,"height":0,"passthru":false,"label":"Выключить","tooltip":"","color":"red","bgcolor":"","icon":"power_settings_new","payload":"poweroff","payloadType":"str","topic":"","x":110,"y":100,"wires":[["9760cb54.36abf8"]]},{"id":"9760cb54.36abf8","type":"exec","z":"9615284c.b28278","command":"poweroff","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":310,"y":100,"wires":[[],[],[]]},{"id":"5cb070ff.2f382","type":"change","z":"eadc688c.f6a628","name":"","rules":[{"t":"set","p":"chatId","pt":"global","to":"payload.chatId","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":940,"y":280,"wires":[["6936a4a1.0f0e4c"]]},{"id":"6936a4a1.0f0e4c","type":"change","z":"eadc688c.f6a628","name":"","rules":[{"t":"set","p":"payload.content","pt":"msg","to":"Вы подписались на обновление статусов!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1210,"y":280,"wires":[["e52cd028.a3b2d","c882d84b.fe0bb8"]]},{"id":"69f8ae56.a49e","type":"change","z":"eadc688c.f6a628","name":"","rules":[{"t":"set","p":"payload.content","pt":"msg","to":"Вы отписались от обновление статусов!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1210,"y":380,"wires":[["e52cd028.a3b2d","c882d84b.fe0bb8"]]},{"id":"83433735.af1438","type":"change","z":"eadc688c.f6a628","name":"","rules":[{"t":"delete","p":"chatId","pt":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":380,"wires":[["69f8ae56.a49e"]]},{"id":"59a514b0.a9665c","type":"catch","z":"eadc688c.f6a628","name":"","scope":null,"uncaught":false,"x":170,"y":1000,"wires":[["678d4d93.c5a404"]]},{"id":"678d4d93.c5a404","type":"debug","z":"eadc688c.f6a628","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":390,"y":1000,"wires":[]},{"id":"fee54c55.b5178","type":"function","z":"eadc688c.f6a628","name":"Set Output Data","func":"\nvar template_temperature = \"\\n\\n === Температура: ===\" +\n        \" \\nКуб:     \" +\n        parseFloat(global.get('temperature.still', \"memoryOnly\")).toFixed(2) +\n        \"\\nЦарга:  \"+\n        parseFloat(global.get('temperature.tube', \"memoryOnly\")).toFixed(2) +\n        \"\\nВода:    \" + \n        parseFloat(global.get('temperature.chiller', \"memoryOnly\")).toFixed(2);\n        \nvar template_valve = \"\\n\\n === Клапаны ===\" + \"\\nВода:        \";\nif (global.get('valve.water.hand', \"memoryOnly\") == 'false') {\n    template_valve += '🚫';\n} else if (global.get('valve.water.hand', \"memoryOnly\") == 'true') {\n    template_valve += '✅';\n} else {\n    if (global.get('valve.water.on', \"memoryOnly\")) {\n        template_valve += '✅';\n    } else {\n        template_valve += '🅾';\n    }\n}\ntemplate_valve += \"\\nГоловы:    \";\nif (global.get('valve.heads.hand', \"memoryOnly\") == 'false') {\n    template_valve += '🚫';\n} else if (global.get('valve.heads.hand', \"memoryOnly\") == 'true') {\n    template_valve += '✅';\n} else {\n    if (global.get('valve.heads.on', \"memoryOnly\")) {\n        template_valve += '✅';\n    } else {\n        template_valve += '🅾';\n    }\n}\ntemplate_valve += \"\\nТело:         \";\nif (global.get('valve.body.hand', \"memoryOnly\") == 'false') {\n    template_valve += '🚫';\n} else if (global.get('valve.body.hand', \"memoryOnly\") == 'true') {\n    template_valve += '✅';\n} else {\n    if (global.get('valve.body.on', \"memoryOnly\")) {\n        template_valve += '✅';\n    } else {\n        template_valve += '🅾';\n    }\n}\n\nvar template_safe = \"\\n\\n === Датчики ===\" + \n        \"\\nТары:        \";\n        \nif  (global.get('safe.liquid', \"memoryOnly\")== '0') {\n    template_safe += '✅';\n} else {\n    template_safe += '🅾';\n}\n\n        global.get('safe.liquid', \"memoryOnly\");\n    \nvar template_stage;\n\nif (global.get('process.type') == 'dist') {\n    switch (global.get('process.dist.stage')) {\n        case 'heat':\n            template_stage = 'Разогрев'\n            break;\n        case 'work':\n            template_stage = 'Отбор'\n            break;\n        case 'cooling':\n            template_stage = 'Охлаждение'\n            break;\n        case 'final':\n            template_stage = 'Финал'\n            break;\n        case 'hand_finish':\n            template_stage = 'Ручная остановка'\n            break;\n        case 'error_finish':\n            template_stage = 'Остановка из-за ошибки'\n            break;    \n        default:\n            template_stage = 'Непойми что';\n            break;\n    }\n    msg.payload.content = \"Процесс: Дистилляция\" + \"\\nСтадия:  \" + \n        template_stage +\n        template_temperature +\n        template_valve + \n        template_safe;\n} else if (global.get('process.type') == 'reflux') {\n        switch (global.get('process.reflux.stage')) {\n        case 'heat':\n            template_stage = 'Разогрев'\n            break;\n        case 'stabilize':\n            template_stage = 'Стабилизация'\n            break;\n        case 'head':\n            template_stage = 'Отбор Голов'\n            break;\n        case 'setpoint':\n            template_stage = 'Уставка'\n            break;\n        case 'body':\n            template_stage = 'Отбор Тела'\n            break;\n        case 'cooling':\n            template_stage = 'Охлаждение'\n            break;\n        case 'final':\n            template_stage = 'Финал'\n            break;\n        case 'hand_finish':\n            template_stage = 'Ручная остановка'\n            break;\n        case 'error_finish':\n            template_stage = 'Остановка из-за ошибки'\n            break;    \n        default:\n            template_stage = 'Непойми что';\n            break;\n    }\n    msg.payload.content = \"Процесс: Ректификация\" + \"\\nСтадия:  \" + \n        template_stage +\n        template_temperature +\n        template_valve + \n        template_safe;\n} else {\n    msg.payload.content = 'Ничего не делаем!' +\n    template_temperature +\n    template_valve + \n    template_safe;\n}\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":160,"wires":[["e52cd028.a3b2d"]]},{"id":"12aa69f2.bfca46","type":"switch","z":"eadc688c.f6a628","name":"","property":"process.on","propertyType":"global","rules":[{"t":"false"}],"checkall":"true","repair":false,"outputs":1,"x":910,"y":520,"wires":[["eef2b8cb.bab828","10ae8f25.163541"]]},{"id":"84ca3b.3865a5c8","type":"switch","z":"eadc688c.f6a628","name":"","property":"process.on","propertyType":"global","rules":[{"t":"false"}],"checkall":"true","repair":false,"outputs":1,"x":910,"y":440,"wires":[["dd9b4a5f.391398","10ae8f25.163541"]]},{"id":"aceea246.7e4c4","type":"link out","z":"6546e589.95bfdc","name":"","links":["6f83a65c.e46e98"],"x":1755,"y":380,"wires":[]},{"id":"10ae8f25.163541","type":"change","z":"eadc688c.f6a628","name":"","rules":[{"t":"set","p":"chatId","pt":"global","to":"payload.chatId","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1140,"y":480,"wires":[[]]},{"id":"771616cf.e57f38","type":"switch","z":"6546e589.95bfdc","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1390,"y":380,"wires":[["9ed1a456.54fd18"]]},{"id":"6c8b50a8.a639","type":"link out","z":"6546e589.95bfdc","name":"","links":["6f83a65c.e46e98"],"x":755,"y":380,"wires":[]},{"id":"179a60c2.3f757f","type":"switch","z":"6546e589.95bfdc","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":390,"y":380,"wires":[["ec4c5d2e.ce553"]]},{"id":"ec4c5d2e.ce553","type":"change","z":"6546e589.95bfdc","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":570,"y":380,"wires":[["6c8b50a8.a639"]]},{"id":"9ed1a456.54fd18","type":"change","z":"6546e589.95bfdc","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":380,"wires":[["aceea246.7e4c4"]]},{"id":"c0f1a7cc.f27d28","type":"link out","z":"6546e589.95bfdc","name":"","links":["6f83a65c.e46e98"],"x":2855,"y":180,"wires":[]},{"id":"124d7b5a.5e7ae5","type":"switch","z":"6546e589.95bfdc","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":2490,"y":180,"wires":[["ccef3a3c.da30a8"]]},{"id":"ccef3a3c.da30a8","type":"change","z":"6546e589.95bfdc","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2710,"y":180,"wires":[["c0f1a7cc.f27d28"]]},{"id":"40b18866.b32af8","type":"link out","z":"6546e589.95bfdc","name":"","links":["6f83a65c.e46e98"],"x":1895,"y":1140,"wires":[]},{"id":"a22bbdf2.e6137","type":"switch","z":"6546e589.95bfdc","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1530,"y":1140,"wires":[["f1c1be26.c633e"]]},{"id":"f1c1be26.c633e","type":"change","z":"6546e589.95bfdc","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1710,"y":1140,"wires":[["40b18866.b32af8"]]},{"id":"8add6a16.81dff8","type":"link out","z":"7459d84c.edbbd8","name":"","links":["6f83a65c.e46e98"],"x":775,"y":280,"wires":[]},{"id":"f441e5.c21fae18","type":"switch","z":"7459d84c.edbbd8","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":410,"y":280,"wires":[["8874c805.32d8f8"]]},{"id":"8874c805.32d8f8","type":"change","z":"7459d84c.edbbd8","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":590,"y":280,"wires":[["8add6a16.81dff8"]]},{"id":"94dddae2.428c28","type":"link out","z":"7459d84c.edbbd8","name":"","links":["6f83a65c.e46e98"],"x":1695,"y":60,"wires":[]},{"id":"77000e6.1bdc0f","type":"switch","z":"7459d84c.edbbd8","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1330,"y":60,"wires":[["8c63f440.106bd8"]]},{"id":"8c63f440.106bd8","type":"change","z":"7459d84c.edbbd8","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1510,"y":60,"wires":[["94dddae2.428c28"]]},{"id":"8a393b17.7d0278","type":"link out","z":"7459d84c.edbbd8","name":"","links":["6f83a65c.e46e98"],"x":2495,"y":340,"wires":[]},{"id":"84de8106.f8f91","type":"switch","z":"7459d84c.edbbd8","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":2130,"y":340,"wires":[["c78b8b93.10e218"]]},{"id":"c78b8b93.10e218","type":"change","z":"7459d84c.edbbd8","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2310,"y":340,"wires":[["8a393b17.7d0278"]]},{"id":"de48ff55.5e3c","type":"link out","z":"7459d84c.edbbd8","name":"","links":["6f83a65c.e46e98"],"x":3215,"y":340,"wires":[]},{"id":"847b4087.75d9f","type":"switch","z":"7459d84c.edbbd8","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":2850,"y":340,"wires":[["48046825.27f128"]]},{"id":"48046825.27f128","type":"change","z":"7459d84c.edbbd8","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3030,"y":340,"wires":[["de48ff55.5e3c"]]},{"id":"7c1cd5e7.3b77ac","type":"link out","z":"7459d84c.edbbd8","name":"","links":["6f83a65c.e46e98"],"x":4215,"y":80,"wires":[]},{"id":"a86b0626.c111b8","type":"switch","z":"7459d84c.edbbd8","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":3850,"y":80,"wires":[["6dc41973.f97d28"]]},{"id":"6dc41973.f97d28","type":"change","z":"7459d84c.edbbd8","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":4030,"y":80,"wires":[["7c1cd5e7.3b77ac"]]},{"id":"d5cd7313.9b536","type":"switch","z":"372e1e33.0db3b2","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":2150,"y":2680,"wires":[["e2692004.c5074"]]},{"id":"e2692004.c5074","type":"change","z":"372e1e33.0db3b2","name":"Set telegram Message","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"},{"t":"set","p":"payload.content","pt":"msg","to":"‼Смени ТАРУ‼","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2340,"y":2680,"wires":[["d29b778d.172168"]]},{"id":"e2392593.441de8","type":"delay","z":"372e1e33.0db3b2","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"60","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1980,"y":2680,"wires":[["d5cd7313.9b536"]]},{"id":"d29b778d.172168","type":"telegram sender","z":"372e1e33.0db3b2","name":"","bot":"7cee0033.32bed","haserroroutput":false,"outputs":1,"x":2570,"y":2680,"wires":[[]]},{"id":"faf11258.beb3b","type":"link out","z":"7459d84c.edbbd8","name":"","links":["6f83a65c.e46e98"],"x":3195,"y":860,"wires":[]},{"id":"c12bf717.379d48","type":"switch","z":"7459d84c.edbbd8","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":2830,"y":860,"wires":[["c04d470.b0551b8"]]},{"id":"c04d470.b0551b8","type":"change","z":"7459d84c.edbbd8","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3010,"y":860,"wires":[["faf11258.beb3b"]]},{"id":"daf87477.0680c8","type":"link out","z":"7459d84c.edbbd8","name":"","links":["6f83a65c.e46e98"],"x":1835,"y":1800,"wires":[]},{"id":"4b55b6f8.f814c8","type":"switch","z":"7459d84c.edbbd8","name":"","property":"chatId","propertyType":"global","rules":[{"t":"nnull"}],"checkall":"true","repair":false,"outputs":1,"x":1470,"y":1800,"wires":[["7f1827dd.ec42f8"]]},{"id":"7f1827dd.ec42f8","type":"change","z":"7459d84c.edbbd8","name":"Set type and chatId","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.chatId","pt":"msg","to":"chatId","tot":"global"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":1800,"wires":[["daf87477.0680c8"]]},{"id":"61dd47c7.d47f78","type":"telegram receiver","z":"eadc688c.f6a628","name":"","bot":"7cee0033.32bed","saveDataDir":"","filterCommands":false,"x":170,"y":520,"wires":[["e8402325.410fb"],[]]},{"id":"854d4915.c39ea8","type":"function","z":"eadc688c.f6a628","name":"Клава основная","func":"var opts = {\n  reply_markup: JSON.stringify({\n    keyboard: [\n      ['Статус'],\n      ['Управление процессом'],\n      ['Управление подпиской']],\n      'resize_keyboard' : true,\n      'one_time_keyboard' : false\n  })\n};\n\n\nmsg.error = false;\n\nmsg.payload.content = 'Чего изволите?';\nmsg.payload.options = opts;\n\nmsg.payload.type = \"message\";\n\nreturn [ msg ];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1710,"y":920,"wires":[["e52cd028.a3b2d"]]},{"id":"e8402325.410fb","type":"switch","z":"eadc688c.f6a628","name":"","property":"payload.content","propertyType":"msg","rules":[{"t":"eq","v":"Статус","vt":"str"},{"t":"eq","v":"Управление процессом","vt":"str"},{"t":"eq","v":"Управление подпиской","vt":"str"},{"t":"eq","v":"Подписаться","vt":"str"},{"t":"eq","v":"Отписаться","vt":"str"},{"t":"eq","v":"Старт Дистилляции","vt":"str"},{"t":"eq","v":"Старт Ректификации","vt":"str"},{"t":"eq","v":"Следующий этап","vt":"str"},{"t":"eq","v":"Стоп","vt":"str"},{"t":"else"}],"checkall":"false","repair":true,"outputs":10,"x":370,"y":500,"wires":[["fee54c55.b5178"],["461f9d22.529af4"],["4ab106ac.9e45c8"],["5cb070ff.2f382"],["83433735.af1438"],["84ca3b.3865a5c8","c882d84b.fe0bb8"],["12aa69f2.bfca46","c882d84b.fe0bb8"],["c9d83641.28df18","c882d84b.fe0bb8"],["c80bc271.243","c882d84b.fe0bb8"],["854d4915.c39ea8"]]},{"id":"4ab106ac.9e45c8","type":"function","z":"eadc688c.f6a628","name":"Клава подписок","func":"var opts = {\n  reply_markup: JSON.stringify({\n    keyboard: [\n      ['Подписаться'],\n      ['Отписаться'],\n      ['Назад']],\n      'resize_keyboard' : true,\n      'one_time_keyboard' : false\n  })\n};\n\n\nmsg.error = false;\n\nmsg.payload.content = 'Подписочку?';\nmsg.payload.options = opts;\n\nmsg.payload.type = \"message\";\n\nreturn [ msg ];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":240,"wires":[["e52cd028.a3b2d"]]},{"id":"c882d84b.fe0bb8","type":"delay","z":"eadc688c.f6a628","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1500,"y":840,"wires":[["854d4915.c39ea8"]]},{"id":"461f9d22.529af4","type":"function","z":"eadc688c.f6a628","name":"Клава процессов","func":"var opts = {    \n    reply_markup: JSON.stringify({\n        keyboard: [['Назад']],\n        'resize_keyboard' : true,\n        'one_time_keyboard' : false\n    })\n};\nif (global.get('process.type') == 'none'){\n    opts = {    \n        reply_markup: JSON.stringify({\n            keyboard: [\n                ['Старт Дистилляции'],\n                ['Старт Ректификации'],\n                ['Назад']],\n            'resize_keyboard' : true,\n            'one_time_keyboard' : false\n        })\n    };\n} else {\n    opts = {    \n        reply_markup: JSON.stringify({\n            keyboard: [\n                ['Стоп'],\n                ['Следующий этап'],\n                ['Назад']],\n            'resize_keyboard' : true,\n            'one_time_keyboard' : false\n        })\n    };\n}\n\nmsg.error = false;\n\nmsg.payload.content = 'Что творим?';\nmsg.payload.options = opts;\n\nmsg.payload.type = \"message\";\n\nreturn [ msg ];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":790,"y":200,"wires":[["e52cd028.a3b2d"]]},{"id":"78a935c3.7985ac","type":"delay","z":"eadc688c.f6a628","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":530,"y":140,"wires":[["fee54c55.b5178"]]},{"id":"a6c017d6.296a28","type":"batch","z":"372e1e33.0db3b2","name":"","mode":"count","count":"4","overlap":0,"interval":10,"allowEmptySequence":false,"topics":[],"x":1710,"y":700,"wires":[["3a727a32.1091c6"]]}]